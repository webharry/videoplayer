/*! http://mths.be/endswith v0.2.0 by @mathias */

!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("js/lib/hls.min",[],e):"object"==typeof exports?exports.Hls=e():t.Hls=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=23)}([function(t,e,i){"use strict";function n(){}function r(t,e){return e="["+t+"] > "+e}function a(t){var e=self.console[t];return e?function(){for(var i=arguments.length,n=Array(i),a=0;a<i;a++)n[a]=arguments[a];n[0]&&(n[0]=r(t,n[0])),e.apply(self.console,n)}:n}function o(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];i.forEach(function(e){u[e]=t[e]?t[e].bind(t):a(e)})}i.d(e,"a",function(){return d}),i.d(e,"b",function(){return c});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l={trace:n,debug:n,log:n,warn:n,info:n,error:n},u=l,d=function(t){if(!0===t||"object"===(void 0===t?"undefined":s(t))){o(t,"debug","log","info","warn","error");try{u.log()}catch(t){u=l}}else u=l},c=u},function(t,e,i){"use strict";e.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(t,e,i){"use strict";i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r});var n={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},r={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(0),a=i(2),o=i(1),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=new Set(["hlsEventGeneric","hlsHandlerDestroying","hlsHandlerDestroyed"]),u=function(){function t(e){n(this,t),this.hls=e,this.onEvent=this.onEvent.bind(this);for(var i=arguments.length,r=Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}return t.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.prototype.onHandlerDestroying=function(){},t.prototype.onHandlerDestroyed=function(){},t.prototype.isEventHandler=function(){return"object"===s(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent},t.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){if(l.has(t))throw new Error("Forbidden event-name: "+t);this.hls.on(t,this.onEvent)},this)},t.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){this.hls.off(t,this.onEvent)},this)},t.prototype.onEvent=function(t,e){this.onEventGeneric(t,e)},t.prototype.onEventGeneric=function(t,e){var i=function(t,e){var i="on"+t.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,e)};try{i.call(this,t,e).call()}catch(e){r.b.error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e),this.hls.trigger(o.a.ERROR,{type:a.b.OTHER_ERROR,details:a.a.INTERNAL_EXCEPTION,fatal:!1,event:t,err:e})}},t}();e.a=u},function(t,e,i){!function(e){var i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,n=/^([^\/;?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(t,e,i){if(i=i||{},t=t.trim(),!(e=e.trim())){if(!i.alwaysNormalize)return t;var r=this.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=this.parseURL(e);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):e;var s=this.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=n.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var d=s.path,c=d.substring(0,d.lastIndexOf("/")+1)+a.path;u.path=o.normalizePath(c)}else u.path=s.path,a.params||(u.params=s.params,a.query||(u.query=s.query));return null===u.path&&(u.path=i.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(u)},parseURL:function(t){var e=i.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(r,"");t.length!==(t=t.replace(a,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=o}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.d(e,"b",function(){return a});var r=function(){function t(){n(this,t)}return t.isHeader=function(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.isFooter=function(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.getID3Data=function(e,i){for(var n=i,r=0;t.isHeader(e,i);)r+=10,r+=t._readSize(e,i+6),t.isFooter(e,i+10)&&(r+=10),i+=r;if(r>0)return e.subarray(n,n+r)},t._readSize=function(t,e){var i=0;return i=(127&t[e])<<21,i|=(127&t[e+1])<<14,i|=(127&t[e+2])<<7,i|=127&t[e+3]},t.getTimeStamp=function(e){for(var i=t.getID3Frames(e),n=0;n<i.length;n++){var r=i[n];if(t.isTimeStampFrame(r))return t._readTimeStamp(r)}},t.isTimeStampFrame=function(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info},t._getFrameData=function(e){var i=String.fromCharCode(e[0],e[1],e[2],e[3]),n=t._readSize(e,4);return{type:i,size:n,data:e.subarray(10,10+n)}},t.getID3Frames=function(e){for(var i=0,n=[];t.isHeader(e,i);){var r=t._readSize(e,i+6);i+=10;for(var a=i+r;i+8<a;){var o=t._getFrameData(e.subarray(i)),s=t._decodeFrame(o);s&&n.push(s),i+=o.size+10}t.isFooter(e,i)&&(i+=10)}return n},t._decodeFrame=function(e){return"PRIV"===e.type?t._decodePrivFrame(e):"T"===e.type[0]?t._decodeTextFrame(e):"W"===e.type[0]?t._decodeURLFrame(e):void 0},t._readTimeStamp=function(t){if(8===t.data.byteLength){var e=new Uint8Array(t.data),i=1&e[3],n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,i&&(n+=47721858.84),Math.round(n)}},t._decodePrivFrame=function(e){if(!(e.size<2)){var i=t._utf8ArrayToStr(e.data,!0),n=new Uint8Array(e.data.subarray(i.length+1));return{key:e.type,info:i,data:n.buffer}}},t._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var i=1,n=t._utf8ArrayToStr(e.data.subarray(i));i+=n.length+1;var r=t._utf8ArrayToStr(e.data.subarray(i));return{key:e.type,info:n,data:r}}var a=t._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:a}}},t._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var i=1,n=t._utf8ArrayToStr(e.data.subarray(i));i+=n.length+1;var r=t._utf8ArrayToStr(e.data.subarray(i));return{key:e.type,info:n,data:r}}var a=t._utf8ArrayToStr(e.data);return{key:e.type,data:a}},t._utf8ArrayToStr=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.length,n=void 0,r=void 0,a=void 0,o="",s=0;s<i;){if(0===(n=t[s++])&&e)return o;if(0!==n&&3!==n)switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(n);break;case 12:case 13:r=t[s++],o+=String.fromCharCode((31&n)<<6|63&r);break;case 14:r=t[s++],a=t[s++],o+=String.fromCharCode((15&n)<<12|(63&r)<<6|(63&a)<<0)}}return o},t}(),a=r._utf8ArrayToStr;e.a=r},function(t,e,i){"use strict";var n={search:function(t,e){for(var i=0,n=t.length-1,r=null,a=null;i<=n;){r=(i+n)/2|0,a=t[r];var o=e(a);if(o>0)i=r+1;else{if(!(o<0))return a;n=r-1}}return null}};e.a=n},function(t,e,i){"use strict";var n={isBuffered:function(t,e){try{if(t)for(var i=t.buffered,n=0;n<i.length;n++)if(e>=i.start(n)&&e<=i.end(n))return!0}catch(t){}return!1},bufferInfo:function(t,e,i){try{if(t){var n,r=t.buffered,a=[];for(n=0;n<r.length;n++)a.push({start:r.start(n),end:r.end(n)});return this.bufferedInfo(a,e,i)}}catch(t){}return{len:0,start:e,end:e,nextStart:void 0}},bufferedInfo:function(t,e,i){var n,r,a,o,s,l=[];for(t.sort(function(t,e){return t.start-e.start||e.end-t.end}),s=0;s<t.length;s++){var u=l.length;if(u){var d=l[u-1].end;t[s].start-d<i?t[s].end>d&&(l[u-1].end=t[s].end):l.push(t[s])}else l.push(t[s])}for(s=0,n=0,r=a=e;s<l.length;s++){var c=l[s].start,h=l[s].end;if(e+i>=c&&e<h)r=c,a=h,n=a-e;else if(e+i<c){o=c;break}}return{len:n,start:r,end:a,nextStart:o}}};e.a=n},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(31),a=i(32),o=i(33),s=i(2),l=i(0),u=function(){function t(e,i){n(this,t),this.observer=e,this.config=i,this.logEnabled=!0;try{var r=crypto||self.crypto;this.subtle=r.subtle||r.webkitSubtle}catch(t){}this.disableWebCrypto=!this.subtle}return t.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.prototype.decrypt=function(t,e,i,n){var s=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(l.b.log("JS AES decrypt"),this.logEnabled=!1);var u=this.decryptor;u||(this.decryptor=u=new o.a),u.expandKey(e),n(u.decrypt(t,0,i))}else{this.logEnabled&&(l.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var d=this.subtle;this.key!==e&&(this.key=e,this.fastAesKey=new a.a(d,e)),this.fastAesKey.expandKey().then(function(a){new r.a(d,i).decrypt(t,a).catch(function(r){s.onWebCryptoError(r,t,e,i,n)}).then(function(t){n(t)})}).catch(function(r){s.onWebCryptoError(r,t,e,i,n)})}},t.prototype.onWebCryptoError=function(t,e,i,n,r){this.config.enableSoftwareAES?(l.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(e,i,n,r)):(l.b.error("decrypting error : "+t.message),this.observer.trigger(Event.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:t.message}))},t.prototype.destroy=function(){var t=this.decryptor;t&&(t.destroy(),this.decryptor=void 0)},t}();e.a=u},function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function r(t){return"number"==typeof t}function a(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!r(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,r,s,l,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var d=new Error('Uncaught, unspecified "error" event. ('+e+")");throw d.context=e,d}if(i=this._events[t],o(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),i.apply(this,s)}else if(a(i))for(s=Array.prototype.slice.call(arguments,1),u=i.slice(),r=u.length,l=0;l<r;l++)u[l].apply(this,s);return!0},i.prototype.addListener=function(t,e){var r;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(r=o(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var r=!1;return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var i,r,o,s;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=this._events[t],o=i.length,r=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(i)){for(s=o;s-- >0;)if(i[s]===e||i[s].listener&&i[s].listener===e){r=s;break}if(r<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[t],n(i))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,i){"use strict";function n(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}e.a=n},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(3),s=function(t){function e(i){n(this,e);for(var a=arguments.length,o=Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];var l=r(this,t.call.apply(t,[this,i].concat(o)));return l._tickInterval=null,l._tickCallCount=0,l}return a(e,t),e.prototype.destroy=function(){this.clearInterval(),t.prototype.destroy.call(this)},e.prototype.hasInterval=function(){return!isNaN(this._tickInterval)},e.prototype.setInterval=function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return!this._tickInterval&&(this._tickInterval=setInterval(this.tick.bind(this,!1),t),!0)}),e.prototype.clearInterval=function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),!0)}),e.prototype.tick=function(){1==++this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&setTimeout(this.tick.bind(this),0),this._tickCallCount=0)},e.prototype.doTick=function(){throw new Error("TaskLoop is abstract and `doLoop` must be implemented")},e}(o.a);e.a=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(0),a=i(1),o=Math.pow(2,32)-1,s=function(){function t(e,i){n(this,t),this.observer=e,this.remuxer=i}return t.prototype.resetTimeStamp=function(t){this.initPTS=t},t.prototype.resetInitSegment=function(e,i,n,r){if(e&&e.byteLength){var o=this.initData=t.parseInitSegment(e);null==i&&(i="mp4a.40.5"),null==n&&(n="avc1.42e01e");var s={};o.audio&&o.video?s.audiovideo={container:"video/mp4",codec:i+","+n,initSegment:r?e:null}:(o.audio&&(s.audio={container:"audio/mp4",codec:i,initSegment:r?e:null}),o.video&&(s.video={container:"video/mp4",codec:n,initSegment:r?e:null})),this.observer.trigger(a.a.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else i&&(this.audioCodec=i),n&&(this.videoCodec=n)},t.probe=function(e){return t.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length>0},t.bin2str=function(t){return String.fromCharCode.apply(null,t)},t.readUint16=function(t,e){t.data&&(e+=t.start,t=t.data);var i=t[e]<<8|t[e+1];return i<0?65536+i:i},t.readUint32=function(t,e){t.data&&(e+=t.start,t=t.data);var i=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];return i<0?4294967296+i:i},t.writeUint32=function(t,e,i){t.data&&(e+=t.start,t=t.data),t[e]=i>>24,t[e+1]=i>>16&255,t[e+2]=i>>8&255,t[e+3]=255&i},t.findBox=function(e,i){var n,r,a,o,s,l,u,d=[];if(e.data?(l=e.start,o=e.end,e=e.data):(l=0,o=e.byteLength),!i.length)return null;for(n=l;n<o;)r=t.readUint32(e,n),a=t.bin2str(e.subarray(n+4,n+8)),u=r>1?n+r:o,a===i[0]&&(1===i.length?d.push({data:e,start:n+8,end:u}):(s=t.findBox({data:e,start:n+8,end:u},i.slice(1)),s.length&&(d=d.concat(s)))),n=u;return d},t.parseSegmentIndex=function(e){var i=t.findBox(e,["moov"])[0],n=i?i.end:null,r=0,a=t.findBox(e,["sidx"]),o=void 0;if(!a||!a[0])return null;o=[],a=a[0];var s=a.data[0];r=0===s?8:16;var l=t.readUint32(a,r);r+=4,r+=0===s?8:16,r+=2;var u=a.end+0,d=t.readUint16(a,r);r+=2;for(var c=0;c<d;c++){var h=r,p=t.readUint32(a,h);h+=4;var f=2147483647&p;if(1==(2147483648&p)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var y=t.readUint32(a,h);h+=4,o.push({referenceSize:f,subsegmentDuration:y,info:{duration:y/l,start:u,end:u+f-1}}),u+=f,h+=4,r=h}return{earliestPresentationTime:0,timescale:l,version:s,referencesCount:d,references:o,moovEndOffset:n}},t.parseInitSegment=function(e){var i=[];return t.findBox(e,["moov","trak"]).forEach(function(e){var n=t.findBox(e,["tkhd"])[0];if(n){var a=n.data[n.start],o=0===a?12:20,s=t.readUint32(n,o),l=t.findBox(e,["mdia","mdhd"])[0];if(l){a=l.data[l.start],o=0===a?12:20;var u=t.readUint32(l,o),d=t.findBox(e,["mdia","hdlr"])[0];if(d){var c=t.bin2str(d.data.subarray(d.start+8,d.start+12)),h={soun:"audio",vide:"video"}[c];if(h){var p=t.findBox(e,["mdia","minf","stbl","stsd"]);if(p.length){p=p[0];var f=t.bin2str(p.data.subarray(p.start+12,p.start+16));r.b.log("MP4Demuxer:"+h+":"+f+" found")}i[s]={timescale:u,type:h},i[h]={timescale:u,id:s}}}}}}),i},t.getStartDTS=function(e,i){var n,r,a;return n=t.findBox(i,["moof","traf"]),r=[].concat.apply([],n.map(function(i){return t.findBox(i,["tfhd"]).map(function(n){var r,a;return r=t.readUint32(n,4),a=e[r].timescale||9e4,t.findBox(i,["tfdt"]).map(function(e){var i,n;return i=e.data[e.start],n=t.readUint32(e,4),1===i&&(n*=Math.pow(2,32),n+=t.readUint32(e,8)),n})[0]/a})})),a=Math.min.apply(null,r),isFinite(a)?a:0},t.offsetStartDTS=function(e,i,n){t.findBox(i,["moof","traf"]).map(function(i){return t.findBox(i,["tfhd"]).map(function(r){var a=t.readUint32(r,4),s=e[a].timescale||9e4;t.findBox(i,["tfdt"]).map(function(e){var i=e.data[e.start],r=t.readUint32(e,4);if(0===i)t.writeUint32(e,4,r-n*s);else{r*=Math.pow(2,32),r+=t.readUint32(e,8),r-=n*s,r=Math.max(r,0);var a=Math.floor(r/(o+1)),l=Math.floor(r%(o+1));t.writeUint32(e,4,a),t.writeUint32(e,8,l)}})})})},t.prototype.append=function(e,i,n,r){var o=this.initData;o||(this.resetInitSegment(e,this.audioCodec,this.videoCodec,!1),o=this.initData);var s=void 0,l=this.initPTS;if(void 0===l){var u=t.getStartDTS(o,e);this.initPTS=l=u-i,this.observer.trigger(a.a.INIT_PTS_FOUND,{initPTS:l})}t.offsetStartDTS(o,e,l),s=t.getStartDTS(o,e),this.remuxer.remux(o.audio,o.video,null,null,s,n,r,e)},t.prototype.destroy=function(){},t}();e.a=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(4),a=i.n(r),o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(){n(this,t),this.method=null,this.key=null,this.iv=null,this._uri=null}return o(t,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=a.a.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),t}();e.a=s},function(t,e,i){"use strict";function n(t,e){var i=a[e];return!!i&&!0===i[t.slice(0,4)]}function r(t,e){return MediaSource.isTypeSupported((e||"video")+'/mp4;codecs="'+t+'"')}i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r});var a={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(1),a=i(16),o=i(0),s=i(2),l=i(9),u=i.n(l),d=i(43),c=i.n(d),h=i(10),p=Object(h.a)(),f=function(){function t(e,i){n(this,t),this.hls=e,this.id=i;var l=this.observer=new u.a,d=e.config;l.trigger=function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];l.emit.apply(l,[t,t].concat(i))},l.off=function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];l.removeListener.apply(l,[t].concat(i))};var h=function(t,i){i=i||{},i.frag=this.frag,i.id=this.id,e.trigger(t,i)}.bind(this);l.on(r.a.FRAG_DECRYPTED,h),l.on(r.a.FRAG_PARSING_INIT_SEGMENT,h),l.on(r.a.FRAG_PARSING_DATA,h),l.on(r.a.FRAG_PARSED,h),l.on(r.a.ERROR,h),l.on(r.a.FRAG_PARSING_METADATA,h),l.on(r.a.FRAG_PARSING_USERDATA,h),l.on(r.a.INIT_PTS_FOUND,h);var f={mp4:p.isTypeSupported("video/mp4"),mpeg:p.isTypeSupported("audio/mpeg"),mp3:p.isTypeSupported('audio/mp4; codecs="mp3"')},y=navigator.vendor;if(d.enableWorker&&"undefined"!=typeof Worker){o.b.log("demuxing in webworker");var v=void 0;try{v=this.w=c()(44),this.onwmsg=this.onWorkerMessage.bind(this),v.addEventListener("message",this.onwmsg),v.onerror=function(t){e.trigger(r.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},v.postMessage({cmd:"init",typeSupported:f,vendor:y,id:i,config:JSON.stringify(d)})}catch(t){o.b.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),v&&URL.revokeObjectURL(v.objectURL),this.demuxer=new a.a(l,f,d,y),this.w=void 0}}else this.demuxer=new a.a(l,f,d,y)}return t.prototype.destroy=function(){var t=this.w;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.w=null;else{var e=this.demuxer;e&&(e.destroy(),this.demuxer=null)}var i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},t.prototype.push=function(t,e,i,n,r,a,s,l){var u=this.w,d=isNaN(r.startDTS)?r.start:r.startDTS,c=r.decryptdata,h=this.frag,p=!(h&&r.cc===h.cc),f=!(h&&r.level===h.level),y=h&&r.sn===h.sn+1,v=!f&&y;if(p&&o.b.log(this.id+":discontinuity detected"),f&&o.b.log(this.id+":switch detected"),this.frag=r,u)u.postMessage({cmd:"demux",data:t,decryptdata:c,initSegment:e,audioCodec:i,videoCodec:n,timeOffset:d,discontinuity:p,trackSwitch:f,contiguous:v,duration:a,accurateTimeOffset:s,defaultInitPTS:l},t instanceof ArrayBuffer?[t]:[]);else{var m=this.demuxer;m&&m.push(t,c,e,i,n,d,p,f,v,a,s,l)}},t.prototype.onWorkerMessage=function(t){var e=t.data,i=this.hls;switch(e.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case r.a.FRAG_PARSING_DATA:e.data.data1=new Uint8Array(e.data1),e.data2&&(e.data.data2=new Uint8Array(e.data2));default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,i.trigger(e.event,e.data)}},t}();e.a=f},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(1),a=i(2),o=i(8),s=i(34),l=i(12),u=i(35),d=i(38),c=i(39),h=i(42),p=function(){function t(e,i,r,a){n(this,t),this.observer=e,this.typeSupported=i,this.config=r,this.vendor=a}return t.prototype.destroy=function(){var t=this.demuxer;t&&t.destroy()},t.prototype.push=function(t,e,i,n,a,s,l,u,d,c,h,p){if(t.byteLength>0&&null!=e&&null!=e.key&&"AES-128"===e.method){var f=this.decrypter;null==f&&(f=this.decrypter=new o.a(this.observer,this.config));var y,v=this;try{y=performance.now()}catch(t){y=Date.now()}f.decrypt(t,e.key.buffer,e.iv.buffer,function(t){var o;try{o=performance.now()}catch(t){o=Date.now()}v.observer.trigger(r.a.FRAG_DECRYPTED,{stats:{tstart:y,tdecrypt:o}}),v.pushDecrypted(new Uint8Array(t),e,new Uint8Array(i),n,a,s,l,u,d,c,h,p)})}else this.pushDecrypted(new Uint8Array(t),e,new Uint8Array(i),n,a,s,l,u,d,c,h,p)},t.prototype.pushDecrypted=function(t,e,i,n,o,p,f,y,v,m,g,b){var E=this.demuxer;if(!E||f&&!this.probe(t)){for(var T=this.observer,w=this.typeSupported,S=this.config,_=[{demux:u.a,remux:c.a},{demux:l.a,remux:h.a},{demux:s.a,remux:c.a},{demux:d.a,remux:c.a}],k=0,L=_.length;k<L;k++){var R=_[k],A=R.demux.probe;if(A(t)){var D=this.remuxer=new R.remux(T,S,w,this.vendor);E=new R.demux(T,D,S,w),this.probe=A;break}}if(!E)return void T.trigger(r.a.ERROR,{type:a.b.MEDIA_ERROR,details:a.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=E}var x=this.remuxer;(f||y)&&(E.resetInitSegment(i,n,o,m),x.resetInitSegment()),f&&(E.resetTimeStamp(b),x.resetTimeStamp(b)),"function"==typeof E.setDecryptData&&E.setDecryptData(e),E.append(t,p,v,g)},t}();e.a=p},function(t,e,i){"use strict";function n(t,e,i,n){var r,a,o,s,l,u=navigator.userAgent.toLowerCase(),d=n,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return r=1+((192&e[i+2])>>>6),(a=(60&e[i+2])>>>2)>c.length-1?void t.trigger(Event.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+a}):(s=(1&e[i+2])<<2,s|=(192&e[i+3])>>>6,p.b.log("manifest codec:"+n+",ADTS data:type:"+r+",sampleingIndex:"+a+"["+c[a]+"Hz],channelConfig:"+s),/firefox/i.test(u)?a>=6?(r=5,l=new Array(4),o=a-3):(r=2,l=new Array(2),o=a):-1!==u.indexOf("android")?(r=2,l=new Array(2),o=a):(r=5,l=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&a>=6?o=a-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(a>=6&&1===s||/vivaldi/i.test(u))||!n&&1===s)&&(r=2,l=new Array(2)),o=a)),l[0]=r<<3,l[0]|=(14&a)>>1,l[1]|=(1&a)<<7,l[1]|=s<<3,5===r&&(l[1]|=(14&o)>>1,l[2]=(1&o)<<7,l[2]|=8,l[3]=0),{config:l,samplerate:c[a],channelCount:s,codec:"mp4a.40."+r,manifestCodec:d})}function r(t,e){return 255===t[e]&&240==(246&t[e+1])}function a(t,e){return 1&t[e+1]?7:9}function o(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function s(t,e){return!!(e+1<t.length&&r(t,e))}function l(t,e){if(e+1<t.length&&r(t,e)){var i=a(t,e),n=i;e+5<t.length&&(n=o(t,e));var s=e+n;if(s===t.length||s+1<t.length&&r(t,s))return!0}return!1}function u(t,e,i,r,a){if(!t.samplerate){var o=n(e,i,r,a);t.config=o.config,t.samplerate=o.samplerate,t.channelCount=o.channelCount,t.codec=o.codec,t.manifestCodec=o.manifestCodec,p.b.log("parsed codec:"+t.codec+",rate:"+o.samplerate+",nb channel:"+o.channelCount)}}function d(t){return 9216e4/t}function c(t,e,i,n,r){var s,l,u,d=t.length;if(s=a(t,e),l=o(t,e),(l-=s)>0&&e+s+l<=d)return u=i+n*r,{headerLength:s,frameLength:l,stamp:u}}function h(t,e,i,n,r){var a=d(t.samplerate),o=c(e,i,n,r,a);if(o){var s=o.stamp,l=o.headerLength,u=o.frameLength,h={unit:e.subarray(i+l,i+l+u),pts:s,dts:s};return t.samples.push(h),t.len+=u,{sample:h,length:u+l}}}e.d=s,e.e=l,e.c=u,e.b=d,e.a=h;var p=i(0),f=i(2)},function(t,e,i){"use strict";var n={
BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(t,e,i,n,r){if(!(i+24>e.length)){var a=this.parseHeader(e,i);if(a&&i+a.frameLength<=e.length){var o=9e4*a.samplesPerFrame/a.sampleRate,s=n+r*o,l={unit:e.subarray(i,i+a.frameLength),pts:s,dts:s};return t.config=[],t.channelCount=a.channelCount,t.samplerate=a.sampleRate,t.samples.push(l),t.len+=a.frameLength,{sample:l,length:a.frameLength}}}},parseHeader:function(t,e){var i=t[e+1]>>3&3,r=t[e+1]>>1&3,a=t[e+2]>>4&15,o=t[e+2]>>2&3,s=t[e+2]>>1&1;if(1!==i&&0!==a&&15!==a&&3!==o){var l=3===i?3-r:3===r?3:4,u=1e3*n.BitratesMap[14*l+a-1],d=3===i?0:2===i?1:2,c=n.SamplingRateMap[3*d+o],h=t[e+3]>>6==3?1:2,p=n.SamplesCoefficients[i][r],f=n.BytesInSlot[r],y=8*p*f;return{sampleRate:c,channelCount:h,frameLength:parseInt(p*u/c+s,10)*f,samplesPerFrame:y}}},isHeaderPattern:function(t,e){return 255===t[e]&&224==(224&t[e+1])&&0!=(6&t[e+1])},isHeader:function(t,e){return!!(e+1<t.length&&this.isHeaderPattern(t,e))},probe:function(t,e){if(e+1<t.length&&this.isHeaderPattern(t,e)){var i=this.parseHeader(t,e),n=4;i&&i.frameLength&&(n=i.frameLength);var r=e+n;if(r===t.length||r+1<t.length&&this.isHeaderPattern(t,r))return!0}return!1}};e.a=n},function(t,e,i){"use strict";function n(t,e,i){var n=t[e],r=t[i],a=r.startPTS;isNaN(a)?r.start=i>e?n.start+n.duration:Math.max(n.start-r.duration,0):i>e?(n.duration=a-n.start,n.duration<0&&o.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(r.duration=n.start-a,r.duration<0&&o.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!"))}function r(t,e,i,r,a,o){var s=i;if(!isNaN(e.startPTS)){var l=Math.abs(e.startPTS-i);isNaN(e.deltaPTS)?e.deltaPTS=l:e.deltaPTS=Math.max(l,e.deltaPTS),s=Math.max(i,e.startPTS),i=Math.min(i,e.startPTS),r=Math.max(r,e.endPTS),a=Math.min(a,e.startDTS),o=Math.max(o,e.endDTS)}var u=i-e.start;e.start=e.startPTS=i,e.maxStartPTS=s,e.endPTS=r,e.startDTS=a,e.endDTS=o,e.duration=r-i;var d=e.sn;if(!t||d<t.startSN||d>t.endSN)return 0;var c,h,p;for(c=d-t.startSN,h=t.fragments,h[c]=e,p=c;p>0;p--)n(h,p,p-1);for(p=c;p<h.length-1;p++)n(h,p,p+1);return t.PTSKnown=!0,u}function a(t,e){var i,n=Math.max(t.startSN,e.startSN)-e.startSN,a=Math.min(t.endSN,e.endSN)-e.startSN,s=e.startSN-t.startSN,l=t.fragments,u=e.fragments,d=0;if(a<n)return void(e.PTSKnown=!1);for(var c=n;c<=a;c++){var h=l[s+c],p=u[c];p&&h&&(d=h.cc-p.cc,isNaN(h.startPTS)||(p.start=p.startPTS=h.startPTS,p.endPTS=h.endPTS,p.duration=h.duration,p.backtracked=h.backtracked,p.dropped=h.dropped,i=p))}if(d)for(o.b.log("discontinuity sliding from playlist, take drift into account"),c=0;c<u.length;c++)u[c].cc+=d;if(i)r(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS);else if(s>=0&&s<l.length){var f=l[s].start;for(c=0;c<u.length;c++)u[c].start+=f}e.PTSKnown=t.PTSKnown}e.b=r,e.a=a;var o=i(0)},function(t,e,i){"use strict";var n={toString:function(t){for(var e="",i=t.length,n=0;n<i;n++)e+="["+t.start(n).toFixed(3)+","+t.end(n).toFixed(3)+"]";return e}};e.a=n},function(t,e,i){"use strict";function n(t,e){for(var i=null,n=0;n<t.length;n+=1){var r=t[n];if(r&&r.cc===e){i=r;break}}return i}function r(t,e){return u.a.search(t,function(t){return t.cc<e?1:t.cc>e?-1:0})}function a(t,e,i){var n=!1;return e&&e.details&&i&&(i.endCC>i.startCC||t&&t.cc<i.startCC)&&(n=!0),n}function o(t,e){var i=t.fragments,r=e.fragments;if(!r.length||!i.length)return void d.b.log("No fragments to align");var a=n(i,r[0].cc);return!a||a&&!a.startPTS?void d.b.log("No frag in previous level to align on"):a}function s(t,e){e.fragments.forEach(function(e){if(e){var i=e.start+t;e.start=e.startPTS=i,e.endPTS=i+e.duration}}),e.PTSKnown=!0}function l(t,e,i){if(a(t,e,i)){var n=o(e.details,i);n&&(d.b.log("Adjusting PTS using last level due to CC increase within current level"),s(n.start,i))}if(!1===i.PTSKnown&&e&&e.details){var r=e.details.programDateTime,l=i.programDateTime,u=(l-r)/1e3+e.details.fragments[0].start;isNaN(u)||(d.b.log("adjusting PTS using programDateTime delta, sliding:"+u.toFixed(3)),s(u,i))}}e.b=r,e.a=l;var u=i(6),d=i(0)},function(t,e,i){"use strict";function n(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new d,this.regionList=[]}function r(t){function e(t,e,i,n){return 3600*(0|t)+60*(0|e)+(0|i)+(0|n)/1e3}var i=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?e(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?e(i[1],i[2],0,i[4]):e(0,i[1],i[2],i[4]):null}function a(){this.values=Object.create(null)}function o(t,e,i,n){var r=n?t.split(n):[t];for(var a in r)if("string"==typeof r[a]){var o=r[a].split(i);if(2===o.length){var s=o[0],l=o[1];e(s,l)}}}function s(t,e,i){function n(){var e=r(t);if(null===e)throw new Error("Malformed timestamp: "+l);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function s(){t=t.replace(/^\s+/,"")}var l=t;if(s(),e.startTime=n(),s(),"--\x3e"!==t.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+l);t=t.substr(3),s(),e.endTime=n(),s(),function(t,e){var n=new a;o(t,function(t,e){switch(t){case"region":for(var r=i.length-1;r>=0;r--)if(i[r].id===e){n.set(t,i[r].region);break}break;case"vertical":n.alt(t,e,["rl","lr"]);break;case"line":var a=e.split(","),o=a[0];n.integer(t,o),n.percent(t,o)&&n.set("snapToLines",!1),n.alt(t,o,["auto"]),2===a.length&&n.alt("lineAlign",a[1],["start",h,"end"]);break;case"position":a=e.split(","),n.percent(t,a[0]),2===a.length&&n.alt("positionAlign",a[1],["start",h,"end","line-left","line-right","auto"]);break;case"size":n.percent(t,e);break;case"align":n.alt(t,e,["start",h,"end","left","right"])}},/:/,/\s/),e.region=n.get("region",null),e.vertical=n.get("vertical","");var r=n.get("line","auto");"auto"===r&&-1===c.line&&(r=-1),e.line=r,e.lineAlign=n.get("lineAlign","start"),e.snapToLines=n.get("snapToLines",!0),e.size=n.get("size",100),e.align=n.get("align",h);var s=n.get("position","auto");"auto"===s&&50===c.position&&(s="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=s}(t,e)}function l(t){return t.replace(/<br(?: \/)?>/gi,"\n")}i.d(e,"b",function(){return l});var u=i(59),d=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};a.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,i){for(var n=0;n<i.length;++n)if(e===i[n]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e))>=0&&e<=100)&&(this.set(t,e),!0)}};var c=new u.a(0,0,0),h="middle"===c.align?"middle":"center";n.prototype={parse:function(t){function e(){var t=i.buffer,e=0;for(t=l(t);e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var n=t.substr(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,i.buffer=t.substr(e),n}var i=this;t&&(i.buffer+=i.decoder.decode(t,{stream:!0}));try{var n;if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;n=e();var r=n.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!r||!r[0])throw new Error("Malformed WebVTT signature.");i.state="HEADER"}for(var a=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(a?a=!1:n=e(),i.state){case"HEADER":/:/.test(n)?function(t){o(t,function(t,e){switch(t){case"Region":console.log("parse region",e)}},/:/)}(n):n||(i.state="ID");continue;case"NOTE":n||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){i.state="NOTE";break}if(!n)continue;if(i.cue=new u.a(0,0,""),i.state="CUE",-1===n.indexOf("--\x3e")){i.cue.id=n;continue}case"CUE":try{s(n,i.cue,i.regionList)}catch(t){i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var d=-1!==n.indexOf("--\x3e");if(!n||d&&(a=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+="\n"),i.cue.text+=n;continue;case"BADCUE":n||(i.state="ID");continue}}}catch(t){"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new Error("Malformed WebVTT signature.")}catch(t){throw t}return t.onflush&&t.onflush(),this}},e.a=n},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=i(4),a=i.n(r),o=i(1),s=i(2),l=i(24),u=i(28),d=i(29),c=i(30),h=i(45),p=i(46),f=i(47),y=i(0),v=i(9),m=i.n(v),g=i(48),b=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(68);var E=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,t);var r=t.DefaultConfig;if((i.liveSyncDurationCount||i.liveMaxLatencyDurationCount)&&(i.liveSyncDuration||i.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var a in r)a in i||(i[a]=r[a]);if(void 0!==i.liveMaxLatencyDurationCount&&i.liveMaxLatencyDurationCount<=i.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==i.liveMaxLatencyDuration&&(i.liveMaxLatencyDuration<=i.liveSyncDuration||void 0===i.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(y.a)(i.debug),this.config=i,this._autoLevelCapping=-1;var o=this.observer=new m.a;o.trigger=function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];o.emit.apply(o,[t,t].concat(i))},o.off=function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];o.removeListener.apply(o,[t].concat(i))},this.on=o.on.bind(o),this.off=o.off.bind(o),this.trigger=o.trigger.bind(o);var s=this.abrController=new i.abrController(this),f=new i.bufferController(this),v=new i.capLevelController(this),g=new i.fpsController(this),b=new l.a(this),E=new u.a(this),T=new d.a(this),w=new p.a(this),S=this.levelController=new h.a(this),_=this.streamController=new c.a(this),k=[S,_],L=i.audioStreamController;L&&k.push(new L(this)),this.networkControllers=k;var R=[b,E,T,s,f,v,g,w];if(L=i.audioTrackController){var A=new L(this);this.audioTrackController=A,R.push(A)}if(L=i.subtitleTrackController){var D=new L(this);this.subtitleTrackController=D,R.push(D)}if(L=i.emeController){var x=new L(this);this.emeController=x,R.push(x)}[i.subtitleStreamController,i.timelineController].forEach(function(t){t&&R.push(new t(e))}),this.coreComponents=R}return t.isSupported=function(){return Object(f.a)()},b(t,null,[{key:"version",get:function(){return"0.8.9"}},{key:"Events",get:function(){return o.a}},{key:"ErrorTypes",get:function(){return s.b}},{key:"ErrorDetails",get:function(){return s.a}},{key:"DefaultConfig",get:function(){return t.defaultConfig?t.defaultConfig:g.a},set:function(e){t.defaultConfig=e}}]),t.prototype.destroy=function(){y.b.log("destroy"),this.trigger(o.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(t){t.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1},t.prototype.attachMedia=function(t){y.b.log("attachMedia"),this.media=t,this.trigger(o.a.MEDIA_ATTACHING,{media:t})},t.prototype.detachMedia=function(){y.b.log("detachMedia"),this.trigger(o.a.MEDIA_DETACHING),this.media=null},t.prototype.loadSource=function(t){t=a.a.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:!0}),y.b.log("loadSource:"+t),this.url=t,this.trigger(o.a.MANIFEST_LOADING,{url:t})},t.prototype.startLoad=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;y.b.log("startLoad("+t+")"),this.networkControllers.forEach(function(e){e.startLoad(t)})},t.prototype.stopLoad=function(){y.b.log("stopLoad"),this.networkControllers.forEach(function(t){t.stopLoad()})},t.prototype.swapAudioCodec=function(){y.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},t.prototype.recoverMediaError=function(){y.b.log("recoverMediaError");var t=this.media;this.detachMedia(),this.attachMedia(t)},b(t,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){y.b.log("set currentLevel:"+t),this.loadLevel=t,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){y.b.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){y.b.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){y.b.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(t){y.b.log("set startLevel:"+t);var e=this;-1!==t&&(t=Math.max(t,e.minAutoLevel)),e.levelController.startLevel=t}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){y.b.log("set autoLevelCapping:"+t),this._autoLevelCapping=t}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var t=this,e=t.levels,i=t.config.minAutoBitrate,n=e?e.length:0,r=0;r<n;r++)if((e[r].realBitrate?Math.max(e[r].realBitrate,e[r].bitrate):e[r].bitrate)>i)return r;return 0}},{key:"maxAutoLevel",get:function(){var t=this,e=t.levels,i=t.autoLevelCapping;return-1===i&&e&&e.length?e.length-1:i}},{key:"nextAutoLevel",get:function(){var t=this;return Math.min(Math.max(t.abrController.nextAutoLevel,t.minAutoLevel),t.maxAutoLevel)},set:function(t){var e=this;e.abrController.nextAutoLevel=Math.max(e.minAutoLevel,t)}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}},{key:"subtitleDisplay",get:function(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}}]),t}();e.default=E},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(3),l=i(2),u=i(0),d=i(12),c=i(25),h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),p={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},f=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,o.a.MANIFEST_LOADING,o.a.LEVEL_LOADING,o.a.AUDIO_TRACK_LOADING,o.a.SUBTITLE_TRACK_LOADING));return a.loaders={},a}return a(e,t),e.canHaveQualityLevels=function(t){return t!==p.AUDIO_TRACK&&t!==p.SUBTITLE_TRACK},e.mapContextToLevelType=function(t){switch(t.type){case p.AUDIO_TRACK:return"audio";case p.SUBTITLE_TRACK:return"subtitle";default:return"main"}},e.getResponseUrl=function(t,e){var i=t.url;return void 0!==i&&0!==i.indexOf("data:")||(i=e.url),i},e.prototype.createInternalLoader=function(t){var e=this.hls.config,i=e.pLoader,n=e.loader,r=i||n,a=new r(e);return t.loader=n,this.loaders[t.type]=a,a},e.prototype.getInternalLoader=function(t){return this.loaders[t.type]},e.prototype.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},e.prototype.destroyInternalLoaders=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}},e.prototype.destroy=function(){this.destroyInternalLoaders(),t.prototype.destroy.call(this)},e.prototype.onManifestLoading=function(t){this.load(t.url,{type:p.MANIFEST})},e.prototype.onLevelLoading=function(t){this.load(t.url,{type:p.LEVEL,level:t.level,id:t.id})},e.prototype.onAudioTrackLoading=function(t){this.load(t.url,{type:p.AUDIO_TRACK,id:t.id})},e.prototype.onSubtitleTrackLoading=function(t){this.load(t.url,{type:p.SUBTITLE_TRACK,id:t.id})},e.prototype.load=function(t,e){var i=this.hls.config,n=this.getInternalLoader(e);if(n){var r=n.context;if(r&&r.url===t)return u.b.trace("playlist request ongoing"),!1;u.b.warn("aborting previous loader for type: "+e.type),n.abort()}var a=void 0,o=void 0,s=void 0,l=void 0;switch(e.type){case p.MANIFEST:a=i.manifestLoadingMaxRetry,o=i.manifestLoadingTimeOut,s=i.manifestLoadingRetryDelay,l=i.manifestLoadingMaxRetryTimeout;break;case p.LEVEL:a=0,o=i.levelLoadingTimeOut;break;default:a=i.levelLoadingMaxRetry,o=i.levelLoadingTimeOut,s=i.levelLoadingRetryDelay,l=i.levelLoadingMaxRetryTimeout,u.b.log("Playlist loader for "+e.type+" "+(e.level||e.id))}n=this.createInternalLoader(e),e.url=t,e.responseType=e.responseType||"";var d=void 0,c=void 0;return d={timeout:o,maxRetry:a,retryDelay:s,maxRetryDelay:l},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},n.load(e,d,c),!0},e.prototype.loadsuccess=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i.isSidxRequest)return this._handleSidxRequest(t,i),void this._handlePlaylistLoaded(t,e,i,n);this.resetInternalLoader(i.type);var r=t.data;if(e.tload=performance.now(),0!==r.indexOf("#EXTM3U"))return void this._handleManifestParsingError(t,i,"no EXTM3U delimiter",n);r.indexOf("#EXTINF:")>0?this._handleTrackOrLevelPlaylist(t,e,i,n):this._handleMasterPlaylist(t,e,i,n)},e.prototype.loaderror=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._handleNetworkError(e,i)},e.prototype.loadtimeout=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._handleNetworkError(e,i)},e.prototype._handleMasterPlaylist=function(t,i,n,r){var a=this.hls,s=t.data,l=e.getResponseUrl(t,n),d=c.a.parseMasterPlaylist(s,l);if(!d.length)return void this._handleManifestParsingError(t,n,"no level found in manifest",r);var h=d.map(function(t){return{id:t.attrs.AUDIO,codec:t.audioCodec}}),p=c.a.parseMasterPlaylistMedia(s,l,"AUDIO",h),f=c.a.parseMasterPlaylistMedia(s,l,"SUBTITLES");if(p.length){var y=!1;p.forEach(function(t){t.url||(y=!0)}),!1===y&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(u.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main"}))}a.trigger(o.a.MANIFEST_LOADED,{levels:d,audioTracks:p,subtitles:f,url:l,stats:i,networkDetails:r})},e.prototype._handleTrackOrLevelPlaylist=function(t,i,n,r){var a=this.hls,s=n.id,l=n.level,u=n.type,d=e.getResponseUrl(t,n),h=isNaN(l)?isNaN(s)?0:s:l,f=e.mapContextToLevelType(n),y=c.a.parseLevelPlaylist(t.data,d,h,f);if(y.tload=i.tload,u===p.MANIFEST){var v={url:d,details:y};a.trigger(o.a.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:d,stats:i,networkDetails:r})}if(i.tparsed=performance.now(),y.needSidxRanges){var m=y.initSegment.url;return void this.load(m,{isSidxRequest:!0,type:u,level:l,levelDetails:y,id:s,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}n.levelDetails=y,this._handlePlaylistLoaded(t,i,n,r)},e.prototype._handleSidxRequest=function(t,e){var i=d.a.parseSegmentIndex(new Uint8Array(t.data));i.references.forEach(function(t,i){var n=t.info,r=e.levelDetails.fragments[i];0===r.byteRange.length&&(r.rawByteRange=String(1+n.end-n.start)+"@"+String(n.start))}),e.levelDetails.initSegment.rawByteRange=String(i.moovEndOffset)+"@0"},e.prototype._handleManifestParsingError=function(t,e,i,n){this.hls.trigger(o.a.ERROR,{type:l.b.NETWORK_ERROR,details:l.a.MANIFEST_PARSING_ERROR,fatal:!0,url:t.url,reason:i,networkDetails:n})},e.prototype._handleNetworkError=function(t,e){var i=void 0,n=void 0,r=t.loader;switch(t.type){case p.MANIFEST:i=l.a.MANIFEST_LOAD_TIMEOUT,n=!0;break;case p.LEVEL:i=l.a.LEVEL_LOAD_TIMEOUT,n=!1;break;case p.AUDIO_TRACK:i=l.a.AUDIO_TRACK_LOAD_TIMEOUT,n=!1;break;default:n=!1}r&&(r.abort(),this.resetInternalLoader(t.type)),this.hls.trigger(o.a.ERROR,{type:l.b.NETWORK_ERROR,details:i,fatal:n,url:r.url,loader:r,context:t,networkDetails:e})},e.prototype._handlePlaylistLoaded=function(t,i,n,r){var a=n.type,s=n.level,l=n.id,u=n.levelDetails;if(!u.targetduration)return void this._handleManifestParsingError(t,n,"invalid target duration",r);if(e.canHaveQualityLevels(n.type))this.hls.trigger(o.a.LEVEL_LOADED,{details:u,level:s||0,id:l||0,stats:i,networkDetails:r});else switch(a){case p.AUDIO_TRACK:this.hls.trigger(o.a.AUDIO_TRACK_LOADED,{details:u,id:l,stats:i,networkDetails:r});break;case p.SUBTITLE_TRACK:this.hls.trigger(o.a.SUBTITLE_TRACK_LOADED,{details:u,id:l,stats:i,networkDetails:r})}},h(e,null,[{key:"ContextType",get:function(){return p}}]),e}(s.a);e.a=f},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(4),a=i.n(r),o=i(26),s=i(13),l=i(27),u=i(0),d=i(14),c=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,h=/#EXT-X-MEDIA:(.*)/g,p=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),f=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,y=function(){function t(){n(this,t)}return t.findGroup=function(t,e){if(!t)return null;for(var i=null,n=0;n<t.length;n++){var r=t[n];r.id===e&&(i=r)}return i},t.convertAVC1ToAVCOTI=function(t){var e,i=t.split(".");return i.length>2?(e=i.shift()+".",e+=parseInt(i.shift()).toString(16),e+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):e=t,e},t.resolve=function(t,e){return a.a.buildAbsoluteURL(e,t,{alwaysNormalize:!0})},t.parseMasterPlaylist=function(e,i){var n=[],r=void 0;for(c.lastIndex=0;null!=(r=c.exec(e));){var a={},o=a.attrs=new l.a(r[1]);a.url=t.resolve(r[2],i);var s=o.decimalResolution("RESOLUTION");s&&(a.width=s.width,a.height=s.height),a.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),a.name=o.NAME,function(t,e){["video","audio"].forEach(function(i){var n=t.filter(function(t){return Object(d.b)(t,i)});if(n.length){var r=n.filter(function(t){return 0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)});e[i+"Codec"]=r.length>0?r[0]:n[0],t=t.filter(function(t){return-1===n.indexOf(t)})}}),e.unknownCodecs=t}([].concat((o.CODECS||"").split(/[ ,]+/)),a),a.videoCodec&&-1!==a.videoCodec.indexOf("avc1")&&(a.videoCodec=t.convertAVC1ToAVCOTI(a.videoCodec)),n.push(a)}return n},t.parseMasterPlaylistMedia=function(e,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=void 0,o=[],s=0;for(h.lastIndex=0;null!==(a=h.exec(e));){var u={},d=new l.a(a[1]);if(d.TYPE===n){if(u.groupId=d["GROUP-ID"],u.name=d.NAME,u.type=n,u.default="YES"===d.DEFAULT,u.autoselect="YES"===d.AUTOSELECT,u.forced="YES"===d.FORCED,d.URI&&(u.url=t.resolve(d.URI,i)),u.lang=d.LANGUAGE,u.name||(u.name=u.lang),r.length){var c=t.findGroup(r,u.groupId);u.audioCodec=c?c.codec:r[0].codec}u.id=s++,o.push(u)}}return o},t.parseLevelPlaylist=function(t,e,i,n){var r,a,d=0,c=0,h={type:null,version:null,url:e,fragments:[],live:!0,startSN:0},y=new s.a,v=0,m=null,g=new o.a;for(p.lastIndex=0;null!==(r=p.exec(t));){var b=r[1];if(b){g.duration=parseFloat(b);var E=(" "+r[2]).slice(1);g.title=E||null,g.tagList.push(E?["INF",b,E]:["INF",b])}else if(r[3]){if(!isNaN(g.duration)){var T=d++;g.type=n,g.start=c,g.levelkey=y,g.sn=T,g.level=i,g.cc=v,g.baseurl=e,g.relurl=(" "+r[3]).slice(1),h.fragments.push(g),m=g,c+=g.duration,g=new o.a}}else if(r[4]){if(g.rawByteRange=(" "+r[4]).slice(1),m){var w=m.byteRangeEndOffset;w&&(g.lastByteRangeEndOffset=w)}}else if(r[5])g.rawProgramDateTime=(" "+r[5]).slice(1),g.tagList.push(["PROGRAM-DATE-TIME",g.rawProgramDateTime]),void 0===h.programDateTime&&(h.programDateTime=new Date(new Date(Date.parse(r[5]))-1e3*c));else{for(r=r[0].match(f),a=1;a<r.length&&void 0===r[a];a++);var S=(" "+r[a+1]).slice(1),_=(" "+r[a+2]).slice(1);switch(r[a]){case"#":g.tagList.push(_?[S,_]:[S]);break;case"PLAYLIST-TYPE":h.type=S.toUpperCase();break;case"MEDIA-SEQUENCE":d=h.startSN=parseInt(S);break;case"TARGETDURATION":h.targetduration=parseFloat(S);break;case"VERSION":h.version=parseInt(S);break;case"EXTM3U":break;case"ENDLIST":h.live=!1;break;case"DIS":v++,g.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":v=parseInt(S);break;case"KEY":var k=S,L=new l.a(k),R=L.enumeratedString("METHOD"),A=L.URI,D=L.hexadecimalInteger("IV");R&&(y=new s.a,A&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(R)>=0&&(y.method=R,y.baseuri=e,y.reluri=A,y.key=null,y.iv=D));break;case"START":var x=S,I=new l.a(x),O=I.decimalFloatingPoint("TIME-OFFSET");isNaN(O)||(h.startTimeOffset=O);break;case"MAP":var C=new l.a(S);g.relurl=C.URI,g.rawByteRange=C.BYTERANGE,g.baseurl=e,g.level=i,g.type=n,g.sn="initSegment",h.initSegment=g,g=new o.a;break;default:u.b.warn("line parsed but not handled: "+r)}}}return g=m,g&&!g.relurl&&(h.fragments.pop(),c-=g.duration),h.totalduration=c,h.averagetargetduration=c/h.fragments.length,h.endSN=d-1,h.startCC=h.fragments[0]?h.fragments[0].cc:0,h.endCC=v,!h.initSegment&&h.fragments.length&&h.fragments.every(function(t){return t.relurl.endsWith(".mp4")})&&(u.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),g=new o.a,g.relurl=h.fragments[0].relurl,g.baseurl=e,g.level=i,g.type=n,g.sn="initSegment",h.initSegment=g,h.needSidxRanges=!0),h},t}();e.a=y},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(4),a=i.n(r),o=i(13),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function(){function t(){n(this,t),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return t.prototype.createInitializationVector=function(t){for(var e=new Uint8Array(16),i=12;i<16;i++)e[i]=t>>8*(15-i)&255;return e},t.prototype.fragmentDecryptdataFromLevelkey=function(t,e){var i=t;return t&&t.method&&t.uri&&!t.iv&&(i=new o.a,i.method=t.method,i.baseuri=t.baseuri,i.reluri=t.reluri,i.iv=this.createInitializationVector(e)),i},t.prototype.cloneObj=function(t){return JSON.parse(JSON.stringify(t))},s(t,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=a.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(t){this._url=t}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var t=[];if(this.rawByteRange){var e=this.rawByteRange.split("@",2);if(1===e.length){var i=this.lastByteRangeEndOffset;t[0]=i||0}else t[0]=parseInt(e[1]);t[1]=parseInt(e[0])+t[0],this._byteRange=t}return t}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),t}();e.a=l},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function t(e){n(this,t),"string"==typeof e&&(e=t.parseAttrList(e));for(var i in e)e.hasOwnProperty(i)&&(this[i]=e[i])}return t.prototype.decimalInteger=function(t){var e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},t.prototype.hexadecimalInteger=function(t){if(this[t]){var e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var i=new Uint8Array(e.length/2),n=0;n<e.length/2;n++)i[n]=parseInt(e.slice(2*n,2*n+2),16);return i}return null},t.prototype.hexadecimalIntegerAsNumber=function(t){var e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},t.prototype.decimalFloatingPoint=function(t){return parseFloat(this[t])},t.prototype.enumeratedString=function(t){return this[t]},t.prototype.decimalResolution=function(t){var e=r.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},t.parseAttrList=function(t){var e,i={};for(a.lastIndex=0;null!==(e=a.exec(t));){var n=e[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),i[e[1]]=n}return i},t}();e.a=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(3),l=i(2),u=i(0),d=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,o.a.FRAG_LOADING));return a.loaders={},a}return a(e,t),e.prototype.destroy=function(){var e=this.loaders;for(var i in e){var n=e[i];n&&n.destroy()}this.loaders={},t.prototype.destroy.call(this)},e.prototype.onFragLoading=function(t){
var e=t.frag,i=e.type,n=this.loaders,r=this.hls.config,a=r.fLoader,o=r.loader;e.loaded=0;var s=n[i];s&&(u.b.warn("abort previous fragment loader for type: "+i),s.abort()),s=n[i]=e.loader=r.fLoader?new a(r):new o(r);var l=void 0,d=void 0,c=void 0;l={url:e.url,frag:e,responseType:"arraybuffer",progressData:!1};var h=e.byteRangeStartOffset,p=e.byteRangeEndOffset;isNaN(h)||isNaN(p)||(l.rangeStart=h,l.rangeEnd=p),d={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},s.load(l,d,c)},e.prototype.loadsuccess=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=t.data,a=i.frag;a.loader=void 0,this.loaders[a.type]=void 0,this.hls.trigger(o.a.FRAG_LOADED,{payload:r,frag:a,stats:e,networkDetails:n})},e.prototype.loaderror=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(o.a.ERROR,{type:l.b.NETWORK_ERROR,details:l.a.FRAG_LOAD_ERROR,fatal:!1,frag:e.frag,response:t,networkDetails:i})},e.prototype.loadtimeout=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(o.a.ERROR,{type:l.b.NETWORK_ERROR,details:l.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e.frag,networkDetails:i})},e.prototype.loadprogress=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=e.frag;r.loaded=t.loaded,this.hls.trigger(o.a.FRAG_LOAD_PROGRESS,{frag:r,stats:t,networkDetails:n})},e}(s.a);e.a=d},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(3),l=i(2),u=i(0),d=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,o.a.KEY_LOADING));return a.loaders={},a.decryptkey=null,a.decrypturl=null,a}return a(e,t),e.prototype.destroy=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy()}this.loaders={},s.a.prototype.destroy.call(this)},e.prototype.onKeyLoading=function(t){var e=t.frag,i=e.type,n=this.loaders[i],r=e.decryptdata,a=r.uri;if(a!==this.decrypturl||null===this.decryptkey){var s=this.hls.config;n&&(u.b.warn("abort previous key loader for type:"+i),n.abort()),e.loader=this.loaders[i]=new s.loader(s),this.decrypturl=a,this.decryptkey=null;var l=void 0,d=void 0,c=void 0;l={url:a,frag:e,responseType:"arraybuffer"},d={timeout:s.fragLoadingTimeOut,maxRetry:s.fragLoadingMaxRetry,retryDelay:s.fragLoadingRetryDelay,maxRetryDelay:s.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},e.loader.load(l,d,c)}else this.decryptkey&&(r.key=this.decryptkey,this.hls.trigger(o.a.KEY_LOADED,{frag:e}))},e.prototype.loadsuccess=function(t,e,i){var n=i.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(t.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(o.a.KEY_LOADED,{frag:n})},e.prototype.loaderror=function(t,e){var i=e.frag,n=i.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(o.a.ERROR,{type:l.b.NETWORK_ERROR,details:l.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:t})},e.prototype.loadtimeout=function(t,e){var i=e.frag,n=i.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(o.a.ERROR,{type:l.b.NETWORK_ERROR,details:l.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},e}(s.a);e.a=d},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(6),s=i(7),l=i(15),u=i(1),d=i(19),c=i(20),h=i(2),p=i(0),f=i(21),y=i(11),v=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),m={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},g=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.MANIFEST_LOADING,u.a.MANIFEST_PARSED,u.a.LEVEL_LOADED,u.a.KEY_LOADED,u.a.FRAG_LOADED,u.a.FRAG_LOAD_EMERGENCY_ABORTED,u.a.FRAG_PARSING_INIT_SEGMENT,u.a.FRAG_PARSING_DATA,u.a.FRAG_PARSED,u.a.ERROR,u.a.AUDIO_TRACK_SWITCHING,u.a.AUDIO_TRACK_SWITCHED,u.a.BUFFER_CREATED,u.a.BUFFER_APPENDED,u.a.BUFFER_FLUSHED));return a.config=i.config,a.audioCodecSwap=!1,a._state=m.STOPPED,a}return a(e,t),e.prototype.onHandlerDestroying=function(){this.stopLoad()},e.prototype.onHandlerDestroyed=function(){this.state=m.STOPPED},e.prototype.startLoad=function(t){if(this.levels){var e=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=i.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=i.nextLoadLevel=n,this.loadedmetadata=!1}e>0&&-1===t&&(p.b.log("override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e),this.state=m.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this.forceStartLoad=!0,this.state=m.STOPPED},e.prototype.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=m.STOPPED,this.forceStartLoad=!1},e.prototype.doTick=function(){switch(this.state){case m.ERROR:break;case m.BUFFER_FLUSHING:this.fragLoadError=0;break;case m.IDLE:this._doTickIdle();break;case m.WAITING_LEVEL:var t=this.levels[this.level];t&&t.details&&(this.state=m.IDLE);break;case m.FRAG_LOADING_WAITING_RETRY:var e=performance.now(),i=this.retryDate;(!i||e>=i||this.media&&this.media.seeking)&&(p.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=m.IDLE);break;case m.ERROR:case m.STOPPED:case m.FRAG_LOADING:case m.PARSING:case m.PARSED:case m.ENDED:}this._checkBuffer(),this._checkFragmentChanged()},e.prototype._doTickIdle=function(){var t=this.hls,e=t.config,i=this.media;if(void 0!==this.levelLastLoaded&&(i||!this.startFragRequested&&e.startFragPrefetch)){var n=void 0;n=this.loadedmetadata?i.currentTime:this.nextLoadPosition;var r=t.nextLoadLevel,a=this.levels[r];if(a){var o=a.bitrate,l=void 0;l=o?Math.max(8*e.maxBufferSize/o,e.maxBufferLength):e.maxBufferLength,l=Math.min(l,e.maxMaxBufferLength);var d=s.a.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,n,e.maxBufferHole),c=d.len;if(!(c>=l)){p.b.trace("buffer length of "+c.toFixed(3)+" is below max of "+l.toFixed(3)+". checking for more payload ..."),this.level=t.nextLoadLevel=r;var h=a.details;if(void 0===h||!0===h.live&&this.levelLastLoaded!==r)return void(this.state=m.WAITING_LEVEL);var f=this.fragPrevious;if(!h.live&&f&&!f.backtracked&&f.sn===h.endSN&&!d.nextStart&&Math.min(i.duration,f.start+f.duration)-Math.max(d.end,f.start)<=Math.max(.2,f.duration)){var y={};return this.altAudio&&(y.type="video"),this.hls.trigger(u.a.BUFFER_EOS,y),void(this.state=m.ENDED)}this._fetchPayloadOrEos(n,d,h)}}}},e.prototype._fetchPayloadOrEos=function(t,e,i){var n=this.fragPrevious,r=this.level,a=i.fragments,o=a.length;if(0!==o){var s=a[0].start,l=a[o-1].start+a[o-1].duration,u=e.end,d=void 0;if(i.initSegment&&!i.initSegment.data)d=i.initSegment;else if(i.live){var c=this.config.initialLiveManifestSize;if(o<c)return void p.b.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+c);if(null===(d=this._ensureFragmentAtLivePoint(i,u,s,l,n,a,o)))return}else u<s&&(d=a[0]);d||(d=this._findFragment(s,n,o,a,u,l,i)),d&&this._loadFragmentOrKey(d,r,i,t,u)}},e.prototype._ensureFragmentAtLivePoint=function(t,e,i,n,r,a,s){var l=this.hls.config,u=this.media,d=void 0,c=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*t.targetduration;if(e<Math.max(i-l.maxFragLookUpTolerance,n-c)){var h=this.liveSyncPosition=this.computeLivePosition(i,t);p.b.log("buffer end: "+e.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),e=h,u&&u.readyState&&u.duration>h&&(u.currentTime=h),this.nextLoadPosition=h}if(t.PTSKnown&&e>n&&u&&u.readyState)return null;if(this.startFragRequested&&!t.PTSKnown){if(r){var f=r.sn+1;if(f>=t.startSN&&f<=t.endSN){var y=a[f-t.startSN];r.cc===y.cc&&(d=y,p.b.log("live playlist, switching playlist, load frag with next SN: "+d.sn))}d||(d=o.a.search(a,function(t){return r.cc-t.cc}))&&p.b.log("live playlist, switching playlist, load frag with same CC: "+d.sn)}d||(d=a[Math.min(s-1,Math.round(s/2))],p.b.log("live playlist, switching playlist, unknown, load middle frag : "+d.sn))}return d},e.prototype._findFragment=function(t,e,i,n,r,a,s){var l=this.hls.config,u=void 0,d=void 0,c=l.maxFragLookUpTolerance,h=e?n[e.sn-n[0].sn+1]:void 0,f=function(t){var e=Math.min(c,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-e<=r?1:t.start-e>r&&t.start?-1:0};if(r<a?(r>a-c&&(c=0),d=h&&!f(h)?h:o.a.search(n,f)):d=n[i-1],d){u=d;var y=u.sn-s.startSN,v=e&&u.level===e.level,m=n[y-1],g=n[y+1];if(e&&u.sn===e.sn)if(v&&!u.backtracked)if(u.sn<s.endSN){var b=e.deltaPTS;b&&b>l.maxBufferHole&&e.dropped&&y?(u=m,p.b.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),e.loadCounter--):(u=g,p.b.log("SN just loaded, load next one: "+u.sn))}else u=null;else u.backtracked&&(g&&g.backtracked?(p.b.warn("Already backtracked from fragment "+g.sn+", will not backtrack to fragment "+u.sn+". Loading fragment "+g.sn),u=g):(p.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),u.dropped=0,m?(m.loadCounter&&m.loadCounter--,u=m,u.backtracked=!0):y&&(u=null)))}return u},e.prototype._loadFragmentOrKey=function(t,e,i,n,r){var a=this.hls,o=a.config;if(!t.decryptdata||null==t.decryptdata.uri||null!=t.decryptdata.key){if(p.b.log("Loading "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+e+", currentTime:"+n.toFixed(3)+",bufferEnd:"+r.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,t.loadCounter){t.loadCounter++;var s=o.fragLoadingLoopThreshold;if(t.loadCounter>s&&Math.abs(this.fragLoadIdx-t.loadIdx)<s)return void a.trigger(u.a.ERROR,{type:h.b.MEDIA_ERROR,details:h.a.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:t})}else t.loadCounter=1;return t.loadIdx=this.fragLoadIdx,t.autoLevel=a.autoLevelEnabled,t.bitrateTest=this.bitrateTest,this.fragCurrent=t,this.startFragRequested=!0,isNaN(t.sn)||t.bitrateTest||(this.nextLoadPosition=t.start+t.duration),a.trigger(u.a.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new l.a(a,"main")),void(this.state=m.FRAG_LOADING)}p.b.log("Loading key for "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+e),this.state=m.KEY_LOADING,a.trigger(u.a.KEY_LOADING,{frag:t})},e.prototype.getBufferedFrag=function(t){return o.a.search(this._bufferedFrags,function(e){return t<e.startPTS?-1:t>e.endPTS?1:0})},e.prototype.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.endPTS+.5):null},e.prototype._checkFragmentChanged=function(){var t,e,i=this.media;if(i&&i.readyState&&!1===i.seeking&&(e=i.currentTime,e>i.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=e),s.a.isBuffered(i,e)?t=this.getBufferedFrag(e):s.a.isBuffered(i,e+.1)&&(t=this.getBufferedFrag(e+.1)),t)){var n=t;if(n!==this.fragPlaying){this.hls.trigger(u.a.FRAG_CHANGED,{frag:n});var r=n.level;this.fragPlaying&&this.fragPlaying.level===r||this.hls.trigger(u.a.LEVEL_SWITCHED,{level:r}),this.fragPlaying=n}}},e.prototype.immediateLevelSwitch=function(){if(p.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t=this.media,e=void 0;t?(e=t.paused,t.pause()):e=!0,this.previouslyPaused=e}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},e.prototype.immediateLevelSwitchEnd=function(){var t=this.media;t&&t.buffered.length&&(this.immediateSwitch=!1,s.a.isBuffered(t,t.currentTime)&&(t.currentTime-=1e-4),this.previouslyPaused||t.play())},e.prototype.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var e=void 0,i=void 0,n=void 0;if(void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),i=this.getBufferedFrag(t.currentTime),i&&i.startPTS>1&&this.flushMainBuffer(0,i.startPTS-1),t.paused)e=0;else{var r=this.hls.nextLoadLevel,a=this.levels[r],o=this.fragLastKbps;e=o&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*o)+1:0}if((n=this.getBufferedFrag(t.currentTime+e))&&(n=this.followingBufferedFrag(n))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}},e.prototype.flushMainBuffer=function(t,e){this.state=m.BUFFER_FLUSHING;var i={startOffset:t,endOffset:e};this.altAudio&&(i.type="video"),this.hls.trigger(u.a.BUFFER_FLUSHING,i)},e.prototype.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("seeked",this.onvseeked),e.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition)},e.prototype.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(p.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.levels;e&&e.forEach(function(t){t.details&&t.details.fragments.forEach(function(t){t.loadCounter=void 0,t.backtracked=void 0})}),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("seeked",this.onvseeked),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},e.prototype.onMediaSeeking=function(){var t=this.media,e=t?t.currentTime:void 0,i=this.config;isNaN(e)||p.b.log("media seeking to "+e.toFixed(3));var n=this.mediaBuffer?this.mediaBuffer:t,r=s.a.bufferInfo(n,e,this.config.maxBufferHole);if(this.state===m.FRAG_LOADING){var a=this.fragCurrent;if(0===r.len&&a){var o=i.maxFragLookUpTolerance,l=a.start-o,u=a.start+a.duration+o;e<l||e>u?(a.loader&&(p.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=m.IDLE):p.b.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===m.ENDED&&(0===r.len&&(this.fragPrevious=0),this.state=m.IDLE);t&&(this.lastCurrentTime=e),this.state!==m.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*i.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=e),this.tick()},e.prototype.onMediaSeeked=function(){var t=this.media,e=t?t.currentTime:void 0;isNaN(e)||p.b.log("media seeked to "+e.toFixed(3)),this.tick()},e.prototype.onMediaEnded=function(){p.b.log("media ended"),this.startPosition=this.lastCurrentTime=0},e.prototype.onManifestLoading=function(){p.b.log("trigger BUFFER_RESET"),this.hls.trigger(u.a.BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0},e.prototype.onManifestParsed=function(t){var e,i=!1,n=!1;t.levels.forEach(function(t){(e=t.audioCodec)&&(-1!==e.indexOf("mp4a.40.2")&&(i=!0),-1!==e.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=i&&n,this.audioCodecSwitch&&p.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1;var r=this.config;(r.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(r.startPosition)},e.prototype.onLevelLoaded=function(t){var e=t.details,i=t.level,n=this.levels[this.levelLastLoaded],r=this.levels[i],a=e.totalduration,o=0;if(p.b.log("level "+i+" loaded ["+e.startSN+","+e.endSN+"],duration:"+a),e.live){var s=r.details;s&&e.fragments.length>0?(d.a(s,e),o=e.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(o,s),e.PTSKnown&&!isNaN(o)?p.b.log("live playlist sliding:"+o.toFixed(3)):(p.b.log("live playlist - outdated PTS, unknown sliding"),Object(f.a)(this.fragPrevious,n,e))):(p.b.log("live playlist - first load, unknown sliding"),e.PTSKnown=!1,Object(f.a)(this.fragPrevious,n,e))}else e.PTSKnown=!1;if(r.details=e,this.levelLastLoaded=i,this.hls.trigger(u.a.LEVEL_UPDATED,{details:e,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var l=e.startTimeOffset;isNaN(l)?e.live?(this.startPosition=this.computeLivePosition(o,e),p.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(l<0&&(p.b.log("negative start time offset "+l+", count from end of last fragment"),l=o+a+l),p.b.log("start time offset found in playlist, adjust startPosition to "+l),this.startPosition=l),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===m.WAITING_LEVEL&&(this.state=m.IDLE),this.tick()},e.prototype.onKeyLoaded=function(){this.state===m.KEY_LOADING&&(this.state=m.IDLE,this.tick())},e.prototype.onFragLoaded=function(t){var e=this.fragCurrent,i=t.frag;if(this.state===m.FRAG_LOADING&&e&&"main"===i.type&&i.level===e.level&&i.sn===e.sn){var n=t.stats,r=this.levels[e.level],a=r.details;if(p.b.log("Loaded  "+e.sn+" of ["+a.startSN+" ,"+a.endSN+"],level "+e.level),this.bitrateTest=!1,this.stats=n,!0===i.bitrateTest&&this.hls.nextLoadLevel)this.state=m.IDLE,this.startFragRequested=!1,n.tparsed=n.tbuffered=performance.now(),this.hls.trigger(u.a.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.tick();else if("initSegment"===i.sn)this.state=m.IDLE,n.tparsed=n.tbuffered=performance.now(),a.initSegment.data=t.payload,this.hls.trigger(u.a.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.tick();else{this.state=m.PARSING;var o=a.totalduration,s=e.level,d=e.sn,c=this.config.defaultAudioCodec||r.audioCodec;this.audioCodecSwap&&(p.b.log("swapping playlist audio codec"),void 0===c&&(c=this.lastAudioCodec),c&&(c=-1!==c.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,p.b.log("Parsing "+d+" of ["+a.startSN+" ,"+a.endSN+"],level "+s+", cc "+e.cc);var h=this.demuxer;h||(h=this.demuxer=new l.a(this.hls,"main"));var f=this.media,y=f&&f.seeking,v=!y&&(a.PTSKnown||!a.live),g=a.initSegment?a.initSegment.data:[];h.push(t.payload,g,c,r.videoCodec,e,o,v,void 0)}}this.fragLoadError=0},e.prototype.onFragParsingInitSegment=function(t){var e=this.fragCurrent,i=t.frag;if(e&&"main"===t.id&&i.sn===e.sn&&i.level===e.level&&this.state===m.PARSING){var n,r,a=t.tracks;if(a.audio&&this.altAudio&&delete a.audio,r=a.audio){var o=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(p.b.log("swapping playlist audio codec"),o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==r.metadata.channelCount&&-1===s.indexOf("firefox")&&(o="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==r.container&&(o="mp4a.40.2",p.b.log("Android: force audio codec to "+o)),r.levelCodec=o,r.id=t.id}r=a.video,r&&(r.levelCodec=this.levels[this.level].videoCodec,r.id=t.id),this.hls.trigger(u.a.BUFFER_CODECS,a);for(n in a){r=a[n],p.b.log("main track:"+n+",container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var l=r.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.a.BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}},e.prototype.onFragParsingData=function(t){var e=this,i=this.fragCurrent,n=t.frag;if(i&&"main"===t.id&&n.sn===i.sn&&n.level===i.level&&("audio"!==t.type||!this.altAudio)&&this.state===m.PARSING){var r=this.levels[this.level],a=i;if(isNaN(t.endPTS)&&(t.endPTS=t.startPTS+i.duration,t.endDTS=t.startDTS+i.duration),p.b.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(a.dropped=t.dropped,a.dropped)if(a.backtracked)p.b.warn("Already backtracked on this fragment, appending with the gap");else{var o=r.details;if(!o||a.sn!==o.startSN)return p.b.warn("missing video frame(s), backtracking fragment"),a.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=m.IDLE,this.fragPrevious=a,void this.tick();p.b.warn("missing video frame(s) on first frag, appending with gap")}else a.backtracked=!1;var s=d.b(r.details,a,t.startPTS,t.endPTS,t.startDTS,t.endDTS),l=this.hls;l.trigger(u.a.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:s,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(i){i&&i.length&&e.state===m.PARSING&&(e.appended=!0,e.pendingBuffering=!0,l.trigger(u.a.BUFFER_APPENDING,{type:t.type,data:i,parent:"main",content:"data"}))}),this.tick()}},e.prototype.onFragParsed=function(t){var e=this.fragCurrent,i=t.frag;e&&"main"===t.id&&i.sn===e.sn&&i.level===e.level&&this.state===m.PARSING&&(this.stats.tparsed=performance.now(),this.state=m.PARSED,this._checkAppendedParsed())},e.prototype.onAudioTrackSwitching=function(t){var e=!!t.url,i=t.id;if(!e){if(this.mediaBuffer!==this.media){p.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(p.b.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=m.IDLE}var r=this.hls;r.trigger(u.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),r.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}},e.prototype.onAudioTrackSwitched=function(t){var e=t.id,i=!!this.hls.audioTracks[e].url;if(i){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(p.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=i,this.tick()},e.prototype.onBufferCreated=function(t){var e=t.tracks,i=void 0,n=void 0,r=!1;for(var a in e){var o=e[a];"main"===o.id?(n=a,i=o,"video"===a&&(this.videoBuffer=e[a].buffer)):r=!0}r&&i?(p.b.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media},e.prototype.onBufferAppended=function(t){if("main"===t.parent){var e=this.state;e!==m.PARSING&&e!==m.PARSED||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},e.prototype._checkAppendedParsed=function(){if(!(this.state!==m.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent;if(t){var e=this.mediaBuffer?this.mediaBuffer:this.media;p.b.log("main buffered : "+c.a.toString(e.buffered));var i=this._bufferedFrags.filter(function(t){return s.a.isBuffered(e,(t.startPTS+t.endPTS)/2)});i.push(t),this._bufferedFrags=i.sort(function(t,e){return t.startPTS-e.startPTS}),this.fragPrevious=t;var n=this.stats;n.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(u.a.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.state=m.IDLE}this.tick()}},e.prototype.onError=function(t){var e=t.frag||this.fragCurrent;if(!e||"main"===e.type){var i=!!this.media&&s.a.isBuffered(this.media,this.media.currentTime)&&s.a.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case h.a.FRAG_LOAD_ERROR:case h.a.FRAG_LOAD_TIMEOUT:case h.a.KEY_LOAD_ERROR:case h.a.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);e.loadCounter=0,p.b.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=m.FRAG_LOADING_WAITING_RETRY}else p.b.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=m.ERROR;break;case h.a.FRAG_LOOP_LOADING_ERROR:t.fatal||(i?(this._reduceMaxBufferLength(e.duration),this.state=m.IDLE):e.autoLevel&&0!==e.level||(t.fatal=!0,this.state=m.ERROR));break;case h.a.LEVEL_LOAD_ERROR:case h.a.LEVEL_LOAD_TIMEOUT:this.state!==m.ERROR&&(t.fatal?(this.state=m.ERROR,p.b.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==m.WAITING_LEVEL||(this.state=m.IDLE));break;case h.a.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==m.PARSING&&this.state!==m.PARSED||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=m.IDLE):(p.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},e.prototype._reduceMaxBufferLength=function(t){var e=this.config;e.maxMaxBufferLength>=t&&(e.maxMaxBufferLength/=2,p.b.warn("main:reduce max buffer length to "+e.maxMaxBufferLength+"s"),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*e.fragLoadingLoopThreshold))},e.prototype._checkBuffer=function(){var t=this.media,e=this.config;if(t&&t.readyState){var i=t.currentTime,n=this.mediaBuffer?this.mediaBuffer:t,r=n.buffered;if(!this.loadedmetadata&&r.length){this.loadedmetadata=!0;var a=t.seeking?i:this.startPosition,o=s.a.isBuffered(n,a),l=r.start(0),d=!o&&Math.abs(a-l)<e.maxSeekHole;(i!==a||d)&&(p.b.log("target start position:"+a),d&&(a=l,p.b.log("target start position not buffered, seek to buffered.start(0) "+a)),p.b.log("adjust currentTime from "+i+" to "+a),t.currentTime=a)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var c=s.a.bufferInfo(t,i,0),f=!(t.paused||t.ended||0===t.buffered.length),y=i!==this.lastCurrentTime;if(y)this.stallReported&&(p.b.warn("playback not stuck anymore @"+i+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(f){var v=performance.now(),m=this.hls;if(this.stalled){var g=v-this.stalled,b=c.len,E=this.nudgeRetry||0;if(b<=.5&&g>1e3*e.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,p.b.warn("playback stalling in low buffer @"+i),m.trigger(u.a.ERROR,{type:h.b.MEDIA_ERROR,details:h.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:b}));var T=c.nextStart,w=T-i;if(T&&w<e.maxSeekHole&&w>0){this.nudgeRetry=++E;var S=E*e.nudgeOffset;p.b.log("adjust currentTime from "+t.currentTime+" to next buffered @ "+T+" + nudge "+S),t.currentTime=T+S,this.stalled=void 0,m.trigger(u.a.ERROR,{type:h.b.MEDIA_ERROR,details:h.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:T+S-i})}}else if(b>.5&&g>1e3*e.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,p.b.warn("playback stalling in high buffer @"+i),m.trigger(u.a.ERROR,{type:h.b.MEDIA_ERROR,details:h.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:b})),this.stalled=void 0,this.nudgeRetry=++E,E<e.nudgeMaxRetry){var _=t.currentTime,k=_+E*e.nudgeOffset;p.b.log("adjust currentTime from "+_+" to "+k),t.currentTime=k,m.trigger(u.a.ERROR,{type:h.b.MEDIA_ERROR,details:h.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else p.b.error("still stuck in high buffer @"+i+" after "+e.nudgeMaxRetry+", raise fatal error"),m.trigger(u.a.ERROR,{type:h.b.MEDIA_ERROR,details:h.a.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=v,this.stallReported=!1}}}},e.prototype.onFragLoadEmergencyAborted=function(){this.state=m.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},e.prototype.onBufferFlushed=function(){var t=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter(function(e){return s.a.isBuffered(t,(e.startPTS+e.endPTS)/2)}),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.state=m.IDLE,this.fragPrevious=null},e.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},e.prototype.computeLivePosition=function(t,e){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*e.targetduration;return t+Math.max(0,e.totalduration-i)},v(e,[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,p.b.log("main stream:"+e+"->"+t),this.hls.trigger(u.a.STREAM_STATE_TRANSITION,{previousState:e,nextState:t})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var t=this.media;if(t){var e=this.getBufferedFrag(t.currentTime);if(e)return e.level}return-1}},{key:"nextBufferedFrag",get:function(){var t=this.media;return t?this.followingBufferedFrag(this.getBufferedFrag(t.currentTime)):null}},{key:"nextLevel",get:function(){var t=this.nextBufferedFrag;return t?t.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(t){this._liveSyncPosition=t}}]),e}(y.a);e.a=g},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e,i){n(this,t),this.subtle=e,this.aesIV=i}return t.prototype.decrypt=function(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)},t}();e.a=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e,i){n(this,t),this.subtle=e,this.key=i}return t.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},t}();e.a=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){var e=t.byteLength,i=e&&new DataView(t).getUint8(e-1);return i?t.slice(0,e-i):t}var a=function(){function t(){n(this,t),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return t.prototype.uint8ArrayToUint32Array_=function(t){for(var e=new DataView(t),i=new Uint32Array(4),n=0;n<4;n++)i[n]=e.getUint32(4*n);return i},t.prototype.initTable=function(){var t=this.sBox,e=this.invSBox,i=this.subMix,n=i[0],r=i[1],a=i[2],o=i[3],s=this.invSubMix,l=s[0],u=s[1],d=s[2],c=s[3],h=new Uint32Array(256),p=0,f=0,y=0;for(y=0;y<256;y++)h[y]=y<128?y<<1:y<<1^283;for(y=0;y<256;y++){var v=f^f<<1^f<<2^f<<3^f<<4;v=v>>>8^255&v^99,t[p]=v,e[v]=p;var m=h[p],g=h[m],b=h[g],E=257*h[v]^16843008*v
;n[p]=E<<24|E>>>8,r[p]=E<<16|E>>>16,a[p]=E<<8|E>>>24,o[p]=E,E=16843009*b^65537*g^257*m^16843008*p,l[v]=E<<24|E>>>8,u[v]=E<<16|E>>>16,d[v]=E<<8|E>>>24,c[v]=E,p?(p=m^h[h[h[b^m]]],f^=h[h[f]]):p=f=1}},t.prototype.expandKey=function(t){for(var e=this.uint8ArrayToUint32Array_(t),i=!0,n=0;n<e.length&&i;)i=e[n]===this.key[n],n++;if(!i){this.key=e;var r=this.keySize=e.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);var a=this.ksRows=4*(r+6+1),o=void 0,s=void 0,l=this.keySchedule=new Uint32Array(a),u=this.invKeySchedule=new Uint32Array(a),d=this.sBox,c=this.rcon,h=this.invSubMix,p=h[0],f=h[1],y=h[2],v=h[3],m=void 0,g=void 0;for(o=0;o<a;o++)o<r?m=l[o]=e[o]:(g=m,o%r==0?(g=g<<8|g>>>24,g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g],g^=c[o/r|0]<<24):r>6&&o%r==4&&(g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g]),l[o]=m=(l[o-r]^g)>>>0);for(s=0;s<a;s++)o=a-s,g=3&s?l[o]:l[o-4],u[s]=s<4||o<=4?g:p[d[g>>>24]]^f[d[g>>>16&255]]^y[d[g>>>8&255]]^v[d[255&g]],u[s]=u[s]>>>0}},t.prototype.networkToHostOrderSwap=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},t.prototype.decrypt=function(t,e,i){for(var n,a,o=this.keySize+6,s=this.invKeySchedule,l=this.invSBox,u=this.invSubMix,d=u[0],c=u[1],h=u[2],p=u[3],f=this.uint8ArrayToUint32Array_(i),y=f[0],v=f[1],m=f[2],g=f[3],b=new Int32Array(t),E=new Int32Array(b.length),T=void 0,w=void 0,S=void 0,_=void 0,k=void 0,L=void 0,R=void 0,A=void 0,D=void 0,x=void 0,I=void 0,O=void 0,C=this.networkToHostOrderSwap;e<b.length;){for(D=C(b[e]),x=C(b[e+1]),I=C(b[e+2]),O=C(b[e+3]),k=D^s[0],L=O^s[1],R=I^s[2],A=x^s[3],n=4,a=1;a<o;a++)T=d[k>>>24]^c[L>>16&255]^h[R>>8&255]^p[255&A]^s[n],w=d[L>>>24]^c[R>>16&255]^h[A>>8&255]^p[255&k]^s[n+1],S=d[R>>>24]^c[A>>16&255]^h[k>>8&255]^p[255&L]^s[n+2],_=d[A>>>24]^c[k>>16&255]^h[L>>8&255]^p[255&R]^s[n+3],k=T,L=w,R=S,A=_,n+=4;T=l[k>>>24]<<24^l[L>>16&255]<<16^l[R>>8&255]<<8^l[255&A]^s[n],w=l[L>>>24]<<24^l[R>>16&255]<<16^l[A>>8&255]<<8^l[255&k]^s[n+1],S=l[R>>>24]<<24^l[A>>16&255]<<16^l[k>>8&255]<<8^l[255&L]^s[n+2],_=l[A>>>24]<<24^l[k>>16&255]<<16^l[L>>8&255]<<8^l[255&R]^s[n+3],n+=3,E[e]=C(T^y),E[e+1]=C(_^v),E[e+2]=C(S^m),E[e+3]=C(w^g),y=D,v=x,m=I,g=O,e+=4}return r(E.buffer)},t.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},t}();e.a=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(17),a=i(0),o=i(5),s=function(){function t(e,i,r){n(this,t),this.observer=e,this.config=r,this.remuxer=i}return t.prototype.resetInitSegment=function(t,e,i,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:e,duration:n,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(t){if(!t)return!1;for(var e=o.a.getID3Data(t,0)||[],i=e.length,n=t.length;i<n;i++)if(r.e(t,i))return a.b.log("ADTS sync word found !"),!0;return!1},t.prototype.append=function(t,e,i,n){for(var s=this._audioTrack,l=o.a.getID3Data(t,0)||[],u=o.a.getTimeStamp(l),d=u?90*u:9e4*e,c=0,h=d,p=t.length,f=l.length,y=[{pts:h,dts:h,data:l}];f<p-1;)if(r.d(t,f)&&f+5<p){r.c(s,this.observer,t,f,s.manifestCodec);var v=r.a(s,t,f,d,c);if(!v){a.b.log("Unable to parse AAC frame");break}f+=v.length,h=v.sample.pts,c++}else o.a.isHeader(t,f)?(l=o.a.getID3Data(t,f),y.push({pts:h,dts:h,data:l}),f+=l.length):f++;this.remuxer.remux(s,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},e,i,n)},t.prototype.destroy=function(){},t}();e.a=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(17),a=i(18),o=i(1),s=i(36),l=i(37),u=i(0),d=i(2),c={video:0,audio:1,id3:2,text:3},h=function(){function t(e,i,r,a){n(this,t),this.observer=e,this.config=r,this.typeSupported=a,this.remuxer=i,this.sampleAes=null}return t.prototype.setDecryptData=function(t){null!=t&&null!=t.key&&"SAMPLE-AES"===t.method?this.sampleAes=new l.a(this.observer,this.config,t,this.discardEPB):this.sampleAes=null},t.probe=function(e){var i=t._syncOffset(e);return!(i<0||(i&&u.b.warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?"),0))},t._syncOffset=function(t){for(var e=Math.min(1e3,t.length-564),i=0;i<e;){if(71===t[i]&&71===t[i+188]&&71===t[i+376])return i;i++}return-1},t.createTrack=function(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:c[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===t?0:void 0,isAAC:"audio"===t||void 0,duration:"audio"===t?e:void 0}},t.prototype.resetInitSegment=function(e,i,n,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=t.createTrack("video",r),this._audioTrack=t.createTrack("audio",r),this._id3Track=t.createTrack("id3",r),this._txtTrack=t.createTrack("text",r),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=i,this.videoCodec=n,this._duration=r},t.prototype.resetTimeStamp=function(){},t.prototype.append=function(e,i,n,r){var a,s,l,c,h,p=e.length,f=!1;this.contiguous=n;var y=this.pmtParsed,v=this._avcTrack,m=this._audioTrack,g=this._id3Track,b=v.pid,E=m.pid,T=g.pid,w=this._pmtId,S=v.pesData,_=m.pesData,k=g.pesData,L=this._parsePAT,R=this._parsePMT,A=this._parsePES,D=this._parseAVCPES.bind(this),x=this._parseAACPES.bind(this),I=this._parseMPEGPES.bind(this),O=this._parseID3PES.bind(this),C=t._syncOffset(e);for(p-=(p+C)%188,a=C;a<p;a+=188)if(71===e[a]){if(s=!!(64&e[a+1]),l=((31&e[a+1])<<8)+e[a+2],(48&e[a+3])>>4>1){if((c=a+5+e[a+4])===a+188)continue}else c=a+4;switch(l){case b:s&&(S&&(h=A(S))&&D(h,!1),S={data:[],size:0}),S&&(S.data.push(e.subarray(c,a+188)),S.size+=a+188-c);break;case E:s&&(_&&(h=A(_))&&(m.isAAC?x(h):I(h)),_={data:[],size:0}),_&&(_.data.push(e.subarray(c,a+188)),_.size+=a+188-c);break;case T:s&&(k&&(h=A(k))&&O(h),k={data:[],size:0}),k&&(k.data.push(e.subarray(c,a+188)),k.size+=a+188-c);break;case 0:s&&(c+=e[c]+1),w=this._pmtId=L(e,c);break;case w:s&&(c+=e[c]+1);var P=R(e,c,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);b=P.avc,b>0&&(v.pid=b),E=P.audio,E>0&&(m.pid=E,m.isAAC=P.isAAC),T=P.id3,T>0&&(g.pid=T),f&&!y&&(u.b.log("reparse from beginning"),f=!1,a=C-188),y=this.pmtParsed=!0;break;case 17:case 8191:break;default:f=!0}}else this.observer.trigger(o.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});S&&(h=A(S))?(D(h,!0),v.pesData=null):v.pesData=S,_&&(h=A(_))?(m.isAAC?x(h):I(h),m.pesData=null):(_&&_.size&&u.b.log("last AAC PES packet truncated,might overlap between fragments"),m.pesData=_),k&&(h=A(k))?(O(h),g.pesData=null):g.pesData=k,null==this.sampleAes?this.remuxer.remux(m,v,g,this._txtTrack,i,n,r):this.decryptAndRemux(m,v,g,this._txtTrack,i,n,r)},t.prototype.decryptAndRemux=function(t,e,i,n,r,a,o){if(t.samples&&t.isAAC){var s=this;this.sampleAes.decryptAacSamples(t.samples,0,function(){s.decryptAndRemuxAvc(t,e,i,n,r,a,o)})}else this.decryptAndRemuxAvc(t,e,i,n,r,a,o)},t.prototype.decryptAndRemuxAvc=function(t,e,i,n,r,a,o){if(e.samples){var s=this;this.sampleAes.decryptAvcSamples(e.samples,0,0,function(){s.remuxer.remux(t,e,i,n,r,a,o)})}else this.remuxer.remux(t,e,i,n,r,a,o)},t.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t.prototype._parsePAT=function(t,e){return(31&t[e+10])<<8|t[e+11]},t.prototype._parsePMT=function(t,e,i,n){var r,a,o,s,l={audio:-1,avc:-1,id3:-1,isAAC:!0};for(r=(15&t[e+1])<<8|t[e+2],a=e+3+r-4,o=(15&t[e+10])<<8|t[e+11],e+=12+o;e<a;){switch(s=(31&t[e+1])<<8|t[e+2],t[e]){case 207:if(!n){u.b.log("unkown stream type:"+t[e]);break}case 15:-1===l.audio&&(l.audio=s);break;case 21:-1===l.id3&&(l.id3=s);break;case 219:if(!n){u.b.log("unkown stream type:"+t[e]);break}case 27:-1===l.avc&&(l.avc=s);break;case 3:case 4:i?-1===l.audio&&(l.audio=s,l.isAAC=!1):u.b.log("MPEG audio found, not supported in this browser for now");break;case 36:u.b.warn("HEVC stream type found, not supported for now");break;default:u.b.log("unkown stream type:"+t[e])}e+=5+((15&t[e+3])<<8|t[e+4])}return l},t.prototype._parsePES=function(t){var e,i,n,r,a,o,s,l,d=0,c=t.data;if(!t||0===t.size)return null;for(;c[0].length<19&&c.length>1;){var h=new Uint8Array(c[0].length+c[1].length);h.set(c[0]),h.set(c[1],c[0].length),c[0]=h,c.splice(1,1)}if(e=c[0],1===(e[0]<<16)+(e[1]<<8)+e[2]){if((n=(e[4]<<8)+e[5])&&n>t.size-6)return null;i=e[7],192&i&&(o=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,o>4294967295&&(o-=8589934592),64&i?(s=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2,s>4294967295&&(s-=8589934592),o-s>54e5&&(u.b.warn(Math.round((o-s)/9e4)+"s delta between PTS and DTS, align them"),o=s)):s=o),r=e[8],l=r+9,t.size-=l,a=new Uint8Array(t.size);for(var p=0,f=c.length;p<f;p++){e=c[p];var y=e.byteLength;if(l){if(l>y){l-=y;continue}e=e.subarray(l),y-=l,l=0}a.set(e,d),d+=y}return n&&(n-=r+3),{data:a,pts:o,dts:s,len:n}}return null},t.prototype.pushAccesUnit=function(t,e){if(t.units.length&&t.frame){var i=e.samples,n=i.length;!this.config.forceKeyFrameOnDiscontinuity||!0===t.key||e.sps&&(n||this.contiguous)?(t.id=n,i.push(t)):e.dropped++}t.debug.length&&u.b.log(t.pts+"/"+t.dts+":"+t.debug)},t.prototype._parseAVCPES=function(t,e){var i,n,r,a=this,o=this._avcTrack,l=this._parseAVCNALu(t.data),u=this.avcSample,d=!1,c=this.pushAccesUnit.bind(this),h=function(t,e,i,n){return{key:t,pts:e,dts:i,units:[],debug:n}};t.data=null,u&&l.length&&!o.audFound&&(c(u,o),u=this.avcSample=h(!1,t.pts,t.dts,"")),l.forEach(function(e){switch(e.type){case 1:n=!0,u||(u=a.avcSample=h(!0,t.pts,t.dts,"")),u.frame=!0;var l=e.data;if(d&&l.length>4){var p=new s.a(l).readSliceType();2!==p&&4!==p&&7!==p&&9!==p||(u.key=!0)}break;case 5:n=!0,u||(u=a.avcSample=h(!0,t.pts,t.dts,"")),u.key=!0,u.frame=!0;break;case 6:n=!0,i=new s.a(a.discardEPB(e.data)),i.readUByte();for(var f=0,y=0,v=!1,m=0;!v&&i.bytesAvailable>1;){f=0;do{m=i.readUByte(),f+=m}while(255===m);y=0;do{m=i.readUByte(),y+=m}while(255===m);if(4===f&&0!==i.bytesAvailable){if(v=!0,181===i.readUByte()&&49===i.readUShort()&&1195456820===i.readUInt()&&3===i.readUByte()){var g=i.readUByte(),b=i.readUByte(),E=31&g,T=[g,b];for(r=0;r<E;r++)T.push(i.readUByte()),T.push(i.readUByte()),T.push(i.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:t.pts,bytes:T})}}else if(y<i.bytesAvailable)for(r=0;r<y;r++)i.readUByte()}break;case 7:if(n=!0,d=!0,!o.sps){i=new s.a(e.data);var w=i.readSPS();o.width=w.width,o.height=w.height,o.pixelRatio=w.pixelRatio,o.sps=[e.data],o.duration=a._duration;var S=e.data.subarray(1,4),_="avc1.";for(r=0;r<3;r++){var k=S[r].toString(16);k.length<2&&(k="0"+k),_+=k}o.codec=_}break;case 8:n=!0,o.pps||(o.pps=[e.data]);break;case 9:n=!1,o.audFound=!0,u&&c(u,o),u=a.avcSample=h(!1,t.pts,t.dts,"");break;case 12:n=!1;break;default:n=!1,u&&(u.debug+="unknown NAL "+e.type+" ")}u&&n&&u.units.push(e)}),e&&u&&(c(u,o),this.avcSample=null)},t.prototype._insertSampleInOrder=function(t,e){var i=t.length;if(i>0){if(e.pts>=t[i-1].pts)t.push(e);else for(var n=i-1;n>=0;n--)if(e.pts<t[n].pts){t.splice(n,0,e);break}}else t.push(e)},t.prototype._getLastNalUnit=function(){var t=this.avcSample,e=void 0;if(!t||0===t.units.length){var i=this._avcTrack,n=i.samples;t=n[n.length-1]}if(t){var r=t.units;e=r[r.length-1]}return e},t.prototype._parseAVCNALu=function(t){var e,i,n,r,a,o=0,s=t.byteLength,l=this._avcTrack,u=l.naluState||0,d=u,c=[],h=-1;for(-1===u&&(h=0,a=31&t[0],u=0,o=1);o<s;)if(e=t[o++],u)if(1!==u)if(e)if(1===e){if(h>=0)n={data:t.subarray(h,o-u-1),type:a},c.push(n);else{var p=this._getLastNalUnit();if(p&&(d&&o<=4-d&&p.state&&(p.data=p.data.subarray(0,p.data.byteLength-d)),(i=o-u-1)>0)){var f=new Uint8Array(p.data.byteLength+i);f.set(p.data,0),f.set(t.subarray(0,i),p.data.byteLength),p.data=f}}o<s?(r=31&t[o],h=o,a=r,u=0):u=-1}else u=0;else u=3;else u=e?0:2;else u=e?0:1;if(h>=0&&u>=0&&(n={data:t.subarray(h,s),type:a,state:u},c.push(n)),0===c.length){var y=this._getLastNalUnit();if(y){var v=new Uint8Array(y.data.byteLength+t.byteLength);v.set(y.data,0),v.set(t,y.data.byteLength),y.data=v}}return l.naluState=u,c},t.prototype.discardEPB=function(t){for(var e,i,n=t.byteLength,r=[],a=1;a<n-2;)0===t[a]&&0===t[a+1]&&3===t[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return t;e=n-r.length,i=new Uint8Array(e);var o=0;for(a=0;a<e;o++,a++)o===r[0]&&(o++,r.shift()),i[a]=t[o];return i},t.prototype._parseAACPES=function(t){var e,i,n,a,s,l=this._audioTrack,c=t.data,h=t.pts,p=this.aacOverFlow,f=this.aacLastPTS;if(p){var y=new Uint8Array(p.byteLength+c.byteLength);y.set(p,0),y.set(c,p.byteLength),c=y}for(n=0,s=c.length;n<s-1&&!r.d(c,n);n++);if(n){var v,m;if(n<s-1?(v="AAC PES did not start with ADTS header,offset:"+n,m=!1):(v="no ADTS header found in AAC PES",m=!0),u.b.warn("parsing error:"+v),this.observer.trigger(o.a.ERROR,{type:d.b.MEDIA_ERROR,details:d.a.FRAG_PARSING_ERROR,fatal:m,reason:v}),m)return}if(r.c(l,this.observer,c,n,this.audioCodec),i=0,e=r.b(l.samplerate),p&&f){var g=f+e;Math.abs(g-h)>1&&(u.b.log("AAC: align PTS for overlapping frames by "+Math.round((g-h)/90)),h=g)}for(;n<s;)if(r.d(c,n)&&n+5<s){var b=r.a(l,c,n,h,i);if(!b)break;n+=b.length,a=b.sample.pts,i++}else n++;p=n<s?c.subarray(n,s):null,this.aacOverFlow=p,this.aacLastPTS=a},t.prototype._parseMPEGPES=function(t){for(var e=t.data,i=e.length,n=0,r=0,o=t.pts;r<i;)if(a.a.isHeader(e,r)){var s=a.a.appendFrame(this._audioTrack,e,r,o,n);if(!s)break;r+=s.length,n++}else r++},t.prototype._parseID3PES=function(t){this._id3Track.samples.push(t)},t}();e.a=h},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(0),a=function(){function t(e){n(this,t),this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}return t.prototype.loadWord=function(){var t=this.data,e=this.bytesAvailable,i=t.byteLength-e,n=new Uint8Array(4),r=Math.min(4,e);if(0===r)throw new Error("no bytes available");n.set(t.subarray(i,i+r)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r},t.prototype.skipBits=function(t){var e;this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,e=t>>3,t-=e>>3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)},t.prototype.readBits=function(t){var e=Math.min(this.bitsAvailable,t),i=this.word>>>32-e;return t>32&&r.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0?this.word<<=e:this.bytesAvailable>0&&this.loadWord(),e=t-e,e>0&&this.bitsAvailable?i<<e|this.readBits(e):i},t.prototype.skipLZ=function(){var t;for(t=0;t<this.bitsAvailable;++t)if(0!=(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()},t.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},t.prototype.readUEG=function(){var t=this.skipLZ();return this.readBits(t+1)-1},t.prototype.readEG=function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)},t.prototype.readBoolean=function(){return 1===this.readBits(1)},t.prototype.readUByte=function(){return this.readBits(8)},t.prototype.readUShort=function(){return this.readBits(16)},t.prototype.readUInt=function(){return this.readBits(32)},t.prototype.skipScalingList=function(t){var e,i,n=8,r=8;for(e=0;e<t;e++)0!==r&&(i=this.readEG(),r=(n+i+256)%256),n=0===r?n:r},t.prototype.readSPS=function(){var t,e,i,n,r,a,o,s=0,l=0,u=0,d=0,c=this.readUByte.bind(this),h=this.readBits.bind(this),p=this.readUEG.bind(this),f=this.readBoolean.bind(this),y=this.skipBits.bind(this),v=this.skipEG.bind(this),m=this.skipUEG.bind(this),g=this.skipScalingList.bind(this);if(c(),t=c(),h(5),y(3),c(),m(),100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t){var b=p();if(3===b&&y(1),m(),m(),y(1),f())for(a=3!==b?8:12,o=0;o<a;o++)f()&&g(o<6?16:64)}m();var E=p();if(0===E)p();else if(1===E)for(y(1),v(),v(),e=p(),o=0;o<e;o++)v();m(),y(1),i=p(),n=p(),r=h(1),0===r&&y(1),y(1),f()&&(s=p(),l=p(),u=p(),d=p());var T=[1,1];if(f()&&f())switch(c()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(i+1)-2*s-2*l),height:(2-r)*(n+1)*16-(r?2:4)*(u+d),pixelRatio:T}},t.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},t}();e.a=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(8),a=function(){function t(e,i,a,o){n(this,t),this.decryptdata=a,this.discardEPB=o,this.decrypter=new r.a(e,i)}return t.prototype.decryptBuffer=function(t,e){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,e)},t.prototype.decryptAacSample=function(t,e,i,n){var r=t[e].unit,a=r.subarray(16,r.length-r.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),s=this;this.decryptBuffer(o,function(a){a=new Uint8Array(a),r.set(a,16),n||s.decryptAacSamples(t,e+1,i)})},t.prototype.decryptAacSamples=function(t,e,i){for(;;e++){if(e>=t.length)return void i();if(!(t[e].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(t,e,i,n),!n)return}}},t.prototype.getAvcEncryptedData=function(t){for(var e=16*Math.floor((t.length-48)/160)+16,i=new Int8Array(e),n=0,r=32;r<=t.length-16;r+=160,n+=16)i.set(t.subarray(r,r+16),n);return i},t.prototype.getAvcDecryptedUnit=function(t,e){e=new Uint8Array(e);for(var i=0,n=32;n<=t.length-16;n+=160,i+=16)t.set(e.subarray(i,i+16),n);return t},t.prototype.decryptAvcSample=function(t,e,i,n,r,a){var o=this.discardEPB(r.data),s=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(s.buffer,function(s){r.data=l.getAvcDecryptedUnit(o,s),a||l.decryptAvcSamples(t,e,i+1,n)})},t.prototype.decryptAvcSamples=function(t,e,i,n){for(;;e++,i=0){if(e>=t.length)return void n();for(var r=t[e].units;!(i>=r.length);i++){var a=r[i];if(!(a.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(t,e,i,n,a,o),!o)return}}}},t}();e.a=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(5),a=i(0),o=i(18),s=function(){function t(e,i,r){n(this,t),this.observer=e,this.config=r,this.remuxer=i}return t.prototype.resetInitSegment=function(t,e,i,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:e,duration:n,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(t){var e,i,n=r.a.getID3Data(t,0);if(n&&void 0!==r.a.getTimeStamp(n))for(e=n.length,i=Math.min(t.length-1,e+100);e<i;e++)if(o.a.probe(t,e))return a.b.log("MPEG Audio sync word found !"),!0;return!1},t.prototype.append=function(t,e,i,n){for(var a=r.a.getID3Data(t,0),s=r.a.getTimeStamp(a),l=s?90*s:9e4*e,u=a.length,d=t.length,c=0,h=0,p=this._audioTrack,f=[{pts:l,dts:l,data:a}];u<d;)if(o.a.isHeader(t,u)){var y=o.a.appendFrame(p,t,u,l,c);if(!y)break;u+=y.length,h=y.sample.pts,c++}else r.a.isHeader(t,u)?(a=r.a.getID3Data(t,u),f.push({pts:h,dts:h,data:a}),u+=a.length):u++;this.remuxer.remux(p,{samples:[]},{samples:f,inputTimeScale:9e4},{samples:[]},e,i,n)},t.prototype.destroy=function(){},t}();e.a=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(40),a=i(1),o=i(0),s=i(41),l=i(2),u=function(){function t(e,i,r,a){n(this,t),this.observer=e,this.config=i,this.typeSupported=r;var o=navigator.userAgent;this.isSafari=a&&a.indexOf("Apple")>-1&&o&&!o.match("CriOS"),this.ISGenerated=!1}return t.prototype.destroy=function(){},t.prototype.resetTimeStamp=function(t){this._initPTS=this._initDTS=t},t.prototype.resetInitSegment=function(){this.ISGenerated=!1},t.prototype.remux=function(t,e,i,n,r,s,l){if(this.ISGenerated||this.generateIS(t,e,r),this.ISGenerated){var u=t.samples.length,d=e.samples.length,c=r,h=r;if(u&&d){var p=(t.samples[0].dts-e.samples[0].dts)/e.inputTimeScale;c+=Math.max(0,p),h+=Math.max(0,-p)}if(u){t.timescale||(o.b.warn("regenerate InitSegment as audio detected"),this.generateIS(t,e,r));var f=this.remuxAudio(t,c,s,l);if(d){var y=void 0;f&&(y=f.endPTS-f.startPTS),e.timescale||(o.b.warn("regenerate InitSegment as video detected"),this.generateIS(t,e,r)),this.remuxVideo(e,h,s,y,l)}}else{var v=void 0;d&&(v=this.remuxVideo(e,h,s,l)),v&&t.codec&&this.remuxEmptyAudio(t,c,s,v)}}i.samples.length&&this.remuxID3(i,r),n.samples.length&&this.remuxText(n,r),this.observer.trigger(a.a.FRAG_PARSED)},t.prototype.generateIS=function(t,e,i){var n,r,u=this.observer,d=t.samples,c=e.samples,h=this.typeSupported,p="audio/mp4",f={},y={tracks:f},v=void 0===this._initPTS;if(v&&(n=r=1/0),t.config&&d.length&&(t.timescale=t.samplerate,o.b.log("audio sampling rate : "+t.samplerate),t.isAAC||(h.mpeg?(p="audio/mpeg",t.codec=""):h.mp3&&(t.codec="mp3")),f.audio={container:p,codec:t.codec,initSegment:!t.isAAC&&h.mpeg?new Uint8Array:s.a.initSegment([t]),metadata:{channelCount:t.channelCount}},v&&(n=r=d[0].pts-t.inputTimeScale*i)),e.sps&&e.pps&&c.length){var m=e.inputTimeScale;e.timescale=m,f.video={container:"video/mp4",codec:e.codec,initSegment:s.a.initSegment([e]),metadata:{width:e.width,height:e.height}},v&&(n=Math.min(n,c[0].pts-m*i),r=Math.min(r,c[0].dts-m*i),this.observer.trigger(a.a.INIT_PTS_FOUND,{initPTS:n}))}Object.keys(f).length?(u.trigger(a.a.FRAG_PARSING_INIT_SEGMENT,y),this.ISGenerated=!0,v&&(this._initPTS=n,this._initDTS=r)):u.trigger(a.a.ERROR,{type:l.b.MEDIA_ERROR,details:l.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.prototype.remuxVideo=function(t,e,i,n,r){var u,d,c,h,p,f,y,v=8,m=t.timescale,g=t.samples,b=[],E=g.length,T=this._PTSNormalize,w=this._initDTS,S=this.nextAvcDts,_=this.isSafari;_&&(i|=g.length&&S&&(r&&Math.abs(e-S/m)<.1||Math.abs(g[0].pts-S-w)<m/5)),i||(S=e*m),g.forEach(function(t){t.pts=T(t.pts-w,S),t.dts=T(t.dts-w,S)}),g.sort(function(t,e){var i=t.dts-e.dts,n=t.pts-e.pts;return i||n||t.id-e.id});var k=g.reduce(function(t,e){return Math.max(Math.min(t,e.pts-e.dts),-18e3)},0);if(k<0){o.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(k/90)+" ms to overcome this issue");for(var L=0;L<g.length;L++)g[L].dts+=k}var R=g[0];p=Math.max(R.dts,0),h=Math.max(R.pts,0);var A=Math.round((p-S)/90);i&&A&&(A>1?o.b.log("AVC:"+A+" ms hole between fragments detected,filling it"):A<-1&&o.b.log("AVC:"+-A+" ms overlapping between fragments detected"),p=S,g[0].dts=p,h=Math.max(h-A,S),g[0].pts=h,o.b.log("Video/PTS/DTS adjusted: "+Math.round(h/90)+"/"+Math.round(p/90)+",delta:"+A+" ms")),R=g[g.length-1],y=Math.max(R.dts,0),f=Math.max(R.pts,0,y),_&&(u=Math.round((y-p)/(g.length-1)));for(var D=0,x=0,I=0;I<E;I++){for(var O=g[I],C=O.units,P=C.length,M=0,F=0;F<P;F++)M+=C[F].data.length;x+=M,D+=P,O.length=M,O.dts=_?p+I*u:Math.max(O.dts,p),O.pts=Math.max(O.pts,O.dts)}var N=x+4*D+8;try{d=new Uint8Array(N)}catch(t){return void this.observer.trigger(a.a.ERROR,{type:l.b.MUX_ERROR,details:l.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:N,reason:"fail allocating video mdat "+N})}var B=new DataView(d.buffer);B.setUint32(0,N),d.set(s.a.types.mdat,4);for(var U=0;U<E;U++){for(var G=g[U],q=G.units,j=0,H=void 0,K=0,W=q.length;K<W;K++){var z=q[K],V=z.data,Y=z.data.byteLength;B.setUint32(v,Y),v+=4,d.set(V,v),v+=Y,j+=4+Y}if(_)H=Math.max(0,u*Math.round((G.pts-G.dts)/u));else{if(U<E-1)u=g[U+1].dts-G.dts;else{var X=this.config,Q=G.dts-g[U>0?U-1:U].dts;if(X.stretchShortVideoTrack){var $=X.maxBufferHole,J=X.maxSeekHole,Z=Math.floor(Math.min($,J)*m),tt=(n?h+n*m:this.nextAudioPts)-G.pts;tt>Z?(u=tt-Q,u<0&&(u=Q),o.b.log("It is approximately "+tt/90+" ms to the next segment; using duration "+u/90+" ms for the last video frame.")):u=Q}else u=Q}H=Math.round(G.pts-G.dts)}b.push({size:j,duration:u,cts:H,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:G.key?2:1,isNonSync:G.key?0:1}})}this.nextAvcDts=y+u;var et=t.dropped;if(t.len=0,t.nbNalu=0,t.dropped=0,b.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var it=b[0].flags;it.dependsOn=2,it.isNonSync=0}t.samples=b,c=s.a.moof(t.sequenceNumber++,p,t),t.samples=[];var nt={data1:c,data2:d,startPTS:h/m,endPTS:(f+u)/m,startDTS:p/m,endDTS:this.nextAvcDts/m,type:"video",nb:b.length,dropped:et};return this.observer.trigger(a.a.FRAG_PARSING_DATA,nt),nt},t.prototype.remuxAudio=function(t,e,i,n){var u,d,c,h,p,f,y,v=t.inputTimeScale,m=t.timescale,g=v/m,b=t.isAAC?1024:1152,E=b*g,T=this._PTSNormalize,w=this._initDTS,S=!t.isAAC&&this.typeSupported.mpeg,_=t.samples,k=[],L=this.nextAudioPts;if(i|=_.length&&L&&(n&&Math.abs(e-L/v)<.1||Math.abs(_[0].pts-L-w)<20*E),_.forEach(function(t){t.pts=t.dts=T(t.pts-w,e*v)}),_=_.filter(function(t){return t.pts>=0}),0!==_.length){if(i||(L=n?e*v:_[0].pts),t.isAAC)for(var R=this.config.maxAudioFramesDrift,A=0,D=L;A<_.length;){var x,I=_[A],O=I.pts;x=O-D;var C=Math.abs(1e3*x/v);if(x<=-R*E)o.b.warn("Dropping 1 audio frame @ "+(D/v).toFixed(3)+"s due to "+Math.round(C)+" ms overlap."),_.splice(A,1),t.len-=I.unit.length;else if(x>=R*E&&C<1e4&&D){var P=Math.round(x/E);o.b.warn("Injecting "+P+" audio frame @ "+(D/v).toFixed(3)+"s due to "+Math.round(1e3*x/v)+" ms gap.");for(var M=0;M<P;M++){var F=Math.max(D,0);c=r.a.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),c||(o.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),c=I.unit.subarray()),_.splice(A,0,{unit:c,pts:F,dts:F}),t.len+=c.length,D+=E,A++}I.pts=I.dts=D,D+=E,A++}else Math.abs(x),I.pts=I.dts=D,D+=E,A++}for(var N=0,B=_.length;N<B;N++){var U=_[N],G=U.unit,q=U.pts;if(void 0!==y)d.duration=Math.round((q-y)/g);else{var j=Math.round(1e3*(q-L)/v),H=0;if(i&&t.isAAC&&j){if(j>0&&j<1e4)H=Math.round((q-L)/E),o.b.log(j+" ms hole between AAC samples detected,filling it"),H>0&&(c=r.a.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),c||(c=G.subarray()),t.len+=H*c.length);else if(j<-12){o.b.log("drop overlapping AAC sample, expected/parsed/delta:"+(L/v).toFixed(3)+"s/"+(q/v).toFixed(3)+"s/"+-j+"ms"),t.len-=G.byteLength;continue}q=L}if(f=q,!(t.len>0))return;var K=S?t.len:t.len+8;u=S?0:8;try{h=new Uint8Array(K)}catch(t){return void this.observer.trigger(a.a.ERROR,{type:l.b.MUX_ERROR,details:l.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:K,reason:"fail allocating audio mdat "+K})}S||(new DataView(h.buffer).setUint32(0,K),h.set(s.a.types.mdat,4));for(var W=0;W<H;W++)c=r.a.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),c||(o.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),c=G.subarray()),h.set(c,u),u+=c.byteLength,d={size:c.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},k.push(d)}h.set(G,u);var z=G.byteLength;u+=z,d={size:z,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},k.push(d),y=q}var V=0,Y=k.length;if(Y>=2&&(V=k[Y-2].duration,d.duration=V),Y){this.nextAudioPts=L=y+g*V,t.len=0,t.samples=k,p=S?new Uint8Array:s.a.moof(t.sequenceNumber++,f/g,t),t.samples=[];var X=f/v,Q=L/v,$={data1:p,data2:h,startPTS:X,endPTS:Q,startDTS:X,endDTS:Q,type:"audio",nb:Y};return this.observer.trigger(a.a.FRAG_PARSING_DATA,$),$}return null}},t.prototype.remuxEmptyAudio=function(t,e,i,n){var a=t.inputTimeScale,s=t.samplerate?t.samplerate:a,l=a/s,u=this.nextAudioPts,d=(void 0!==u?u:n.startDTS*a)+this._initDTS,c=n.endDTS*a+this._initDTS,h=1024*l,p=Math.ceil((c-d)/h),f=r.a.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(o.b.warn("remux empty Audio"),!f)return void o.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var y=[],v=0;v<p;v++){var m=d+v*h;y.push({unit:f,pts:m,dts:m}),t.len+=f.length}t.samples=y,this.remuxAudio(t,e,i)},t.prototype.remuxID3=function(t,e){var i,n=t.samples.length,r=t.inputTimeScale,o=this._initPTS,s=this._initDTS;if(n){for(var l=0;l<n;l++)i=t.samples[l],i.pts=(i.pts-o)/r,i.dts=(i.dts-s)/r;this.observer.trigger(a.a.FRAG_PARSING_METADATA,{samples:t.samples})}t.samples=[],e=e},t.prototype.remuxText=function(t,e){t.samples.sort(function(t,e){return t.pts-e.pts});var i,n=t.samples.length,r=t.inputTimeScale,o=this._initPTS;if(n){for(var s=0;s<n;s++)i=t.samples[s],i.pts=(i.pts-o)/r;this.observer.trigger(a.a.FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[],e=e},t.prototype._PTSNormalize=function(t,e){var i;if(void 0===e)return t;for(i=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=i;return t},t}();e.a=u},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){n(this,t)}return t.getSilentFrame=function(t,e){switch(t){case"mp4a.40.2":if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},t}();e.a=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=Math.pow(2,32)-1,a=function(){function t(){n(this,t)}return t.init=function(){t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var e;for(e in t.types)t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);t.HDLR_TYPES={video:i,audio:n};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);t.STTS=t.STSC=t.STCO=a,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);t.FTYP=t.box(t.types.ftyp,o,l,o,s),t.DINF=t.box(t.types.dinf,t.box(t.types.dref,r))},t.box=function(t){for(var e,i=Array.prototype.slice.call(arguments,1),n=8,r=i.length,a=r;r--;)n+=i[r].byteLength;for(e=new Uint8Array(n),e[0]=n>>24&255,e[1]=n>>16&255,
e[2]=n>>8&255,e[3]=255&n,e.set(t,4),r=0,n=8;r<a;r++)e.set(i[r],n),n+=i[r].byteLength;return e},t.hdlr=function(e){return t.box(t.types.hdlr,t.HDLR_TYPES[e])},t.mdat=function(e){return t.box(t.types.mdat,e)},t.mdhd=function(e,i){i*=e;var n=Math.floor(i/(r+1)),a=Math.floor(i%(r+1));return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},t.mdia=function(e){return t.box(t.types.mdia,t.mdhd(e.timescale,e.duration),t.hdlr(e.type),t.minf(e))},t.mfhd=function(e){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},t.minf=function(e){return"audio"===e.type?t.box(t.types.minf,t.box(t.types.smhd,t.SMHD),t.DINF,t.stbl(e)):t.box(t.types.minf,t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(e))},t.moof=function(e,i,n){return t.box(t.types.moof,t.mfhd(e),t.traf(n,i))},t.moov=function(e){for(var i=e.length,n=[];i--;)n[i]=t.trak(e[i]);return t.box.apply(null,[t.types.moov,t.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(t.mvex(e)))},t.mvex=function(e){for(var i=e.length,n=[];i--;)n[i]=t.trex(e[i]);return t.box.apply(null,[t.types.mvex].concat(n))},t.mvhd=function(e,i){i*=e;var n=Math.floor(i/(r+1)),a=Math.floor(i%(r+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t.box(t.types.mvhd,o)},t.sdtp=function(e){var i,n,r=e.samples||[],a=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)i=r[n].flags,a[n+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return t.box(t.types.sdtp,a)},t.stbl=function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.STTS),t.box(t.types.stsc,t.STSC),t.box(t.types.stsz,t.STSZ),t.box(t.types.stco,t.STCO))},t.avc1=function(e){var i,n,r,a=[],o=[];for(i=0;i<e.sps.length;i++)n=e.sps[i],r=n.byteLength,a.push(r>>>8&255),a.push(255&r),a=a.concat(Array.prototype.slice.call(n));for(i=0;i<e.pps.length;i++)n=e.pps[i],r=n.byteLength,o.push(r>>>8&255),o.push(255&r),o=o.concat(Array.prototype.slice.call(n));var s=t.box(t.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|e.sps.length].concat(a).concat([e.pps.length]).concat(o))),l=e.width,u=e.height,d=e.pixelRatio[0],c=e.pixelRatio[1];return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),t.box(t.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,c>>24,c>>16&255,c>>8&255,255&c])))},t.esds=function(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))},t.mp4a=function(e){var i=e.samplerate;return t.box(t.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),t.box(t.types.esds,t.esds(e)))},t.mp3=function(e){var i=e.samplerate;return t.box(t.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))},t.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?t.box(t.types.stsd,t.STSD,t.mp4a(e)):t.box(t.types.stsd,t.STSD,t.mp3(e)):t.box(t.types.stsd,t.STSD,t.avc1(e))},t.tkhd=function(e){var i=e.id,n=e.duration*e.timescale,a=e.width,o=e.height,s=Math.floor(n/(r+1)),l=Math.floor(n%(r+1));return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,o>>8&255,255&o,0,0]))},t.traf=function(e,i){var n=t.sdtp(e),a=e.id,o=Math.floor(i/(r+1)),s=Math.floor(i%(r+1));return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),t.trun(e,n.length+16+20+8+16+8+8),n)},t.trak=function(e){return e.duration=e.duration||4294967295,t.box(t.types.trak,t.tkhd(e),t.mdia(e))},t.trex=function(e){var i=e.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},t.trun=function(e,i){var n,r,a,o,s,l,u=e.samples||[],d=u.length,c=12+16*d,h=new Uint8Array(c);for(i+=8+c,h.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,255&d,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0),n=0;n<d;n++)r=u[n],a=r.duration,o=r.size,s=r.flags,l=r.cts,h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return t.box(t.types.trun,h)},t.initSegment=function(e){t.types||t.init();var i,n=t.moov(e);return i=new Uint8Array(t.FTYP.byteLength+n.byteLength),i.set(t.FTYP),i.set(n,t.FTYP.byteLength),i},t}();e.a=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(1),a=function(){function t(e){n(this,t),this.observer=e}return t.prototype.destroy=function(){},t.prototype.resetTimeStamp=function(){},t.prototype.resetInitSegment=function(){},t.prototype.remux=function(t,e,i,n,a,o,s,l){var u=this.observer,d="";t&&(d+="audio"),e&&(d+="video"),u.trigger(r.a.FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:d,nb:1,dropped:0}),u.trigger(r.a.FRAG_PARSED)},t}();e.a=a},function(t,e,i){function n(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e.oe=function(t){throw console.error(t),t};var n=e(e.s=ENTRY_MODULE);return n.default||n}function r(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(t,e,n){var a={};a[n]=[];var o=e.toString(),s=o.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return a;for(var d,c=s[1],h=new RegExp("(\\\\n|\\W)"+r(c)+u,"g");d=h.exec(o);)"dll-reference"!==d[3]&&a[n].push(d[3]);for(h=new RegExp("\\("+r(c)+'\\("(dll-reference\\s('+l+'))"\\)\\)'+u,"g");d=h.exec(o);)t[d[2]]||(a[n].push(d[1]),t[d[2]]=i(d[1]).m),a[d[2]]=a[d[2]]||[],a[d[2]].push(d[4]);return a}function o(t){return Object.keys(t).reduce(function(e,i){return e||t[i].length>0},!1)}function s(t,e){for(var i={main:[e]},n={main:[]},r={main:{}};o(i);)for(var s=Object.keys(i),l=0;l<s.length;l++){var u=s[l],d=i[u],c=d.pop();if(r[u]=r[u]||{},!r[u][c]&&t[u][c]){r[u][c]=!0,n[u]=n[u]||[],n[u].push(c);for(var h=a(t,t[u][c],u),p=Object.keys(h),f=0;f<p.length;f++)i[p[f]]=i[p[f]]||[],i[p[f]]=i[p[f]].concat(h[p[f]])}}return n}var l="[\\.|\\-|\\+|\\w|/|@]+",u="\\((/\\*.*?\\*/)?s?.*?("+l+").*?\\)";t.exports=function(t,e){e=e||{};var r={main:i.m},a=e.all?{main:Object.keys(r)}:s(r,t),o="";Object.keys(a).filter(function(t){return"main"!==t}).forEach(function(t){for(var e=0;a[t][e];)e++;a[t].push(e),r[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",o=o+"var "+t+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a[t].map(function(e){return JSON.stringify(e)+": "+r[t][e].toString()}).join(",")+"});\n"}),o=o+"("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a.main.map(function(t){return JSON.stringify(t)+": "+r.main[t].toString()}).join(",")+"})(self);";var l=new window.Blob([o],{type:"text/javascript"});if(e.bare)return l;var u=window.URL||window.webkitURL||window.mozURL||window.msURL,d=u.createObjectURL(l),c=new window.Worker(d);return c.objectURL=d,c}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(16),r=i(1),a=i(0),o=i(9),s=i.n(o),l=function(t){var e=new s.a;e.trigger=function(t){for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];e.emit.apply(e,[t,t].concat(n))},e.off=function(t){for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];e.removeListener.apply(e,[t].concat(n))};var i=function(e,i){t.postMessage({event:e,data:i})};t.addEventListener("message",function(r){var o=r.data;switch(o.cmd){case"init":var s=JSON.parse(o.config);t.demuxer=new n.a(e,o.typeSupported,s,o.vendor);try{Object(a.a)(!0===s.debug)}catch(t){console.warn("demuxerWorker: unable to enable logs")}i("init",null);break;case"demux":t.demuxer.push(o.data,o.decryptdata,o.initSegment,o.audioCodec,o.videoCodec,o.timeOffset,o.discontinuity,o.trackSwitch,o.contiguous,o.duration,o.accurateTimeOffset,o.defaultInitPTS)}}),e.on(r.a.FRAG_DECRYPTED,i),e.on(r.a.FRAG_PARSING_INIT_SEGMENT,i),e.on(r.a.FRAG_PARSED,i),e.on(r.a.ERROR,i),e.on(r.a.FRAG_PARSING_METADATA,i),e.on(r.a.FRAG_PARSING_USERDATA,i),e.on(r.a.INIT_PTS_FOUND,i),e.on(r.a.FRAG_PARSING_DATA,function(e,i){var n=[],r={event:e,data:i};i.data1&&(r.data1=i.data1.buffer,n.push(i.data1.buffer),delete i.data1),i.data2&&(r.data2=i.data2.buffer,n.push(i.data2.buffer),delete i.data2),t.postMessage(r,n)})};e.default=l},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(3),l=i(0),u=i(2),d=i(14),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,o.a.MANIFEST_LOADED,o.a.LEVEL_LOADED,o.a.FRAG_LOADED,o.a.ERROR));return a.canload=!1,a.currentLevelIndex=null,a.manualLevelIndex=-1,a.timer=null,a}return a(e,t),e.prototype.onHandlerDestroying=function(){this.cleanTimer(),this.manualLevelIndex=-1},e.prototype.cleanTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},e.prototype.startLoad=function(){var t=this._levels;this.canload=!0,this.levelRetryCount=0,t&&t.forEach(function(t){t.loadError=0;var e=t.details;e&&e.live&&(t.details=void 0)}),null!==this.timer&&this.loadLevel()},e.prototype.stopLoad=function(){this.canload=!1},e.prototype.onManifestLoaded=function(t){var e=[],i=void 0,n={},r=null,a=!1,s=!1,c=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),h=[];if(t.levels.forEach(function(t){t.loadError=0,t.fragmentError=!1,a=a||!!t.videoCodec,s=s||!!t.audioCodec||!(!t.attrs||!t.attrs.AUDIO),!0===c&&t.audioCodec&&-1!==t.audioCodec.indexOf("mp4a.40.34")&&(t.audioCodec=void 0),r=n[t.bitrate],void 0===r?(t.url=[t.url],t.urlId=0,n[t.bitrate]=t,e.push(t)):r.url.push(t.url)}),!0===a&&!0===s&&(e=e.filter(function(t){return!!t.videoCodec})),e=e.filter(function(t){var e=t.audioCodec,i=t.videoCodec;return(!e||Object(d.a)(e))&&(!i||Object(d.a)(i))}),t.audioTracks&&(h=t.audioTracks.filter(function(t){return!t.audioCodec||Object(d.a)(t.audioCodec,"audio")})),e.length>0){i=e[0].bitrate,e.sort(function(t,e){return t.bitrate-e.bitrate}),this._levels=e;for(var p=0;p<e.length;p++)if(e[p].bitrate===i){this._firstLevel=p,l.b.log("manifest loaded,"+e.length+" level(s) found, first bitrate:"+i);break}this.hls.trigger(o.a.MANIFEST_PARSED,{levels:e,audioTracks:h,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:a,altAudio:h.length>0})}else this.hls.trigger(o.a.ERROR,{type:u.b.MEDIA_ERROR,details:u.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},e.prototype.setLevelInternal=function(t){var e=this._levels,i=this.hls;if(t>=0&&t<e.length){if(this.cleanTimer(),this.currentLevelIndex!==t){l.b.log("switching to level "+t),this.currentLevelIndex=t;var n=e[t];n.level=t,i.trigger(o.a.LEVEL_SWITCH,n),i.trigger(o.a.LEVEL_SWITCHING,n)}var r=e[t],a=r.details;if(!a||!0===a.live){var s=r.urlId;i.trigger(o.a.LEVEL_LOADING,{url:r.url[s],level:t,id:s})}}else i.trigger(o.a.ERROR,{type:u.b.OTHER_ERROR,details:u.a.LEVEL_SWITCH_ERROR,level:t,fatal:!1,reason:"invalid level idx"})},e.prototype.onError=function(t){if(!0===t.fatal)return void(t.type===u.b.NETWORK_ERROR&&this.cleanTimer());var e=!1,i=!1,n=void 0;switch(t.details){case u.a.FRAG_LOAD_ERROR:case u.a.FRAG_LOAD_TIMEOUT:case u.a.FRAG_LOOP_LOADING_ERROR:case u.a.KEY_LOAD_ERROR:case u.a.KEY_LOAD_TIMEOUT:n=t.frag.level,i=!0;break;case u.a.LEVEL_LOAD_ERROR:case u.a.LEVEL_LOAD_TIMEOUT:n=t.context.level,e=!0;break;case u.a.REMUX_ALLOC_ERROR:n=t.level,e=!0}void 0!==n&&this.recoverLevel(t,n,e,i)},e.prototype.recoverLevel=function(t,e,i,n){var r=this,a=this.hls.config,o=t.details,s=this._levels[e],u=void 0,d=void 0,c=void 0;if(s.loadError++,s.fragmentError=n,!0===i){if(!(this.levelRetryCount+1<=a.levelLoadingMaxRetry))return l.b.error("level controller, cannot recover from "+o+" error"),this.currentLevelIndex=null,this.cleanTimer(),void(t.fatal=!0);d=Math.min(Math.pow(2,this.levelRetryCount)*a.levelLoadingRetryDelay,a.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return r.loadLevel()},d),t.levelRetry=!0,this.levelRetryCount++,l.b.warn("level controller, "+o+", retry in "+d+" ms, current retry count is "+this.levelRetryCount)}!0!==i&&!0!==n||(u=s.url.length,u>1&&s.loadError<u?(l.b.warn("level controller, "+o+" for level "+e+": switching to redundant stream id "+s.urlId),s.urlId=(s.urlId+1)%u,s.details=void 0):-1===this.manualLevelIndex?(c=0===e?this._levels.length-1:e-1,l.b.warn("level controller, "+o+": switch to "+c),this.hls.nextAutoLevel=this.currentLevelIndex=c):!0===n&&(l.b.warn("level controller, "+o+": reload a fragment"),this.currentLevelIndex=null))},e.prototype.onFragLoaded=function(t){var e=t.frag;if(void 0!==e&&"main"===e.type){var i=this._levels[e.level];void 0!==i&&(i.fragmentError=!1,i.loadError=0,this.levelRetryCount=0)}},e.prototype.onLevelLoaded=function(t){var e=this,i=t.level;if(i===this.currentLevelIndex){var n=this._levels[i];!1===n.fragmentError&&(n.loadError=0,this.levelRetryCount=0);var r=t.details;if(r.live){var a=1e3*(r.averagetargetduration?r.averagetargetduration:r.targetduration),o=n.details;o&&r.endSN===o.endSN&&(a/=2,l.b.log("same live playlist, reload twice faster")),a-=performance.now()-t.stats.trequest,a=Math.max(1e3,Math.round(a)),l.b.log("live playlist, reload in "+a+" ms"),this.timer=setTimeout(function(){return e.loadLevel()},a)}else this.cleanTimer()}},e.prototype.loadLevel=function(){var t=void 0,e=void 0;null!==this.currentLevelIndex&&!0===this.canload&&void 0!==(t=this._levels[this.currentLevelIndex])&&t.url.length>0&&(e=t.urlId,this.hls.trigger(o.a.LEVEL_LOADING,{url:t.url[e],level:this.currentLevelIndex,id:e}))},c(e,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(t){var e=this._levels;e&&(t=Math.min(t,e.length-1),this.currentLevelIndex===t&&void 0!==e[t].details||this.setLevelInternal(t))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(t){this._firstLevel=t}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var t=this.hls.config.startLevel;return void 0!==t?t:this._firstLevel}return this._startLevel},set:function(t){this._startLevel=t}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}}]),e}(s.a);e.a=h},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(3),l=i(5),u=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,o.a.MEDIA_ATTACHED,o.a.MEDIA_DETACHING,o.a.FRAG_PARSING_METADATA));return a.id3Track=void 0,a.media=void 0,a}return a(e,t),e.prototype.destroy=function(){s.a.prototype.destroy.call(this)},e.prototype.onMediaAttached=function(t){this.media=t.media,this.media},e.prototype.onMediaDetaching=function(){this.media=void 0},e.prototype.onFragParsingMetadata=function(t){var e=t.frag,i=t.samples;this.id3Track||(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,r=0;r<i.length;r++){var a=l.a.getID3Frames(i[r].data);if(a){var o=i[r].pts,s=r<i.length-1?i[r+1].pts:e.endPTS;o===s&&(s+=1e-4);for(var u=0;u<a.length;u++){var d=a[u];if(!l.a.isTimeStampFrame(d)){var c=new n(o,s,"");c.value=d,this.id3Track.addCue(c)}}}}},e}(s.a);e.a=u},function(t,e,i){"use strict";function n(){var t=Object(r.a)(),e=window.SourceBuffer||window.WebKitSourceBuffer,i=t&&"function"==typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove;return!!i&&!!n}e.a=n;var r=i(10)},function(t,e,i){"use strict";i.d(e,"a",function(){return v});var n=i(49),r=i(52),a=i(53),o=i(54),s=i(55),l=i(56),u=i(57),d=i(58),c=i(60),h=i(64),p=i(65),f=i(66),y=i(67),v={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:s.a,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,fetchSetup:void 0,abrController:n.a,bufferController:r.a,capLevelController:a.a,fpsController:o.a,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:y.a};v.subtitleStreamController=p.a,v.subtitleTrackController=h.a,v.timelineController=c.a,v.cueHandler=d,v.enableCEA708Captions=!0,v.enableWebVTT=!0,v.captionsTextTrack1Label="English",v.captionsTextTrack1LanguageCode="en",v.captionsTextTrack2Label="Spanish",v.captionsTextTrack2LanguageCode="es",v.audioStreamController=u.a,v.audioTrackController=l.a,v.emeController=f.a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(3),l=i(7),u=i(2),d=i(0),c=i(50),h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),p=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,o.a.FRAG_LOADING,o.a.FRAG_LOADED,o.a.FRAG_BUFFERED,o.a.ERROR));return a.lastLoadedFragLevel=0,a._nextAutoLevel=-1,a.hls=i,a.timer=null,a._bwEstimator=null,a.onCheck=a._abandonRulesCheck.bind(a),a}return a(e,t),e.prototype.destroy=function(){this.clearTimer(),s.a.prototype.destroy.call(this)},e.prototype.onFragLoading=function(t){var e=t.frag;if("main"===e.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var i=this.hls,n=t.frag.level,r=i.levels[n].details.live,a=i.config,o=void 0,s=void 0;r?(o=a.abrEwmaFastLive,s=a.abrEwmaSlowLive):(o=a.abrEwmaFastVoD,s=a.abrEwmaSlowVoD),this._bwEstimator=new c.a(i,s,o,a.abrEwmaDefaultEstimate)}this.fragCurrent=e}},e.prototype._abandonRulesCheck=function(){var t=this.hls,e=t.media,i=this.fragCurrent,n=i.loader,r=t.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return d.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var a=n.stats;if(e&&a&&(!e.paused&&0!==e.playbackRate||!e.readyState)&&i.autoLevel&&i.level){var s=performance.now()-a.trequest,u=Math.abs(e.playbackRate);if(s>500*i.duration/u){var c=t.levels,h=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/s),p=c[i.level],f=p.realBitrate?Math.max(p.realBitrate,p.bitrate):p.bitrate,y=a.total?a.total:Math.max(a.loaded,Math.round(i.duration*f/8)),v=e.currentTime,m=(y-a.loaded)/h,g=(l.a.bufferInfo(e,v,t.config.maxBufferHole).end-v)/u;if(g<2*i.duration/u&&m>g){var b=void 0,E=void 0;for(E=i.level-1;E>r;E--){var T=c[E].realBitrate?Math.max(c[E].realBitrate,c[E].bitrate):c[E].bitrate;if((b=i.duration*T/(6.4*h))<g)break}b<m&&(d.b.warn("loading too slow, abort fragment loading and switch to level "+E+":fragLoadedDelay["+E+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+b.toFixed(1)+"<"+m.toFixed(1)+":"+g.toFixed(1)),t.nextLoadLevel=E,this._bwEstimator.sample(s,a.loaded),n.abort(),this.clearTimer(),t.trigger(o.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:a}))}}}},e.prototype.onFragLoaded=function(t){var e=t.frag;if("main"===e.type&&!isNaN(e.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=e.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[e.level],n=(i.loaded?i.loaded.bytes:0)+t.stats.loaded,r=(i.loaded?i.loaded.duration:0)+t.frag.duration;i.loaded={bytes:n,duration:r},i.realBitrate=Math.round(8*n/r)}if(t.frag.bitrateTest){var a=t.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(t)}}},e.prototype.onFragBuffered=function(t){var e=t.stats,i=t.frag;if(!(!0===e.aborted||1!==i.loadCounter||"main"!==i.type||isNaN(i.sn)||i.bitrateTest&&e.tload!==e.tbuffered)){var n=e.tparsed-e.trequest;d.b.log("latency/loading/parsing/append/kbps:"+Math.round(e.tfirst-e.trequest)+"/"+Math.round(e.tload-e.tfirst)+"/"+Math.round(e.tparsed-e.tload)+"/"+Math.round(e.tbuffered-e.tparsed)+"/"+Math.round(8*e.loaded/(e.tbuffered-e.trequest))),this._bwEstimator.sample(n,e.loaded),e.bwEstimate=this._bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}},e.prototype.onError=function(t){switch(t.details){case u.a.FRAG_LOAD_ERROR:case u.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},e.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},e.prototype._findBestLevel=function(t,e,i,n,r,a,o,s,l){for(var u=r;u>=n;u--){var c=l[u],h=c.details,p=h?h.totalduration/h.fragments.length:e,f=!!h&&h.live,y=void 0;y=u<=t?o*i:s*i;var v=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,m=v*p/y;if(d.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(y)+"/"+v+"/"+p+"/"+a+"/"+m),y>v&&(!m||f&&!this.bitrateTestDelay||m<a))return u}return-1},h(e,[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,e=this._bwEstimator;if(!(-1===t||e&&e.canEstimate()))return t;var i=this._nextABRAutoLevel;return-1!==t&&(i=Math.min(t,i)),i},set:function(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function(){var t=this.hls,e=t.maxAutoLevel,i=t.levels,n=t.config,r=t.minAutoLevel,a=t.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,u=a?a.currentTime:0,c=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,h=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,p=(l.a.bufferInfo(a,u,n.maxBufferHole).end-u)/c,f=this._findBestLevel(o,s,h,r,e,p,n.abrBandWidthFactor,n.abrBandWidthUpFactor,i);if(f>=0)return f;d.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var y=s?Math.min(s,n.maxStarvationDelay):n.maxStarvationDelay,v=n.abrBandWidthFactor,m=n.abrBandWidthUpFactor;if(0===p){var g=this.bitrateTestDelay;g&&(y=(s?Math.min(s,n.maxLoadingDelay):n.maxLoadingDelay)-g,d.b.trace("bitrate test took "+Math.round(1e3*g)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*y)+" ms"),v=m=1)}return f=this._findBestLevel(o,s,h,r,e,p+y,v,m,i),Math.max(f,0)}}]),e}(s.a);e.a=p},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(51),a=function(){function t(e,i,a,o){n(this,t),this.hls=e,this.defaultEstimate_=o,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new r.a(i),this.fast_=new r.a(a)}return t.prototype.sample=function(t,e){t=Math.max(t,this.minDelayMs_);var i=8e3*e/t,n=t/1e3;this.fast_.sample(n,i),this.slow_.sample(n,i)},t.prototype.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_},t.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.prototype.destroy=function(){},t}();e.a=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e){n(this,t),this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}return t.prototype.sample=function(t,e){var i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t},t.prototype.getTotalWeight=function(){return this.totalWeight_},t.prototype.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}return this.estimate_},t}();e.a=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(3),l=i(0),u=i(2),d=i(10),c=Object(d.a)(),h=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,o.a.MEDIA_ATTACHING,o.a.MEDIA_DETACHING,o.a.MANIFEST_PARSED,o.a.BUFFER_RESET,o.a.BUFFER_APPENDING,o.a.BUFFER_CODECS,o.a.BUFFER_EOS,o.a.BUFFER_FLUSHING,o.a.LEVEL_PTS_UPDATED,o.a.LEVEL_UPDATED));return a._msDuration=null,a._levelDuration=null,a._live=null,a._objectUrl=null,a.onsbue=a.onSBUpdateEnd.bind(a),a.onsbe=a.onSBUpdateError.bind(a),a.pendingTracks={},a.tracks={},a}return a(e,t),e.prototype.destroy=function(){s.a.prototype.destroy.call(this)},e.prototype.onLevelPtsUpdated=function(t){var e=t.type,i=this.tracks.audio;if("audio"===e&&i&&"audio/mpeg"===i.container){var n=this.sourceBuffer.audio;if(Math.abs(n.timestampOffset-t.start)>.1){var r=n.updating;try{n.abort()}catch(t){r=!0,l.b.warn("can not abort audio buffer: "+t)}r?this.audioTimestampOffset=t.start:(l.b.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+t.start),n.timestampOffset=t.start)}}},e.prototype.onManifestParsed=function(t){var e=t.audio,i=t.video||t.levels.length&&t.audio,n=0;t.altAudio&&(e||i)&&(n=(e?1:0)+(i?1:0),l.b.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n},e.prototype.onMediaAttaching=function(t){var e=this.media=t.media;if(e){var i=this.mediaSource=new c;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),i.addEventListener("sourceopen",this.onmso),i.addEventListener("sourceended",this.onmse),i.addEventListener("sourceclose",this.onmsc),e.src=URL.createObjectURL(i),this._objectUrl=e.src}},e.prototype.onMediaDetaching=function(){l.b.log("media source detaching");var t=this.mediaSource;if(t){if("open"===t.readyState)try{t.endOfStream()}catch(t){l.b.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this.onmso),t.removeEventListener("sourceended",this.onmse),t.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):l.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(o.a.MEDIA_DETACHED)},e.prototype.onMediaSourceOpen=function(){l.b.log("media source opened"),this.hls.trigger(o.a.MEDIA_ATTACHED,{media:this.media});var t=this.mediaSource;t&&t.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},e.prototype.checkPendingTracks=function(){var t=this.pendingTracks,e=Object.keys(t).length;e&&(this.sourceBufferNb<=e||0===this.sourceBufferNb)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},e.prototype.onMediaSourceClose=function(){l.b.log("media source closed")},e.prototype.onMediaSourceEnded=function(){l.b.log("media source ended")},e.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var t=this.sourceBuffer.audio;l.b.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+this.audioTimestampOffset),t.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var e=this.parent,i=this.segments.reduce(function(t,i){return i.parent===e?t+1:t},0);this.hls.trigger(o.a.BUFFER_APPENDED,{parent:e,pending:i}),this._needsFlush||this.doAppending(),
this.updateMediaElementDuration()},e.prototype.onSBUpdateError=function(t){l.b.error("sourceBuffer error:",t),this.hls.trigger(o.a.ERROR,{type:u.b.MEDIA_ERROR,details:u.a.BUFFER_APPENDING_ERROR,fatal:!1})},e.prototype.onBufferReset=function(){var t=this.sourceBuffer;for(var e in t){var i=t[e];try{this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this.onsbue),i.removeEventListener("error",this.onsbe)}catch(t){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},e.prototype.onBufferCodecs=function(t){if(0===Object.keys(this.sourceBuffer).length){for(var e in t)this.pendingTracks[e]=t[e];var i=this.mediaSource;i&&"open"===i.readyState&&this.checkPendingTracks()}},e.prototype.createSourceBuffers=function(t){var e=this.sourceBuffer,i=this.mediaSource;for(var n in t)if(!e[n]){var r=t[n],a=r.levelCodec||r.codec,s=r.container+";codecs="+a;l.b.log("creating sourceBuffer("+s+")");try{var d=e[n]=i.addSourceBuffer(s);d.addEventListener("updateend",this.onsbue),d.addEventListener("error",this.onsbe),this.tracks[n]={codec:a,container:r.container},r.buffer=d}catch(t){l.b.error("error while trying to add sourceBuffer:"+t.message),this.hls.trigger(o.a.ERROR,{type:u.b.MEDIA_ERROR,details:u.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:t,mimeType:s})}}this.hls.trigger(o.a.BUFFER_CREATED,{tracks:t})},e.prototype.onBufferAppending=function(t){this._needsFlush||(this.segments?this.segments.push(t):this.segments=[t],this.doAppending())},e.prototype.onBufferAppendFail=function(t){l.b.error("sourceBuffer error:",t.event),this.hls.trigger(o.a.ERROR,{type:u.b.MEDIA_ERROR,details:u.a.BUFFER_APPENDING_ERROR,fatal:!1})},e.prototype.onBufferEos=function(t){var e=this.sourceBuffer,i=t.type;for(var n in e)i&&n!==i||e[n].ended||(e[n].ended=!0,l.b.log(n+" sourceBuffer now EOS"));this.checkEos()},e.prototype.checkEos=function(){var t=this.sourceBuffer,e=this.mediaSource;if(!e||"open"!==e.readyState)return void(this._needsEos=!1);for(var i in t){var n=t[i];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}l.b.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{e.endOfStream()}catch(t){l.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1},e.prototype.onBufferFlushing=function(t){this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type}),this.flushBufferCounter=0,this.doFlush()},e.prototype.onLevelUpdated=function(t){var e=t.details;e.fragments.length>0&&(this._levelDuration=e.totalduration+e.fragments[0].start,this._live=e.live,this.updateMediaElementDuration())},e.prototype.updateMediaElementDuration=function(){var t=this.hls.config,e=void 0;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer)if(!0===this.sourceBuffer[i].updating)return;e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(l.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||e===1/0||isNaN(e))&&(l.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},e.prototype.doFlush=function(){for(;this.flushRange.length;){var t=this.flushRange[0];if(!this.flushBuffer(t.start,t.end,t.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var e=0,i=this.sourceBuffer;try{for(var n in i)e+=i[n].buffered.length}catch(t){l.b.error("error while accessing sourceBuffer.buffered")}this.appended=e,this.hls.trigger(o.a.BUFFER_FLUSHED)}},e.prototype.doAppending=function(){var t=this.hls,e=this.sourceBuffer,i=this.segments;if(Object.keys(e).length){if(this.media.error)return this.segments=[],void l.b.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(i&&i.length){var n=i.shift();try{var r=n.type,a=e[r];a?a.updating?i.unshift(n):(a.ended=!1,this.parent=n.parent,a.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(e){l.b.error("error while trying to append buffer:"+e.message),i.unshift(n);var s={type:u.b.MEDIA_ERROR,parent:n.parent};if(22===e.code)return this.segments=[],s.details=u.a.BUFFER_FULL_ERROR,s.fatal=!1,void t.trigger(o.a.ERROR,s);if(this.appendError?this.appendError++:this.appendError=1,s.details=u.a.BUFFER_APPEND_ERROR,this.appendError>t.config.appendErrorMaxRetry)return l.b.log("fail "+t.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),i=[],s.fatal=!0,void t.trigger(o.a.ERROR,s);s.fatal=!1,t.trigger(o.a.ERROR,s)}}}},e.prototype.flushBuffer=function(t,e,i){var n,r,a,o,s,u,d=this.sourceBuffer;if(Object.keys(d).length){if(l.b.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+t+"/"+e),this.flushBufferCounter<this.appended){for(var c in d)if(!i||c===i){if(n=d[c],n.ended=!1,n.updating)return l.b.warn("cannot flush, sb updating in progress"),!1;try{for(r=0;r<n.buffered.length;r++)if(a=n.buffered.start(r),o=n.buffered.end(r),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&e===Number.POSITIVE_INFINITY?(s=t,u=e):(s=Math.max(a,t),u=Math.min(o,e)),Math.min(u,o)-s>.5)return this.flushBufferCounter++,l.b.log("flush "+c+" ["+s+","+u+"], of ["+a+","+o+"], pos:"+this.media.currentTime),n.remove(s,u),!1}catch(t){l.b.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else l.b.warn("abort flushing too many retries");l.b.log("buffer flushed")}return!0},e}(s.a);e.a=h},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(3),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function(t){function e(i){return n(this,e),r(this,t.call(this,i,o.a.FPS_DROP_LEVEL_CAPPING,o.a.MEDIA_ATTACHING,o.a.MANIFEST_PARSED))}return a(e,t),e.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))},e.prototype.onFpsDropLevelCapping=function(t){e.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)},e.prototype.onMediaAttaching=function(t){this.media=t.media instanceof HTMLVideoElement?t.media:null},e.prototype.onManifestParsed=function(t){var e=this.hls;this.restrictedLevels=[],e.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=t.levels,e.firstLevel=this.getMaxLevel(t.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},e.prototype.detectPlayerSize=function(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var e=this.hls;e.autoLevelCapping=this.getMaxLevel(t-1),e.autoLevelCapping>this.autoLevelCapping&&e.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}},e.prototype.getMaxLevel=function(t){var i=this;if(!this.levels)return-1;var n=this.levels.filter(function(n,r){return e.isLevelAllowed(r,i.restrictedLevels)&&r<=t});return e.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)},e.isLevelAllowed=function(t){return-1===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).indexOf(t)},e.getMaxLevelByMediaSize=function(t,e,i){if(!t||t&&!t.length)return-1;for(var n=t.length-1,r=0;r<t.length;r+=1){var a=t[r];if((a.width>=e||a.height>=i)&&function(t,e){return!e||t.width!==e.width||t.height!==e.height}(a,t[r+1])){n=r;break}}return n},l(e,[{key:"mediaWidth",get:function(){var t=void 0,i=this.media;return i&&(t=i.width||i.clientWidth||i.offsetWidth,t*=e.contentScaleFactor),t}},{key:"mediaHeight",get:function(){var t=void 0,i=this.media;return i&&(t=i.height||i.clientHeight||i.offsetHeight,t*=e.contentScaleFactor),t}}],[{key:"contentScaleFactor",get:function(){var t=1;try{t=window.devicePixelRatio}catch(t){}return t}}]),e}(s.a);e.a=u},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(3),l=i(0),u=function(t){function e(i){return n(this,e),r(this,t.call(this,i,o.a.MEDIA_ATTACHING))}return a(e,t),e.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},e.prototype.onMediaAttaching=function(t){var e=this.hls.config;e.capLevelOnFPSDrop&&("function"==typeof(this.video=t.media instanceof HTMLVideoElement?t.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),e.fpsDroppedMonitoringPeriod))},e.prototype.checkFPS=function(t,e,i){var n=performance.now();if(e){if(this.lastTime){var r=n-this.lastTime,a=i-this.lastDroppedFrames,s=e-this.lastDecodedFrames,u=1e3*a/r,d=this.hls;if(d.trigger(o.a.FPS_DROP,{currentDropped:a,currentDecoded:s,totalDroppedFrames:i}),u>0&&a>d.config.fpsDroppedMonitoringThreshold*s){var c=d.currentLevel;l.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(-1===d.autoLevelCapping||d.autoLevelCapping>=c)&&(c-=1,d.trigger(o.a.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:d.currentLevel}),d.autoLevelCapping=c,d.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=e}},e.prototype.checkFPSInterval=function(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},e}(s.a);e.a=u},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=i(0),a=function(){function t(e){n(this,t),e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}return t.prototype.destroy=function(){this.abort(),this.loader=null},t.prototype.abort=function(){var t=this.loader;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.prototype.load=function(t,e,i){this.context=t,this.config=e,this.callbacks=i,this.stats={trequest:performance.now(),retry:0},this.retryDelay=e.retryDelay,this.loadInternal()},t.prototype.loadInternal=function(){var t,e=this.context;t=this.loader=new XMLHttpRequest;var i=this.stats;i.tfirst=0,i.loaded=0;var n=this.xhrSetup;try{if(n)try{n(t,e.url)}catch(i){t.open("GET",e.url,!0),n(t,e.url)}t.readyState||t.open("GET",e.url,!0)}catch(i){return void this.callbacks.onError({code:t.status,text:i.message},e,t)}e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},t.prototype.readystatechange=function(t){var e=t.currentTarget,i=e.readyState,n=this.stats,a=this.context,o=this.config;if(!n.aborted&&i>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest)),4===i){var s=e.status;if(s>=200&&s<300){n.tload=Math.max(n.tfirst,performance.now());var l=void 0,u=void 0;"arraybuffer"===a.responseType?(l=e.response,u=l.byteLength):(l=e.responseText,u=l.length),n.loaded=n.total=u;var d={url:e.responseURL,data:l};this.callbacks.onSuccess(d,n,a,e)}else n.retry>=o.maxRetry||s>=400&&s<499?(r.b.error(s+" while loading "+a.url),this.callbacks.onError({code:s,text:e.statusText},a,e)):(r.b.warn(s+" while loading "+a.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)},t.prototype.loadtimeout=function(){r.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.prototype.loadprogress=function(t){var e=t.currentTarget,i=this.stats;i.loaded=t.loaded,t.lengthComputable&&(i.total=t.total);var n=this.callbacks.onProgress;n&&n(i,this.context,null,e)},t}();e.a=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(3),l=i(0),u=i(2),d=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,o.a.MANIFEST_LOADING,o.a.MANIFEST_PARSED,o.a.AUDIO_TRACK_LOADED,o.a.ERROR));return a.ticks=0,a.ontick=a.tick.bind(a),a}return a(e,t),e.prototype.destroy=function(){this.cleanTimer(),s.a.prototype.destroy.call(this)},e.prototype.cleanTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},e.prototype.tick=function(){1==++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)},e.prototype.doTick=function(){this.updateTrack(this.trackId)},e.prototype.onError=function(t){t.fatal&&t.type===u.b.NETWORK_ERROR&&this.cleanTimer()},e.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},e.prototype.onManifestParsed=function(t){var e=this,i=t.audioTracks||[],n=!1;this.tracks=i,this.hls.trigger(o.a.AUDIO_TRACKS_UPDATED,{audioTracks:i});var r=0;i.forEach(function(t){if(t.default&&!n)return e.audioTrack=r,void(n=!0);r++}),!1===n&&i.length&&(l.b.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)},e.prototype.onAudioTrackLoaded=function(t){t.id<this.tracks.length&&(l.b.log("audioTrack "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*t.details.targetduration)),!t.details.live&&this.timer&&this.cleanTimer())},e.prototype.setAudioTrackInternal=function(t){if(t>=0&&t<this.tracks.length){this.cleanTimer(),this.trackId=t,l.b.log("switching to audioTrack "+t);var e=this.tracks[t],i=this.hls,n=e.type,r=e.url,a={id:t,type:n,url:r};i.trigger(o.a.AUDIO_TRACK_SWITCH,a),i.trigger(o.a.AUDIO_TRACK_SWITCHING,a);var s=e.details;!r||void 0!==s&&!0!==s.live||(l.b.log("(re)loading playlist for audioTrack "+t),i.trigger(o.a.AUDIO_TRACK_LOADING,{url:r,id:t}))}},e.prototype.updateTrack=function(t){if(t>=0&&t<this.tracks.length){this.cleanTimer(),this.trackId=t,l.b.log("updating audioTrack "+t);var e=this.tracks[t],i=e.url,n=e.details;!i||void 0!==n&&!0!==n.live||(l.b.log("(re)loading playlist for audioTrack "+t),this.hls.trigger(o.a.AUDIO_TRACK_LOADING,{url:i,id:t}))}},d(e,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(t){this.trackId===t&&void 0!==this.tracks[t].details||this.setAudioTrackInternal(t)}}]),e}(s.a);e.a=c},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(6),s=i(7),l=i(15),u=i(1),d=i(19),c=i(20),h=i(2),p=i(0),f=i(21),y=i(11),v=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),m={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},g=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.AUDIO_TRACKS_UPDATED,u.a.AUDIO_TRACK_SWITCHING,u.a.AUDIO_TRACK_LOADED,u.a.KEY_LOADED,u.a.FRAG_LOADED,u.a.FRAG_PARSING_INIT_SEGMENT,u.a.FRAG_PARSING_DATA,u.a.FRAG_PARSED,u.a.ERROR,u.a.BUFFER_RESET,u.a.BUFFER_CREATED,u.a.BUFFER_APPENDED,u.a.BUFFER_FLUSHED,u.a.INIT_PTS_FOUND));return a.config=i.config,a.audioCodecSwap=!1,a._state=m.STOPPED,a.initPTS=[],a.waitingFragment=null,a.videoTrackCC=null,a}return a(e,t),e.prototype.onHandlerDestroying=function(){this.stopLoad()},e.prototype.onHandlerDestroyed=function(){this.state=m.STOPPED},e.prototype.onInitPtsFound=function(t){var e=t.id,i=t.frag.cc,n=t.initPTS;"main"===e&&(this.initPTS[i]=n,this.videoTrackCC=i,p.b.log("InitPTS for cc: "+i+" found from video track: "+n),this.state===m.WAITING_INIT_PTS&&this.tick())},e.prototype.startLoad=function(t){if(this.tracks){var e=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,e>0&&-1===t?(p.b.log("audio:override startPosition with lastCurrentTime @"+e.toFixed(3)),this.state=m.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:t,this.state=m.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=t,this.state=m.STOPPED},e.prototype.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=m.STOPPED},e.prototype.doTick=function(){var t,e,i,n=this.hls,r=n.config;switch(this.state){case m.ERROR:case m.PAUSED:case m.BUFFER_FLUSHING:break;case m.STARTING:this.state=m.WAITING_TRACK,this.loadedmetadata=!1;break;case m.IDLE:var a=this.tracks;if(!a)break;if(!this.media&&(this.startFragRequested||!r.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(void 0===(t=this.nextLoadPosition))break;var l=this.mediaBuffer?this.mediaBuffer:this.media,d=this.videoBuffer?this.videoBuffer:this.media,c=s.a.bufferInfo(l,t,r.maxBufferHole),y=s.a.bufferInfo(d,t,r.maxBufferHole),v=c.len,g=c.end,b=this.fragPrevious,E=Math.max(r.maxBufferLength,y.len),T=this.audioSwitch,w=this.trackId;if((v<E||T)&&w<a.length){if(void 0===(i=a[w].details)){this.state=m.WAITING_TRACK;break}if(!T&&!i.live&&b&&b.sn===i.endSN&&!c.nextStart&&(!this.media.seeking||this.media.duration-g<b.duration/2)){this.hls.trigger(u.a.BUFFER_EOS,{type:"audio"}),this.state=m.ENDED;break}var S=i.fragments,_=S.length,k=S[0].start,L=S[_-1].start+S[_-1].duration,R=void 0;if(T)if(i.live&&!i.PTSKnown)p.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),g=0;else if(g=t,i.PTSKnown&&t<k){if(!(c.end>k||c.nextStart))return;p.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=k+.05}if(i.initSegment&&!i.initSegment.data)R=i.initSegment;else if(g<=k){if(R=S[0],null!==this.videoTrackCC&&R.cc!==this.videoTrackCC&&(R=Object(f.b)(S,this.videoTrackCC)),i.live&&R.loadIdx&&R.loadIdx===this.fragLoadIdx){var A=c.nextStart?c.nextStart:k;return p.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(A+.05)),void(this.media.currentTime=A+.05)}}else{var D=void 0,x=r.maxFragLookUpTolerance,I=b?S[b.sn-S[0].sn+1]:void 0,O=function(t){var e=Math.min(x,t.duration);return t.start+t.duration-e<=g?1:t.start-e>g&&t.start?-1:0};g<L?(g>L-x&&(x=0),D=I&&!O(I)?I:o.a.search(S,O)):D=S[_-1],D&&(R=D,k=D.start,b&&R.level===b.level&&R.sn===b.sn&&(R.sn<i.endSN?(R=S[R.sn+1-i.startSN],p.b.log("SN just loaded, load next one: "+R.sn)):R=null))}if(R)if(R.decryptdata&&null!=R.decryptdata.uri&&null==R.decryptdata.key)p.b.log("Loading key for "+R.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+w),this.state=m.KEY_LOADING,n.trigger(u.a.KEY_LOADING,{frag:R});else{if(p.b.log("Loading "+R.sn+", cc: "+R.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+w+", currentTime:"+t+",bufferEnd:"+g.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,R.loadCounter){R.loadCounter++;var C=r.fragLoadingLoopThreshold;if(R.loadCounter>C&&Math.abs(this.fragLoadIdx-R.loadIdx)<C)return void n.trigger(u.a.ERROR,{type:h.b.MEDIA_ERROR,details:h.a.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:R})}else R.loadCounter=1;R.loadIdx=this.fragLoadIdx,this.fragCurrent=R,this.startFragRequested=!0,isNaN(R.sn)||(this.nextLoadPosition=R.start+R.duration),n.trigger(u.a.FRAG_LOADING,{frag:R}),this.state=m.FRAG_LOADING}}break;case m.WAITING_TRACK:(e=this.tracks[this.trackId])&&e.details&&(this.state=m.IDLE);break;case m.FRAG_LOADING_WAITING_RETRY:var P=performance.now(),M=this.retryDate;l=this.media;var F=l&&l.seeking;(!M||P>=M||F)&&(p.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=m.IDLE);break;case m.WAITING_INIT_PTS:var N=this.videoTrackCC;if(void 0===this.initPTS[N])break;var B=this.waitingFragment;if(B){var U=B.frag.cc;N!==U?(e=this.tracks[this.trackId],e.details&&e.details.live&&(p.b.warn("Waiting fragment CC ("+U+") does not match video track CC ("+N+")"),this.waitingFragment=null,this.state=m.IDLE)):(this.state=m.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=m.IDLE;break;case m.STOPPED:case m.FRAG_LOADING:case m.PARSING:case m.PARSED:case m.ENDED:}},e.prototype.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("ended",this.onvended);var i=this.config;this.tracks&&i.autoStartLoad&&this.startLoad(i.startPosition)},e.prototype.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(p.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.tracks;e&&e.forEach(function(t){t.details&&t.details.fragments.forEach(function(t){t.loadCounter=void 0})}),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},e.prototype.onMediaSeeking=function(){this.state===m.ENDED&&(this.state=m.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()},e.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},e.prototype.onAudioTracksUpdated=function(t){p.b.log("audio tracks updated"),this.tracks=t.audioTracks},e.prototype.onAudioTrackSwitching=function(t){var e=!!t.url;this.trackId=t.id,this.fragCurrent=null,this.state=m.PAUSED,this.waitingFragment=null,e?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),e&&(this.audioSwitch=!0,this.state=m.IDLE,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold)),this.tick()},e.prototype.onAudioTrackLoaded=function(t){var e=t.details,i=t.id,n=this.tracks[i],r=e.totalduration,a=0;if(p.b.log("track "+i+" loaded ["+e.startSN+","+e.endSN+"],duration:"+r),e.live){var o=n.details;o&&e.fragments.length>0?(d.a(o,e),a=e.fragments[0].start,e.PTSKnown?p.b.log("live audio playlist sliding:"+a.toFixed(3)):p.b.log("live audio playlist - outdated PTS, unknown sliding")):(e.PTSKnown=!1,p.b.log("live audio playlist - first load, unknown sliding"))}else e.PTSKnown=!1;if(n.details=e,!this.startFragRequested){if(-1===this.startPosition){var s=e.startTimeOffset;isNaN(s)?this.startPosition=0:(p.b.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s)}this.nextLoadPosition=this.startPosition}this.state===m.WAITING_TRACK&&(this.state=m.IDLE),this.tick()},e.prototype.onKeyLoaded=function(){this.state===m.KEY_LOADING&&(this.state=m.IDLE,this.tick())},e.prototype.onFragLoaded=function(t){var e=this.fragCurrent,i=t.frag;if(this.state===m.FRAG_LOADING&&e&&"audio"===i.type&&i.level===e.level&&i.sn===e.sn){var n=this.tracks[this.trackId],r=n.details,a=r.totalduration,o=e.level,s=e.sn,d=e.cc,c=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",h=this.stats=t.stats;if("initSegment"===s)this.state=m.IDLE,h.tparsed=h.tbuffered=performance.now(),r.initSegment.data=t.payload,this.hls.trigger(u.a.FRAG_BUFFERED,{stats:h,frag:e,id:"audio"}),this.tick();else{this.state=m.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new l.a(this.hls,"audio"));var f=this.initPTS[d],y=r.initSegment?r.initSegment.data:[];r.initSegment||void 0!==f?(this.pendingBuffering=!0,p.b.log("Demuxing "+s+" of ["+r.startSN+" ,"+r.endSN+"],track "+o),this.demuxer.push(t.payload,y,c,null,e,a,!1,f)):(p.b.log("unknown video PTS for continuity counter "+d+", waiting for video PTS before demuxing audio frag "+s+" of ["+r.startSN+" ,"+r.endSN+"],track "+o),this.waitingFragment=t,this.state=m.WAITING_INIT_PTS)}}this.fragLoadError=0},e.prototype.onFragParsingInitSegment=function(t){var e=this.fragCurrent,i=t.frag;if(e&&"audio"===t.id&&i.sn===e.sn&&i.level===e.level&&this.state===m.PARSING){var n=t.tracks,r=void 0;if(n.video&&delete n.video,r=n.audio){r.levelCodec=r.codec,r.id=t.id,this.hls.trigger(u.a.BUFFER_CODECS,n),p.b.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var a=r.initSegment;if(a){var o={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[o]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.a.BUFFER_APPENDING,o))}this.tick()}}},e.prototype.onFragParsingData=function(t){var e=this,i=this.fragCurrent,n=t.frag;if(i&&"audio"===t.id&&"audio"===t.type&&n.sn===i.sn&&n.level===i.level&&this.state===m.PARSING){var r=this.trackId,a=this.tracks[r],o=this.hls;isNaN(t.endPTS)&&(t.endPTS=t.startPTS+i.duration,t.endDTS=t.startDTS+i.duration),p.b.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),d.b(a.details,i,t.startPTS,t.endPTS);var s=this.audioSwitch,l=this.media,c=!1;if(s&&l)if(l.readyState){var f=l.currentTime;p.b.log("switching audio track : currentTime:"+f),f>=t.startPTS&&(p.b.log("switching audio track : flushing all audio"),this.state=m.BUFFER_FLUSHING,o.trigger(u.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),c=!0,this.audioSwitch=!1,o.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:r}))}else this.audioSwitch=!1,o.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:r});var y=this.pendingData;if(!y)return console.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void o.trigger(u.a.ERROR,{type:h.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&y.push({type:t.type,data:e,parent:"audio",content:"data"})}),!c&&y.length&&(y.forEach(function(t){e.state===m.PARSING&&(e.pendingBuffering=!0,e.hls.trigger(u.a.BUFFER_APPENDING,t))}),this.pendingData=[],this.appended=!0)),this.tick()}},e.prototype.onFragParsed=function(t){var e=this.fragCurrent,i=t.frag;e&&"audio"===t.id&&i.sn===e.sn&&i.level===e.level&&this.state===m.PARSING&&(this.stats.tparsed=performance.now(),this.state=m.PARSED,this._checkAppendedParsed())},e.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},e.prototype.onBufferCreated=function(t){var e=t.tracks.audio;e&&(this.mediaBuffer=e.buffer,this.loadedmetadata=!0),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)},e.prototype.onBufferAppended=function(t){if("audio"===t.parent){var e=this.state;e!==m.PARSING&&e!==m.PARSED||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},e.prototype._checkAppendedParsed=function(){if(!(this.state!==m.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent,e=this.stats,i=this.hls;if(t){this.fragPrevious=t,e.tbuffered=performance.now(),i.trigger(u.a.FRAG_BUFFERED,{stats:e,frag:t,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;p.b.log("audio buffered : "+c.a.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=m.IDLE}this.tick()}},e.prototype.onError=function(t){var e=t.frag;if(!e||"audio"===e.type)switch(t.details){case h.a.FRAG_LOAD_ERROR:case h.a.FRAG_LOAD_TIMEOUT:if(!t.fatal){var i=this.fragLoadError;i?i++:i=1;var n=this.config;if(i<=n.fragLoadingMaxRetry){this.fragLoadError=i,e.loadCounter=0;var r=Math.min(Math.pow(2,i-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);p.b.warn("audioStreamController: frag loading failed, retry in "+r+" ms"),this.retryDate=performance.now()+r,this.state=m.FRAG_LOADING_WAITING_RETRY}else p.b.error("audioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=m.ERROR}break;case h.a.FRAG_LOOP_LOADING_ERROR:case h.a.AUDIO_TRACK_LOAD_ERROR:case h.a.AUDIO_TRACK_LOAD_TIMEOUT:case h.a.KEY_LOAD_ERROR:case h.a.KEY_LOAD_TIMEOUT:this.state!==m.ERROR&&(this.state=t.fatal?m.ERROR:m.IDLE,p.b.warn("audioStreamController: "+t.details+" while loading frag,switch to "+this.state+" state ..."));break;case h.a.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===m.PARSING||this.state===m.PARSED)){var a=this.mediaBuffer,o=this.media.currentTime;if(a&&s.a.isBuffered(a,o)&&s.a.isBuffered(a,o+.5)){var l=this.config;l.maxMaxBufferLength>=l.maxBufferLength&&(l.maxMaxBufferLength/=2,p.b.warn("audio:reduce max buffer length to "+l.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*l.fragLoadingLoopThreshold),this.state=m.IDLE}else p.b.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=m.BUFFER_FLUSHING,this.hls.trigger(u.a.BUFFER_FLUSHING,{startOffset:0,
endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},e.prototype.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(p.b.log("appending pending audio data on Buffer Flushed"),e.forEach(function(e){t.hls.trigger(u.a.BUFFER_APPENDING,e)}),this.appended=!0,this.pendingData=[],this.state=m.PARSED):(this.state=m.IDLE,this.fragPrevious=null,this.tick())},v(e,[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,p.b.log("audio stream:"+e+"->"+t)}},get:function(){return this._state}}]),e}(y.a);e.a=g},function(t,e,i){"use strict";function n(t,e,i,n){for(var a,o,s,l,u,d=window.VTTCue||window.TextTrackCue,c=0;c<n.rows.length;c++)if(a=n.rows[c],s=!0,l=0,u="",!a.isEmpty()){for(var h=0;h<a.chars.length;h++)a.chars[h].uchar.match(/\s/)&&s?l++:(u+=a.chars[h].uchar,s=!1);a.cueStartTime=e,e===i&&(i+=1e-4),o=new d(e,i,Object(r.b)(u.trim())),l>=16?l--:l++,navigator.userAgent.match(/Firefox\//)?o.line=c+1:o.line=c>7?c-2:c+1,o.align="left",o.position=Math.max(0,Math.min(100,l/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),t.addCue(o)}}Object.defineProperty(e,"__esModule",{value:!0}),e.newCue=n;var r=i(22)},function(t,e,i){"use strict";e.a=function(){function t(t){return"string"==typeof t&&!!a[t.toLowerCase()]&&t.toLowerCase()}function e(t){return"string"==typeof t&&!!o[t.toLowerCase()]&&t.toLowerCase()}function i(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function n(n,a,o){var s=this,l=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),u={};l?s=document.createElement("custom"):u.enumerable=!0,s.hasBeenReset=!1;var d="",c=!1,h=n,p=a,f=o,y=null,v="",m=!0,g="auto",b="start",E=50,T="middle",w=50,S="middle";if(Object.defineProperty(s,"id",i({},u,{get:function(){return d},set:function(t){d=""+t}})),Object.defineProperty(s,"pauseOnExit",i({},u,{get:function(){return c},set:function(t){c=!!t}})),Object.defineProperty(s,"startTime",i({},u,{get:function(){return h},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");h=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",i({},u,{get:function(){return p},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",i({},u,{get:function(){return f},set:function(t){f=""+t,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",i({},u,{get:function(){return y},set:function(t){y=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",i({},u,{get:function(){return v},set:function(e){var i=t(e);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");v=i,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",i({},u,{get:function(){return m},set:function(t){m=!!t,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",i({},u,{get:function(){return g},set:function(t){if("number"!=typeof t&&t!==r)throw new SyntaxError("An invalid number or illegal string was specified.");g=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",i({},u,{get:function(){return b},set:function(t){var i=e(t);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");b=i,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",i({},u,{get:function(){return E},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");E=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",i({},u,{get:function(){return T},set:function(t){var i=e(t);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");T=i,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",i({},u,{get:function(){return w},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");w=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",i({},u,{get:function(){return S},set:function(t){var i=e(t);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");S=i,this.hasBeenReset=!0}})),s.displayState=void 0,l)return s}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var r="auto",a={"":!0,lr:!0,rl:!0},o={start:!0,middle:!0,end:!0,left:!0,right:!0};return n.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},n}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t){if(t&&t.cues)for(;t.cues.length>0;)t.removeCue(t.cues[0])}function s(t,e){return t&&t.label===e.name&&!(t.textTrack1||t.textTrack2)}function l(t,e,i,n){return Math.min(e,n)-Math.max(t,i)}var u=i(1),d=i(3),c=i(61),h=i(62),p=i(63),f=i(0),y=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,u.a.MEDIA_ATTACHING,u.a.MEDIA_DETACHING,u.a.FRAG_PARSING_USERDATA,u.a.FRAG_DECRYPTED,u.a.MANIFEST_LOADING,u.a.MANIFEST_LOADED,u.a.FRAG_LOADED,u.a.LEVEL_SWITCHING,u.a.INIT_PTS_FOUND));if(a.hls=i,a.config=i.config,a.enabled=!0,a.Cues=i.config.cueHandler,a.textTracks=[],a.tracks=[],a.unparsedVttFrags=[],a.initPTS=void 0,a.cueRanges=[],a.config.enableCEA708Captions){var o=new h.a(a,1),s=new h.a(a,2);a.cea608Parser=new c.a(0,o,s)}return a}return a(e,t),e.prototype.addCues=function(t,e,i,n){for(var r=this.cueRanges,a=!1,o=r.length;o--;){var s=r[o],u=l(s[0],s[1],e,i);if(u>=0&&(s[0]=Math.min(s[0],e),s[1]=Math.max(s[1],i),a=!0,u/(i-e)>.5))return}a||r.push([e,i]),this.Cues.newCue(this[t],e,i,n)},e.prototype.onInitPtsFound=function(t){var e=this;void 0===this.initPTS&&(this.initPTS=t.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(t){e.onFragLoaded(t)}),this.unparsedVttFrags=[])},e.prototype.getExistingTrack=function(t){var e=this.media;if(e)for(var i=0;i<e.textTracks.length;i++){var n=e.textTracks[i],r="textTrack"+t;if(!0===n[r])return n}return null},e.prototype.sendAddTrackEvent=function(t,e){var i=null;try{i=new window.Event("addtrack")}catch(t){i=document.createEvent("Event"),i.initEvent("addtrack",!1,!1)}i.track=t,e.dispatchEvent(i)},e.prototype.createCaptionsTrack=function(t){var e="textTrack"+t;if(!this[e]){var i=this.getExistingTrack(t);if(i)this[e]=i,o(this[e]),this.sendAddTrackEvent(this[e],this.media);else{var n=this.createTextTrack("captions",this.config["captionsTextTrack"+t+"Label"],this.config.captionsTextTrack1LanguageCode);n&&(n[e]=!0,this[e]=n)}}},e.prototype.createTextTrack=function(t,e,i){var n=this.media;if(n)return n.addTextTrack(t,e,i)},e.prototype.destroy=function(){d.a.prototype.destroy.call(this)},e.prototype.onMediaAttaching=function(t){this.media=t.media,this._cleanTracks()},e.prototype.onMediaDetaching=function(){o(this.textTrack1),o(this.textTrack2)},e.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0},this._cleanTracks()},e.prototype._cleanTracks=function(){var t=this.media;if(t){var e=t.textTracks;if(e)for(var i=0;i<e.length;i++)o(e[i])}},e.prototype.onManifestLoaded=function(t){var e=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=t.subtitles||[];var i=this.media?this.media.textTracks:[];this.tracks.forEach(function(t,n){var r=void 0;if(n<i.length){var a=i[n];s(a,t)&&(r=a)}r||(r=e.createTextTrack("subtitles",t.name,t.lang)),r.mode=t.default?"showing":"hidden",e.textTracks.push(r)})}},e.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},e.prototype.onFragLoaded=function(t){var e=t.frag,i=t.payload;if("main"===e.type){var n=e.sn;if(n!==this.lastSn+1){var r=this.cea608Parser;r&&r.reset()}this.lastSn=n}else if("subtitle"===e.type)if(i.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(t);var a=e.decryptdata;null!=a&&null!=a.key&&"AES-128"===a.method||this._parseVTTs(e,i)}else this.hls.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})},e.prototype._parseVTTs=function(t,e){var i=this.vttCCs;i[t.cc]||(i[t.cc]={start:t.start,prevCC:this.prevCC,new:!0},this.prevCC=t.cc);var n=this.textTracks,r=this.hls;p.a.parse(e,this.initPTS,i,t.cc,function(e){var i=n[t.trackId];e.forEach(function(t){if(!i.cues.getCueById(t.id))try{i.addCue(t)}catch(n){var e=new window.TextTrackCue(t.startTime,t.endTime,t.text);e.id=t.id,i.addCue(e)}}),r.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(e){f.b.log("Failed to parse VTT cue: "+e),r.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})},e.prototype.onFragDecrypted=function(t){var e=t.payload,i=t.frag;if("subtitle"===i.type){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(t);this._parseVTTs(i,e)}},e.prototype.onFragParsingUserdata=function(t){if(this.enabled&&this.config.enableCEA708Captions)for(var e=0;e<t.samples.length;e++){var i=this.extractCea608Data(t.samples[e].bytes);this.cea608Parser.addData(t.samples[e].pts,i)}},e.prototype.extractCea608Data=function(t){for(var e,i,n,r,a,o=31&t[0],s=2,l=[],u=0;u<o;u++)e=t[s++],i=127&t[s++],n=127&t[s++],r=0!=(4&e),a=3&e,0===i&&0===n||r&&0===a&&(l.push(i),l.push(n));return l},e}(d.a);e.a=y},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},a=function(t){var e=t;return r.hasOwnProperty(t)&&(e=r[t]),String.fromCharCode(e)},o=15,s=100,l={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},c={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],p={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(t){this.time=t},log:function(t,e){var i=this.verboseFilter[t];this.verboseLevel>=i&&console.log(this.time+" ["+t+"] "+e)}},f=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].toString(16));return e},y=function(){function t(e,i,r,a,o){n(this,t),this.foreground=e||"white",this.underline=i||!1,this.italics=r||!1,this.background=a||"black",this.flash=o||!1}return t.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.prototype.setStyles=function(t){for(var e=["foreground","underline","italics","background","flash"],i=0;i<e.length;i++){var n=e[i];t.hasOwnProperty(n)&&(this[n]=t[n])}},t.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.prototype.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},t.prototype.copy=function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},t.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},t}(),v=function(){function t(e,i,r,a,o,s){n(this,t),this.uchar=e||" ",this.penState=new y(i,r,a,o,s)}return t.prototype.reset=function(){this.uchar=" ",this.penState.reset()},t.prototype.setChar=function(t,e){this.uchar=t,this.penState.copy(e)},t.prototype.setPenState=function(t){this.penState.copy(t)},t.prototype.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},t.prototype.copy=function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},t.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},t}(),m=function(){function t(){n(this,t),this.chars=[];for(var e=0;e<s;e++)this.chars.push(new v);this.pos=0,this.currPenState=new y}return t.prototype.equals=function(t){for(var e=!0,i=0;i<s;i++)if(!this.chars[i].equals(t.chars[i])){e=!1;break}return e},t.prototype.copy=function(t){for(var e=0;e<s;e++)this.chars[e].copy(t.chars[e])},t.prototype.isEmpty=function(){for(var t=!0,e=0;e<s;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t},t.prototype.setCursor=function(t){this.pos!==t&&(this.pos=t),this.pos<0?(p.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>s&&(p.log("ERROR","Too large cursor position "+this.pos),this.pos=s)},t.prototype.moveCursor=function(t){var e=this.pos+t;if(t>1)for(var i=this.pos+1;i<e+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(e)},t.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.prototype.insertChar=function(t){t>=144&&this.backSpace();var e=a(t);if(this.pos>=s)return void p.log("ERROR","Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!");this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1)},t.prototype.clearFromPos=function(t){var e;for(e=t;e<s;e++)this.chars[e].reset()},t.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.prototype.getTextString=function(){for(var t=[],e=!0,i=0;i<s;i++){var n=this.chars[i].uchar;" "!==n&&(e=!1),t.push(n)}return e?"":t.join("")},t.prototype.setPenStyles=function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)},t}(),g=function(){function t(){n(this,t),this.rows=[];for(var e=0;e<o;e++)this.rows.push(new m);this.currRow=o-1,this.nrRollUpRows=null,this.reset()}return t.prototype.reset=function(){for(var t=0;t<o;t++)this.rows[t].clear();this.currRow=o-1},t.prototype.equals=function(t){for(var e=!0,i=0;i<o;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e},t.prototype.copy=function(t){for(var e=0;e<o;e++)this.rows[e].copy(t.rows[e])},t.prototype.isEmpty=function(){for(var t=!0,e=0;e<o;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t},t.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},t.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.prototype.insertChar=function(t){this.rows[this.currRow].insertChar(t)},t.prototype.setPen=function(t){this.rows[this.currRow].setPenStyles(t)},t.prototype.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)},t.prototype.setCursor=function(t){p.log("INFO","setCursor: "+t),this.rows[this.currRow].setCursor(t)},t.prototype.setPAC=function(t){p.log("INFO","pacData = "+JSON.stringify(t));var e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(var i=0;i<o;i++)this.rows[i].clear();var n=this.currRow+1-this.nrRollUpRows,r=this.lastOutputScreen;if(r){var a=r.rows[n].cueStartTime;if(a&&a<p.time)for(var s=0;s<this.nrRollUpRows;s++)this.rows[e-this.nrRollUpRows+s+1].copy(r.rows[n+s])}}this.currRow=e;var l=this.rows[this.currRow];if(null!==t.indent){var u=t.indent,d=Math.max(u-1,0);l.setCursor(t.indent),t.color=l.chars[d].penState.foreground}var c={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(c)},t.prototype.setBkgData=function(t){p.log("INFO","bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},t.prototype.setRollUpRows=function(t){this.nrRollUpRows=t},t.prototype.rollUp=function(){if(null===this.nrRollUpRows)return void p.log("DEBUG","roll_up but nrRollUpRows not set yet");p.log("TEXT",this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),p.log("INFO","Rolling up")},t.prototype.getDisplayText=function(t){t=t||!1;for(var e=[],i="",n=-1,r=0;r<o;r++){var a=this.rows[r].getTextString();a&&(n=r+1,t?e.push("Row "+n+": '"+a+"'"):e.push(a.trim()))}return e.length>0&&(i=t?"["+e.join(" | ")+"]":e.join("\n")),i},t.prototype.getTextAndFormat=function(){return this.rows},t}(),b=function(){function t(e,i){n(this,t),this.chNr=e,this.outputFilter=i,this.mode=null,this.verbose=0,this.displayedMemory=new g,this.nonDisplayedMemory=new g,this.lastOutputScreen=new g,this.currRollUpRow=this.displayedMemory.rows[o-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return t.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[o-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},t.prototype.getHandler=function(){return this.outputFilter},t.prototype.setHandler=function(t){this.outputFilter=t},t.prototype.setPAC=function(t){this.writeScreen.setPAC(t)},t.prototype.setBkgData=function(t){this.writeScreen.setBkgData(t)},t.prototype.setMode=function(t){t!==this.mode&&(this.mode=t,p.log("INFO","MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},t.prototype.insertChars=function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";p.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(p.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.prototype.ccRCL=function(){p.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.prototype.ccBS=function(){p.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.prototype.ccAOF=function(){},t.prototype.ccAON=function(){},t.prototype.ccDER=function(){p.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.prototype.ccRU=function(t){p.log("INFO","RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},t.prototype.ccFON=function(){p.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.prototype.ccRDC=function(){p.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.prototype.ccTR=function(){p.log("INFO","TR"),this.setMode("MODE_TEXT")},t.prototype.ccRTD=function(){p.log("INFO","RTD"),this.setMode("MODE_TEXT")},t.prototype.ccEDM=function(){p.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.prototype.ccCR=function(){p.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.prototype.ccENM=function(){p.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.prototype.ccEOC=function(){if(p.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,p.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.prototype.ccTO=function(t){p.log("INFO","TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},t.prototype.ccMIDROW=function(t){var e={flash:!1};if(e.underline=t%2==1,e.italics=t>=46,e.italics)e.foreground="white";else{var i=Math.floor(t/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=n[i]}p.log("INFO","MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},t.prototype.outputDataUpdate=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=p.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),!0===t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},t.prototype.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},t}(),E=function(){function t(e,i,r){n(this,t),this.field=e||1,this.outputs=[i,r],this.channels=[new b(1,i),new b(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return t.prototype.getHandler=function(t){return this.channels[t].getHandler()},t.prototype.setHandler=function(t,e){this.channels[t].setHandler(e)},t.prototype.addData=function(t,e){var i,n,r,a=!1;this.lastTime=t,p.setTime(t);for(var o=0;o<e.length;o+=2)if(n=127&e[o],r=127&e[o+1],0!==n||0!==r){if(p.log("DATA","["+f([e[o],e[o+1]])+"] -> ("+f([n,r])+")"),i=this.parseCmd(n,r),i||(i=this.parseMidrow(n,r)),i||(i=this.parsePAC(n,r)),i||(i=this.parseBackgroundAttributes(n,r)),!i&&(a=this.parseChars(n,r)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(a)}else p.log("WARNING","No channel found yet. TEXT-MODE?");i?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,p.log("WARNING","Couldn't parse cleaned data "+f([n,r])+" orig: "+f([e[o],e[o+1]])))}else this.dataCounters.padding+=2},t.prototype.parseCmd=function(t,e){var i=null,n=(20===t||28===t)&&32<=e&&e<=47,r=(23===t||31===t)&&33<=e&&e<=35;if(!n&&!r)return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,p.log("DEBUG","Repeated command ("+f([t,e])+") is dropped"),!0;i=20===t||23===t?1:2;var a=this.channels[i-1];return 20===t||28===t?32===e?a.ccRCL():33===e?a.ccBS():34===e?a.ccAOF():35===e?a.ccAON():36===e?a.ccDER():37===e?a.ccRU(2):38===e?a.ccRU(3):39===e?a.ccRU(4):40===e?a.ccFON():41===e?a.ccRDC():42===e?a.ccTR():43===e?a.ccRTD():44===e?a.ccEDM():45===e?a.ccCR():46===e?a.ccENM():47===e&&a.ccEOC():a.ccTO(e-32),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=i,!0},t.prototype.parseMidrow=function(t,e){var i=null;return(17===t||25===t)&&32<=e&&e<=47&&((i=17===t?1:2)!==this.currChNr?(p.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[i-1].ccMIDROW(e),p.log("DEBUG","MIDROW ("+f([t,e])+")"),!0))},t.prototype.parsePAC=function(t,e){var i=null,n=null,r=(17<=t&&t<=23||25<=t&&t<=31)&&64<=e&&e<=127,a=(16===t||24===t)&&64<=e&&e<=95;if(!r&&!a)return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;i=t<=23?1:2,n=64<=e&&e<=95?1===i?l[t]:d[t]:1===i?u[t]:c[t];var o=this.interpretPAC(n,e);return this.channels[i-1].setPAC(o),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=i,!0},t.prototype.interpretPAC=function(t,e){var i=e,n={color:null,italics:!1,indent:null,underline:!1,row:t};return i=e>95?e-96:e-64,n.underline=1==(1&i),i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((i-16)/2),n},t.prototype.parseChars=function(t,e){var i=null,n=null,r=null;if(t>=25?(i=2,r=t-8):(i=1,r=t),17<=r&&r<=19){var o=e;o=17===r?e+80:18===r?e+112:e+144,p.log("INFO","Special char '"+a(o)+"' in channel "+i),n=[o]}else 32<=t&&t<=127&&(n=0===e?[t]:[t,e]);if(n){var s=f(n);p.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n},t.prototype.parseBackgroundAttributes=function(t,e){var i,n,r,a,o=(16===t||24===t)&&32<=e&&e<=47,s=(23===t||31===t)&&45<=e&&e<=47;return!(!o&&!s||(i={},16===t||24===t?(n=Math.floor((e-32)/2),i.background=h[n],e%2==1&&(i.background=i.background+"_semi")):45===e?i.background="transparent":(i.foreground="black",47===e&&(i.underline=!0)),r=t<24?1:2,a=this.channels[r-1],a.setBkgData(i),this.lastCmdA=null,this.lastCmdB=null,0))},t.prototype.reset=function(){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].reset();this.lastCmdA=null,this.lastCmdB=null},t.prototype.cueSplitAtTime=function(t){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].cueSplitAtTime(t)},t}();e.a=E},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e,i){n(this,t),this.timelineController=e,this.track=i,this.startTime=null,this.endTime=null,this.screen=null}return t.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues("textTrack"+this.track,this.startTime,this.endTime,this.screen),this.startTime=null)},t.prototype.newCue=function(t,e,i){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=i,this.timelineController.createCaptionsTrack(this.track)},t}();e.a=r},function(t,e,i){"use strict";var n=i(22),r=i(5),a=function(t,e,i){return t.substr(i||0,e.length)===e},o=function(t){var e=parseInt(t.substr(-3)),i=parseInt(t.substr(-6,2)),n=parseInt(t.substr(-9,2)),r=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;return isNaN(e)||isNaN(i)||isNaN(n)||isNaN(r)?-1:(e+=1e3*i,e+=6e4*n,e+=36e5*r)},s=function(t){for(var e=5381,i=t.length;i;)e=33*e^t.charCodeAt(--i);return(e>>>0).toString()},l=function(t,e,i){var n=t[e],r=t[n.prevCC];if(!r||!r.new&&n.new)return t.ccOffset=t.presentationOffset=n.start,void(n.new=!1);for(;r&&r.new;)t.ccOffset+=n.start-r.start,n.new=!1,n=r,r=t[n.prevCC];t.presentationOffset=i},u={parse:function(t,e,i,u,d,c){var h=/\r\n|\n\r|\n|\r/g,p=Object(r.b)(new Uint8Array(t)).trim().replace(h,"\n").split("\n"),f="00:00.000",y=0,v=0,m=0,g=[],b=void 0,E=!0,T=new n.a;T.oncue=function(t){var e=i[u],n=i.ccOffset;e&&e.new&&(void 0!==v?n=i.ccOffset=e.start:l(i,u,m)),m&&(n=m+i.ccOffset-i.presentationOffset),t.startTime+=n-v,t.endTime+=n-v,t.id=s(t.startTime.toString())+s(t.endTime.toString())+s(t.text),t.text=decodeURIComponent(encodeURIComponent(t.text)),t.endTime>0&&g.push(t)},T.onparsingerror=function(t){b=t},T.onflush=function(){if(b&&c)return void c(b);d(g)},p.forEach(function(t){if(E){if(a(t,"X-TIMESTAMP-MAP=")){E=!1,t.substr(16).split(",").forEach(function(t){a(t,"LOCAL:")?f=t.substr(6):a(t,"MPEGTS:")&&(y=parseInt(t.substr(7)))});try{e=e<0?e+8589934592:e,y-=e,v=o(f)/1e3,m=y/9e4,-1===v&&(b=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(e){b=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(E=!1)}T.parse(t+"\n")}),T.flush()}};e.a=u},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t){for(var e=[],i=0;i<t.length;i++)"subtitles"===t[i].kind&&e.push(t[i]);return e}var s=i(1),l=i(3),u=i(0),d=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,s.a.MEDIA_ATTACHED,s.a.MEDIA_DETACHING,s.a.MANIFEST_LOADING,s.a.MANIFEST_LOADED,s.a.SUBTITLE_TRACK_LOADED));return a.tracks=[],a.trackId=-1,a.media=void 0,a.subtitleDisplay=!1,a}return a(e,t),e.prototype._onTextTracksChanged=function(){if(this.media){for(var t=-1,e=o(this.media.textTracks),i=0;i<e.length;i++)"showing"===e[i].mode&&(t=i);this.subtitleTrack=t}},e.prototype.destroy=function(){l.a.prototype.destroy.call(this)},e.prototype.onMediaAttached=function(t){var e=this;this.media=t.media,this.media&&(void 0!==this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){e.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},e.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)},e.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},e.prototype.onManifestLoaded=function(t){var e=this,i=t.subtitles||[];this.tracks=i,this.trackId=-1,this.hls.trigger(s.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i}),i.forEach(function(t){t.default&&(e.media?e.subtitleTrack=t.id:e.queuedDefaultTrack=t.id)})},e.prototype.onTick=function(){var t=this.trackId,e=this.tracks[t];if(e){var i=e.details;void 0!==i&&!0!==i.live||(u.b.log("(re)loading playlist for subtitle track "+t),this.hls.trigger(s.a.SUBTITLE_TRACK_LOADING,{url:e.url,id:t}))}},e.prototype.onSubtitleTrackLoaded=function(t){var e=this;t.id<this.tracks.length&&(u.b.log("subtitle track "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.timer&&(this.timer=setInterval(function(){e.onTick()},1e3*t.details.targetduration,this)),!t.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))},e.prototype.setSubtitleTrackInternal=function(t){if(!(t<-1||t>=this.tracks.length)){this.timer&&(clearInterval(this.timer),this.timer=null);var e=o(this.media.textTracks);if(-1!==this.trackId&&this.subtitleDisplay&&(e[this.trackId].mode="hidden"),this.trackId=t,u.b.log("switching to subtitle track "+t),this.hls.trigger(s.a.SUBTITLE_TRACK_SWITCH,{id:t}),-1!==t){var i=this.tracks[t];this.subtitleDisplay&&(e[t].mode="showing");var n=i.details;void 0!==n&&!0!==n.live||(u.b.log("(re)loading playlist for subtitle track "+t),this.hls.trigger(s.a.SUBTITLE_TRACK_LOADING,{url:i.url,id:t}))}}},d(e,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.trackId!==t&&this.setSubtitleTrackInternal(t)}}]),e}(l.a);e.a=c},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),
e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(1),s=i(0),l=i(8),u=i(11),d={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING"},c=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,o.a.MEDIA_ATTACHED,o.a.ERROR,o.a.KEY_LOADED,o.a.FRAG_LOADED,o.a.SUBTITLE_TRACKS_UPDATED,o.a.SUBTITLE_TRACK_SWITCH,o.a.SUBTITLE_TRACK_LOADED,o.a.SUBTITLE_FRAG_PROCESSED));return a.config=i.config,a.vttFragSNsProcessed={},a.vttFragQueues=void 0,a.currentlyProcessing=null,a.state=d.STOPPED,a.currentTrackId=-1,a.decrypter=new l.a(i.observer,i.config),a}return a(e,t),e.prototype.onHandlerDestroyed=function(){this.state=d.STOPPED},e.prototype.clearVttFragQueues=function(){var t=this;this.vttFragQueues={},this.tracks.forEach(function(e){t.vttFragQueues[e.id]=[]})},e.prototype.nextFrag=function(){if(null===this.currentlyProcessing&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var t=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.fragCurrent=t,this.hls.trigger(o.a.FRAG_LOADING,{frag:t}),this.state=d.FRAG_LOADING}},e.prototype.onSubtitleFragProcessed=function(t){t.success&&this.vttFragSNsProcessed[t.frag.trackId].push(t.frag.sn),this.currentlyProcessing=null,this.state=d.IDLE,this.nextFrag()},e.prototype.onMediaAttached=function(){this.state=d.IDLE},e.prototype.onError=function(t){var e=t.frag;e&&"subtitle"!==e.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())},e.prototype.doTick=function(){var t=this;switch(this.state){case d.IDLE:var e=this.tracks,i=this.currentTrackId,n=this.vttFragSNsProcessed[i],r=this.vttFragQueues[i],a=this.currentlyProcessing?this.currentlyProcessing.sn:-1,l=function(t){return n.indexOf(t.sn)>-1},u=function(t){return r.some(function(e){return e.sn===t.sn})};if(!e)break;var c;if(i<e.length&&(c=e[i].details),void 0===c)break;c.fragments.forEach(function(e){l(e)||e.sn===a||u(e)||(e.decryptdata&&null!=e.decryptdata.uri&&null==e.decryptdata.key?(s.b.log("Loading key for "+e.sn),t.state=d.KEY_LOADING,t.hls.trigger(o.a.KEY_LOADING,{frag:e})):(e.trackId=i,r.push(e),t.nextFrag()))})}},e.prototype.onSubtitleTracksUpdated=function(t){var e=this;s.b.log("subtitle tracks updated"),this.tracks=t.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(t){e.vttFragSNsProcessed[t.id]=[]})},e.prototype.onSubtitleTrackSwitch=function(t){this.currentTrackId=t.id,this.clearVttFragQueues()},e.prototype.onSubtitleTrackLoaded=function(){this.tick()},e.prototype.onKeyLoaded=function(){this.state===d.KEY_LOADING&&(this.state=d.IDLE,this.tick())},e.prototype.onFragLoaded=function(t){var e=this.fragCurrent,i=t.frag.decryptdata,n=t.frag,r=this.hls;if(this.state===d.FRAG_LOADING&&e&&"subtitle"===t.frag.type&&e.sn===t.frag.sn&&t.payload.byteLength>0&&null!=i&&null!=i.key&&"AES-128"===i.method){var a;try{a=performance.now()}catch(t){a=Date.now()}this.decrypter.decrypt(t.payload,i.key.buffer,i.iv.buffer,function(t){var e;try{e=performance.now()}catch(t){e=Date.now()}r.trigger(o.a.FRAG_DECRYPTED,{frag:n,payload:t,stats:{tstart:a,tdecrypt:e}})})}},e}(u.a);e.a=c},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=i(3),s=i(1),l=i(2),u=i(0),d=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready"},h=function(t,e,i){var n={videoCapabilities:[]};return e.forEach(function(t){n.videoCapabilities.push({contentType:'video/mp4; codecs="'+t+'"'})}),[n]},p=function(t,e,i){switch(t){case c.WIDEVINE:return h(0,i);default:throw Error("Unknown key-system: "+t)}},f=function(t){function e(i){n(this,e);var a=r(this,t.call(this,i,s.a.MEDIA_ATTACHED,s.a.MANIFEST_PARSED));return a._widevineLicenseUrl=i.config.widevineLicenseUrl,a._licenseXhrSetup=i.config.licenseXhrSetup,a._emeEnabled=i.config.emeEnabled,a._requestMediaKeySystemAccess=i.config.requestMediaKeySystemAccessFunc,a._mediaKeysList=[],a._media=null,a._hasSetMediaKeys=!1,a._isMediaEncrypted=!1,a._requestLicenseFailureCount=0,a}return a(e,t),e.prototype.getLicenseServerUrl=function(t){var e=void 0;switch(t){case c.WIDEVINE:e=this._widevineLicenseUrl;break;default:e=null}return e||(u.b.error('No license server URL configured for key-system "'+t+'"'),this.hls.trigger(s.a.ERROR,{type:l.b.KEY_SYSTEM_ERROR,details:l.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),e},e.prototype._attemptKeySystemAccess=function(t,e,i){var n=this,r=p(t,0,i);if(!r)return void u.b.warn("Can not create config for key-system (maybe because platform is not supported):",t);u.b.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(t,r).then(function(e){n._onMediaKeySystemAccessObtained(t,e)}).catch(function(e){u.b.error('Failed to obtain key-system "'+t+'" access:',e)})},e.prototype._onMediaKeySystemAccessObtained=function(t,e){var i=this;u.b.log('Access for key-system "'+t+'" obtained');var n={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(n),e.createMediaKeys().then(function(e){n.mediaKeys=e,u.b.log('Media-keys created for key-system "'+t+'"'),i._onMediaKeysCreated()}).catch(function(t){u.b.error("Failed to create media-keys:",t)})},e.prototype._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))})},e.prototype._onNewMediaKeySession=function(t){var e=this;u.b.log("New key-system session "+t.sessionId),t.addEventListener("message",function(i){e._onKeySessionMessage(t,i.message)},!1)},e.prototype._onKeySessionMessage=function(t,e){u.b.log("Got EME message event, creating license request"),this._requestLicense(e,function(e){u.b.log("Received license data, updating key-session"),t.update(e)})},e.prototype._onMediaEncrypted=function(t,e){u.b.log('Media is encrypted using "'+t+'" init data type'),this._isMediaEncrypted=!0,this._mediaEncryptionInitDataType=t,this._mediaEncryptionInitData=e,this._attemptSetMediaKeys(),this._generateRequestWithPreferredKeySession()},e.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys)return u.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(s.a.ERROR,{type:l.b.KEY_SYSTEM_ERROR,details:l.a.KEY_SYSTEM_NO_KEYS,fatal:!0});u.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},e.prototype._generateRequestWithPreferredKeySession=function(){var t=this,e=this._mediaKeysList[0];if(!e)return u.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(s.a.ERROR,{type:l.b.KEY_SYSTEM_ERROR,details:l.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(e.mediaKeysSessionInitialized)return void u.b.warn("Key-Session already initialized but requested again");var i=e.mediaKeysSession;i||(u.b.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(s.a.ERROR,{type:l.b.KEY_SYSTEM_ERROR,details:l.a.KEY_SYSTEM_NO_SESSION,fatal:!0}));var n=this._mediaEncryptionInitDataType,r=this._mediaEncryptionInitData;u.b.log('Generating key-session request for "'+n+'" init data type'),e.mediaKeysSessionInitialized=!0,i.generateRequest(n,r).then(function(){u.b.debug("Key-session generation succeeded")}).catch(function(e){u.b.error("Error generating key-session request:",e),t.hls.trigger(s.a.ERROR,{type:l.b.KEY_SYSTEM_ERROR,details:l.a.KEY_SYSTEM_NO_SESSION,fatal:!1})})},e.prototype._createLicenseXhr=function(t,e,i){var n=new XMLHttpRequest,r=this._licenseXhrSetup;try{if(r)try{r(n,t)}catch(e){n.open("POST",t,!0),r(n,t)}n.readyState||n.open("POST",t,!0)}catch(t){return u.b.error("Error setting up key-system license XHR",t),void this.hls.trigger(s.a.ERROR,{type:l.b.KEY_SYSTEM_ERROR,details:l.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return n.responseType="arraybuffer",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,t,e,i),n},e.prototype._onLicenseRequestReadyStageChange=function(t,e,i,n){switch(t.readyState){case 4:if(200===t.status)this._requestLicenseFailureCount=0,u.b.log("License request succeeded"),n(t.response);else{if(u.b.error("License Request XHR failed ("+e+"). Status: "+t.status+" ("+t.statusText+")"),++this._requestLicenseFailureCount<=3){var r=3-this._requestLicenseFailureCount+1;return u.b.warn("Retrying license request, "+r+" attempts left"),void this._requestLicense(i,n)}this.hls.trigger(s.a.ERROR,{type:l.b.KEY_SYSTEM_ERROR,details:l.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},e.prototype._generateLicenseRequestChallenge=function(t,e){var i=void 0;return t.mediaKeySystemDomain===c.PLAYREADY?u.b.error("PlayReady is not supported (yet)"):t.mediaKeySystemDomain===c.WIDEVINE?i=e:u.b.error("Unsupported key-system:",t.mediaKeySystemDomain),i},e.prototype._requestLicense=function(t,e){u.b.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i)return u.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(s.a.ERROR,{type:l.b.KEY_SYSTEM_ERROR,details:l.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});var n=this.getLicenseServerUrl(i.mediaKeySystemDomain),r=this._createLicenseXhr(n,t,e);u.b.log("Sending license request to URL: "+n),r.send(this._generateLicenseRequestChallenge(i,t))},e.prototype.onMediaAttached=function(t){var e=this;if(this._emeEnabled){var i=t.media;this._media=i,i.addEventListener("encrypted",function(t){e._onMediaEncrypted(t.initDataType,t.initData)})}},e.prototype.onManifestParsed=function(t){if(this._emeEnabled){var e=t.levels.map(function(t){return t.audioCodec}),i=t.levels.map(function(t){return t.videoCodec});this._attemptKeySystemAccess(c.WIDEVINE,e,i)}},d(e,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),e}(o.a);e.a=f},function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=function(){return window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null}()},function(t,e){String.prototype.endsWith||function(){"use strict";var t=function(){try{var t={},e=Object.defineProperty,i=e(t,t,t)&&e}catch(t){}return i}(),e={}.toString,i=function(t){if(null==this)throw TypeError();var i=String(this);if(t&&"[object RegExp]"==e.call(t))throw TypeError();var n=i.length,r=String(t),a=r.length,o=n;if(arguments.length>1){var s=arguments[1];void 0!==s&&(o=s?Number(s):0)!=o&&(o=0)}var l=Math.min(Math.max(o,0),n),u=l-a;if(u<0)return!1;for(var d=-1;++d<a;)if(i.charCodeAt(u+d)!=r.charCodeAt(d))return!1;return!0};t?t(String.prototype,"endsWith",{value:i,configurable:!0,writable:!0}):String.prototype.endsWith=i}()}]).default}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("MPlayer",[],e):"object"==typeof exports?exports.MPlayer=e():t.MPlayer=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=6)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=/mobile/i.test(window.navigator.userAgent),r={secondToTime:function(t){var e=function(t){return t<10?"0"+t:""+t},i=Math.floor(t/3600),n=Math.floor((t-3600*i)/60),r=Math.floor(t-3600*i-60*n);return(i>0?[i,n,r]:[n,r]).map(e).join(":")},getElementViewLeft:function(t){var e=t.offsetLeft,i=t.offsetParent,n=document.body.scrollLeft+document.documentElement.scrollLeft;if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)for(;null!==i&&i!==t;)e+=i.offsetLeft,i=i.offsetParent;else for(;null!==i;)e+=i.offsetLeft,i=i.offsetParent;return e-n},getScrollPosition:function(){return{left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}},setScrollPosition:function(t){var e=t.left,i=void 0===e?0:e,n=t.top,r=void 0===n?0:n;this.isFirefox?(document.documentElement.scrollLeft=i,document.documentElement.scrollTop=r):window.scrollTo(i,r)},isMobile:n,isFirefox:/firefox/i.test(window.navigator.userAgent),isChrome:/chrome/i.test(window.navigator.userAgent),storage:{set:function(t,e){localStorage.setItem(t,e)},get:function(t){return localStorage.getItem(t)}},cumulativeOffset:function(t){var e=0,i=0;do{e+=t.offsetTop||0,i+=t.offsetLeft||0,t=t.offsetParent}while(t);return{top:e,left:i}},nameMap:{dragStart:n?"touchstart":"mousedown",dragMove:n?"touchmove":"mousemove",dragEnd:n?"touchend":"mouseup"}};e.default=r},function(t,e,i){"use strict";var n,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"===("undefined"==typeof window?"undefined":r(window))&&(n=window)}t.exports=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(16),a=n(r),o=i(17),s=n(o),l=i(18),u=n(l),d=i(19),c=n(d),h=i(20),p=n(h),f=i(21),y=n(f),v=i(22),m=n(v),g=i(23),b=n(g),E=i(24),T=n(E),w=i(25),S=n(w),_=i(26),k=n(_),L=i(27),R=n(L),A=i(28),D=n(A),x=i(29),I=n(x),O=i(30),C=n(O),P=i(31),M=n(P),F={play:a.default,pause:s.default,volumeUp:u.default,volumeDown:c.default,volumeOff:p.default,full:y.default,fullWeb:m.default,setting:b.default,right:T.default,comment:S.default,commentOff:k.default,send:R.default,pallette:D.default,camera:I.default,subtitle:C.default,loading:M.default};e.default=F},function(t,e,i){"use strict";(function(e){function i(){}function n(t,e){return function(){t.apply(e,arguments)}}function r(t){if(!(this instanceof r))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function a(t,e){for(;3===t._state;)t=t._value;if(0===t._state)return void t._deferreds.push(e);t._handled=!0,r._immediateFn(function(){var i=1===t._state?e.onFulfilled:e.onRejected;if(null===i)return void(1===t._state?o:s)(e.promise,t._value);var n;try{n=i(t._value)}catch(t){return void s(e.promise,t)}o(e.promise,n)})}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===(void 0===e?"undefined":c(e))||"function"==typeof e)){var i=e.then;if(e instanceof r)return t._state=3,t._value=e,void l(t);if("function"==typeof i)return void d(n(i,e),t)}t._state=1,t._value=e,l(t)}catch(e){s(t,e)}}function s(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,i=t._deferreds.length;e<i;e++)a(t,t._deferreds[e]);t._deferreds=null}function u(t,e,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=i}function d(t,e){var i=!1;try{t(function(t){i||(i=!0,o(e,t))},function(t){i||(i=!0,s(e,t))})}catch(t){if(i)return;i=!0,s(e,t)}}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var n=new this.constructor(i);return a(this,new u(t,e,n)),n},r.prototype.finally=function(t){var e=this.constructor;return this.then(function(i){return e.resolve(t()).then(function(){return i})},function(i){return e.resolve(t()).then(function(){return e.reject(i)})})},r.all=function(t){return new r(function(e,i){function n(t,o){try{if(o&&("object"===(void 0===o?"undefined":c(o))||"function"==typeof o)){var s=o.then;if("function"==typeof s)return void s.call(o,function(e){n(t,e)},i)}r[t]=o,0==--a&&e(r)}catch(t){i(t)}}if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);for(var a=r.length,o=0;o<r.length;o++)n(o,r[o])})},r.resolve=function(t){return t&&"object"===(void 0===t?"undefined":c(t))&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,i){i(t)})},r.race=function(t){return new r(function(e,i){for(var n=0,r=t.length;n<r;n++)t[n].then(e,i)})},r._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){h(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},t.exports=r}).call(e,i(9).setImmediate)},function(t,e,i){"use strict";t.exports=i(33)},function(t,e,i){var n=i(4);t.exports=function(t){"use strict";t=t||{};var e="",i=t.enableSubtitle,r=t.subtitle,a=t.current,o=t.pic,s=n.$escape,l=t.preload,u=t.url,i=r&&"webvtt"===r.type;return e+='\r\n<video\r\n    class="dplayer-video ',a&&(e+="dplayer-video-current"),e+='"\r\n    webkit-playsinline\r\n    playsinline\r\n    ',o&&(e+='poster="',e+=s(o),e+='"'),e+="\r\n    ",l&&(e+='preload="',e+=s(l),e+='"'),e+="\r\n    ",u&&(e+='src="',e+=s(u),e+='"'),e+="\r\n    >\r\n    ",i&&(e+='\r\n    <track kind="metadata" default src="',e+=s(r.url),e+='"></track>\r\n    '),e+="\r\n</video>"}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(7);var n=i(8),r=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default=r.default},function(t,e){},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(3),s=n(o),l=i(0),u=n(l),d=i(12),c=n(d),h=i(14),p=n(h),f=i(15),y=n(f),v=i(2),m=n(v),g=i(35),b=n(g),E=i(36),T=n(E),w=i(37),S=n(w),_=i(38),k=n(_),L=i(39),R=n(L),A=i(40),D=n(A),x=i(41),I=n(x),O=i(42),C=n(O),P=i(43),M=n(P),F=i(45),N=n(F),B=i(46),U=n(B),G=i(47),q=n(G),j=i(48),H=n(j),K=i(49),W=n(K),z=i(5),V=n(z),Y=i(50),X=n(Y),Q=0,$=[],J=function(){function t(e){var i=this;r(this,t),this.options=(0,c.default)(e),this.options.video.quality&&(this.qualityIndex=this.options.video.defaultQuality,this.quality=this.options.video.quality[this.options.video.defaultQuality]),this.tran=new p.default(this.options.lang).tran,this.events=new T.default,this.user=new k.default(this),this.container=this.options.container,this.container.classList.add("dplayer"),this.options.danmaku||this.container.classList.add("dplayer-no-danmaku"),this.options.live&&this.container.classList.add("dplayer-live"),u.default.isMobile&&(this.container.classList.add("dplayer-mobile"),this.options.autoplay=!1),this.arrow=this.container.offsetWidth<=500,this.arrow&&this.container.classList.add("dplayer-arrow"),this.template=new y.default({container:this.container,options:this.options,index:Q,tran:this.tran}),this.video=this.template.video,this.advideo=this.template.advideo,this.bar=new D.default(this.template),this.bezel=new C.default(this.template.bezel),this.fullScreen=new S.default(this),this.controller=new M.default(this),this.options.danmaku&&(this.danmaku=new b.default({container:this.template.danmaku,opacity:this.user.get("opacity"),callback:function(){setTimeout(function(){i.template.danmakuLoading.style.display="none",i.options.autoplay&&i.play()},0)},error:function(t){i.notice(t)},apiBackend:this.options.apiBackend,borderColor:this.options.theme,height:this.arrow?24:30,time:function(){return i.video.currentTime},unlimited:this.user.get("unlimited"),api:{id:this.options.danmaku.id,address:this.options.danmaku.api,token:this.options.danmaku.token,maximum:this.options.danmaku.maximum,addition:this.options.danmaku.addition,user:this.options.danmaku.user},events:this.events}),this.comment=new U.default(this)),this.setting=new N.default(this),document.addEventListener("click",function(){i.focus=!1},!0),this.container.addEventListener("click",function(){i.focus=!0},!0),this.paused=!0,this.adsended=!1,this.postendend=!1,this.time=new I.default(this),this.hotkey=new q.default(this),this.contextmenu=new H.default(this),this.options.autoplay||this.bezel.show(m.default.play),this.options.playad?this.ads=new X.default({container:this.template.adcontainer,advideo:this.advideo,video:this.video,events:this.events,adcountdown:this.template.adcountdown,admore:this.template.admore,adlink:this.template.adlink,adapter:this.template.adapter,adbtnclose:this.template.adbtnclose,autoplay:this.options.autoplay,controller:this.controller,callback:function(){i.video.src=i.options.video.url,i.initVideo(i.video,i.quality&&i.quality.type||i.options.video.type),setTimeout(function(){i.adsended=!0,i.play()},0)}}):(this.adsended=!0,this.video.src=this.options.video.url,this.initVideo(this.video,this.quality&&this.quality.type||this.options.video.type),setTimeout(function(){!i.danmaku&&i.options.autoplay&&i.play()},0)),this.infoPanel=new W.default(this),Q++,$.push(this)}return a(t,[{key:"seek",value:function(t){t=Math.max(t,0),this.video.duration&&(t=Math.min(t,this.video.duration)),this.video.currentTime<t?this.notice(this.tran("FF")+" "+(t-this.video.currentTime).toFixed(0)+" "+this.tran("s")):this.video.currentTime>t&&this.notice(this.tran("REW")+" "+(this.video.currentTime-t).toFixed(0)+" "+this.tran("s")),this.video.currentTime=t,this.danmaku&&this.danmaku.seek(),this.bar.set("played",t/this.video.duration,"width")}},{key:"play",value:function(){var t=this;if(this.options.playad&&!this.adsended)this.adsended=!0,this.ads.play();else if(this.paused=!1,this.video.paused&&this.bezel.switch(m.default.play),this.template.playButton.innerHTML=m.default.pause,s.default.resolve(this.video.play()).catch(function(){console.log("auto play error"),t.pause()}).then(function(){console.log("auto play")}),this.time.enable("loading"),this.time.enable("progress"),this.container.classList.remove("dplayer-paused"),this.container.classList.add("dplayer-playing"),this.danmaku&&this.danmaku.play(),this.options.mutex)for(var e=0;e<$.length;e++)this!==$[e]&&$[e].pause()}},{key:"pause",value:function(){this.paused=!0,this.container.classList.remove("dplayer-loading"),this.video.paused||this.bezel.switch(m.default.pause),this.ended=!1,this.template.playButton.innerHTML=m.default.play,this.video.pause(),this.time.disable("loading"),this.time.disable("progress"),this.container.classList.remove("dplayer-playing"),this.container.classList.add("dplayer-paused"),this.danmaku&&this.danmaku.pause()}},{key:"switchVolumeIcon",value:function(){this.volume()>=.95?this.template.volumeIcon.innerHTML=m.default.volumeUp:this.volume()>0?this.template.volumeIcon.innerHTML=m.default.volumeDown:this.template.volumeIcon.innerHTML=m.default.volumeOff}},{key:"volume",value:function(t,e,i){if(t=parseFloat(t),!isNaN(t)){t=Math.max(t,0),t=Math.min(t,1),this.bar.set("volume",t,"width");var n=(100*t).toFixed(0)+"%";this.template.volumeBarWrapWrap.dataset.balloon=n,e||this.user.set("volume",t),i||this.notice(this.tran("Volume")+" "+(100*t).toFixed(0)+"%"),this.video.volume=t,this.video.muted&&(this.video.muted=!0),this.switchVolumeIcon()}return this.video.volume}},{key:"toggle",value:function(){this.bezel.hide(),this.video.paused?(this.options.playad&&this.ads.hidepausead(),this.play()):(this.pause(),this.options.playad&&this.ads.showpausead())}},{key:"on",value:function(t,e){this.events.on(t,e)}},{key:"switchVideo",value:function(t,e){this.pause(),this.video.poster=t.pic?t.pic:"",this.video.src=t.url,this.initMSE(this.video,t.type||"auto"),e&&(this.template.danmakuLoading.style.display="block",this.bar.set("played",0,"width"),this.bar.set("loaded",0,"width"),this.template.ptime.innerHTML="00:00",this.template.danmaku.innerHTML="",this.danmaku&&this.danmaku.reload({id:e.id,address:e.api,token:e.token,maximum:e.maximum,addition:e.addition,user:e.user}))}},{key:"initMSE",value:function(t,e){var i=this;if(this.type=e,this.options.video.customType&&this.options.video.customType[e])"[object Function]"===Object.prototype.toString.call(this.options.video.customType[e])?this.options.video.customType[e](this.video,this):console.error("Illegal customType: "+e);else switch("auto"===this.type&&(/m3u8(#|\?|$)/i.exec(t.src)?this.type="hls":/.flv(#|\?|$)/i.exec(t.src)?this.type="flv":/.mpd(#|\?|$)/i.exec(t.src)?this.type="dash":this.type="normal"),this.type){case"hls":if(Hls)if(Hls.isSupported()){var n=new Hls(this.options.video.hlsconfig);n.loadSource(t.src),n.attachMedia(t)}else this.notice("Error: Hls is not supported.");else this.notice("Error: Can't find Hls.");break;case"flv":if(flvjs&&flvjs.isSupported())if(flvjs.isSupported()){var r=flvjs.createPlayer({type:"flv",url:t.src});r.attachMediaElement(t),r.load()}else this.notice("Error: flvjs is not supported.");else this.notice("Error: Can't find flvjs.");break;case"dash":dashjs?dashjs.MediaPlayer().create().initialize(t,t.src,!1):this.notice("Error: Can't find dashjs.");break;case"webtorrent":if(WebTorrent)if(WebTorrent.WEBRTC_SUPPORT){this.container.classList.add("dplayer-loading");var a=new WebTorrent,o=t.src;a.add(o,function(t){t.files.find(function(t){return t.name.endsWith(".mp4")}).renderTo(i.video,{autoplay:i.options.autoplay},function(){i.container.classList.remove("dplayer-loading")})})}else this.notice("Error: Webtorrent is not supported.");else this.notice("Error: Can't find Webtorrent.")}}},{key:"initVideo",value:function(t,e){var i=this;this.initMSE(t,e),this.on("durationchange",function(){1!==t.duration&&(i.template.dtime.innerHTML=u.default.secondToTime(t.duration))}),this.on("progress",function(){var e=t.buffered.length?t.buffered.end(t.buffered.length-1)/t.duration:0;i.bar.set("loaded",e,"width")}),this.on("error",function(){i.tran&&i.notice&&(i.type,i.notice(i.tran("This video fails to load"),-1))}),this.ended=!1,this.on("ended",function(){console.log("video ended"),i.bar.set("played",1,"width"),i.setting.loop?(i.seek(0),t.play()):(i.ended=!0,i.pause(),i.options.playad&&!i.postendend&&(i.ads.sendpostad(),i.postendend=!0)),i.danmaku&&(i.danmaku.danIndex=0)}),this.on("play",function(){i.paused&&i.play()}),this.on("pause",function(){i.paused||i.pause()});for(var n=0;n<this.events.videoEvents.length;n++)!function(e){t.addEventListener(i.events.videoEvents[e],function(){i.events.trigger(i.events.videoEvents[e])})}(n);this.volume(this.user.get("volume"),!0,!0),this.options.subtitle&&(this.subtitle=new R.default(this.template.subtitle,this.video,this.options.subtitle,this.events),this.user.get("subtitle")||this.subtitle.hide())}},{key:"switchQuality",value:function(t){var e=this;if(this.qualityIndex!==t&&!this.switchingQuality){this.qualityIndex=t,this.switchingQuality=!0,this.quality=this.options.video.quality[t],this.template.qualityButton.innerHTML=this.quality.name;var i=this.video.paused;this.video.pause();var n=(0,V.default)({current:!1,pic:null,screenshot:this.options.screenshot,preload:"auto",url:this.quality.url,subtitle:this.options.subtitle}),r=(new DOMParser).parseFromString(n,"text/html").body.firstChild;this.template.videoWrap.insertBefore(r,this.template.videoWrap.getElementsByTagName("div")[0]),this.prevVideo=this.video,this.video=r,this.initVideo(this.video,this.quality.type||this.options.video.type),this.seek(this.prevVideo.currentTime),this.notice(this.tran("Switching to")+" "+this.quality.name+" "+this.tran("quality"),-1),this.events.trigger("quality_start",this.quality),this.on("canplay",function(){if(e.prevVideo){if(e.video.currentTime!==e.prevVideo.currentTime)return void e.seek(e.prevVideo.currentTime);e.template.videoWrap.removeChild(e.prevVideo),e.video.classList.add("dplayer-video-current"),i||e.video.play(),e.prevVideo=null,e.notice(e.tran("Switched to")+" "+e.quality.name+" "+e.tran("quality")),e.switchingQuality=!1,e.events.trigger("quality_end")}})}}},{key:"notice",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;this.template.notice.innerHTML=t,this.template.notice.style.opacity=n,this.noticeTime&&clearTimeout(this.noticeTime),this.events.trigger("notice_show",t),this.noticeTime=setTimeout(function(){e.template.notice.style.opacity=0,e.events.trigger("notice_hide")},i)}},{key:"resize",value:function(){this.danmaku&&this.danmaku.resize(),this.events.trigger("resize")}},{key:"speed",value:function(t){this.video.playbackRate=t}},{key:"destroy",value:function(){$.splice($.indexOf(this),1),this.pause(),this.controller.destroy(),this.time.destroy(),this.video.src="",this.container.innerHTML="",this.events.trigger("destroy");for(var t in this)this.hasOwnProperty(t)&&"paused"!==t&&delete this[t]}}]),t}();e.default=J},function(t,e,i){"use strict";(function(t){function n(t,e){this._id=t,this._clearFn=e}var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,a=Function.prototype.apply;e.setTimeout=function(){return new n(a.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new n(a.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},i(10),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||void 0,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||void 0}).call(e,i(1))},function(t,e,i){"use strict";(function(t,e){!function(t,i){function n(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var n={callback:t,args:e};return u[l]=n,s(l),l++}function r(t){delete u[t]}function a(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(i,n)}}function o(t){if(d)setTimeout(o,0,t);else{var e=u[t];if(e){d=!0;try{a(e)}finally{
r(t),d=!1}}}}if(!t.setImmediate){var s,l=1,u={},d=!1,c=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?function(){s=function(t){e.nextTick(function(){o(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?function(){var e="setImmediate$"+Math.random()+"$",i=function(i){i.source===t&&"string"==typeof i.data&&0===i.data.indexOf(e)&&o(+i.data.slice(e.length))};t.addEventListener?t.addEventListener("message",i,!1):t.attachEvent("onmessage",i),s=function(i){t.postMessage(e+i,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){o(t.data)},s=function(e){t.port2.postMessage(e)}}():c&&"onreadystatechange"in c.createElement("script")?function(){var t=c.documentElement;s=function(e){var i=c.createElement("script");i.onreadystatechange=function(){o(e),i.onreadystatechange=null,t.removeChild(i),i=null},t.appendChild(i)}}():function(){s=function(t){setTimeout(o,0,t)}}(),h.setImmediate=n,h.clearImmediate=r}}("undefined"==typeof self?void 0===t?void 0:t:self)}).call(e,i(1),i(11))},function(t,e,i){"use strict";function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function a(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){v&&f&&(v=!1,f.length?y=f.concat(y):m=-1,y.length&&l())}function l(){if(!v){var t=a(s);v=!0;for(var e=y.length;e;){for(f=y,y=[];++m<e;)f&&f[m].run();m=-1,e=y.length}f=null,v=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function d(){}var c,h,p=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(t){h=r}}();var f,y=[],v=!1,m=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];y.push(new u(t,e)),1!==y.length||v||a(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=d,p.addListener=d,p.once=d,p.off=d,p.removeListener=d,p.removeAllListeners=d,p.emit=d,p.prependListener=d,p.prependOnceListener=d,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=i(13),a=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=function(t){var e={container:t.element||document.getElementsByClassName("dplayer")[0],live:!1,autoplay:!1,theme:"#b7daff",loop:!1,lang:(navigator.language||navigator.browserLanguage).toLowerCase(),screenshot:!1,hotkey:!0,preload:"auto",volume:.7,apiBackend:a.default,video:{hlsconfig:{}},contextmenu:[],mutex:!0};for(var i in e)e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&(t[i]=e[i]);return t.video&&!t.video.type&&(t.video.type="auto"),"object"===n(t.danmaku)&&t.danmaku&&!t.danmaku.user&&(t.danmaku.user="DIYgod"),t.subtitle&&(!t.subtitle.type&&(t.subtitle.type="webvtt"),!t.subtitle.fontSize&&(t.subtitle.fontSize="20px"),!t.subtitle.bottom&&(t.subtitle.bottom="40px"),!t.subtitle.color&&(t.subtitle.color="#fff")),t.video.quality&&(t.video.url=t.video.quality[t.video.defaultQuality].url),t.lang&&(t.lang=t.lang.toLowerCase()),t.contextmenu=t.contextmenu.concat([{text:"视频信息",click:function(t){t.infoPanel.triggle()}},{text:"MPlayer v1.1.2",link:"http://www.1905.com/"}]),t}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e,i,n,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState){if(a.status>=200&&a.status<300||304===a.status){var t=JSON.parse(a.responseText);return 0!==t.code?n(a,t):i(a,t)}r(a)}},a.open(null!==e?"POST":"GET",t,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(null!==e?JSON.stringify(e):null)};e.default={send:function(t,e,i){n(t,e,function(t,e){console.log("Post danmaku: ",e),i&&i()},function(t,e){alert(e.msg)},function(t){console.log("Request was unsuccessful: "+t.status)})},read:function(t,e){n(t,null,function(t,i){e(t,i)},function(t,i){e({status:t.status,response:i})},function(t){e({status:t.status,response:null})})}}},function(t,e,i){"use strict";function n(t){var e=this;this.lang=t,this.tran=function(t){return r[e.lang]&&r[e.lang][t]?r[e.lang][t]:t}}Object.defineProperty(e,"__esModule",{value:!0});var r={"zh-cn":{"Danmaku is loading":"弹幕加载中",Top:"顶部",Bottom:"底部",Rolling:"滚动","Input danmaku, hit Enter":"输入弹幕，回车发送","About author":"关于作者","DPlayer feedback":"播放器意见反馈","About DPlayer":"关于 DPlayer 播放器",Loop:"洗脑循环",Speed:"速度","Opacity for danmaku":"弹幕透明度",Normal:"正常","Please input danmaku content!":"要输入弹幕内容啊喂！","Set danmaku color":"设置弹幕颜色","Set danmaku type":"设置弹幕类型","Show danmaku":"显示弹幕","This video fails to load":"视频加载失败","Switching to":"正在切换至","Switched to":"已经切换至",quality:"画质",FF:"快进",REW:"快退","Unlimited danmaku":"海量弹幕","Send danmaku":"发送弹幕",Setting:"设置","Full screen":"全屏","Web full screen":"页面全屏",Send:"发送",Screenshot:"截图",s:"秒","Show subtitle":"显示字幕","Hide subtitle":"隐藏字幕",Volume:"音量",Live:"直播","Video info":"视频统计信息"},"zh-tw":{"Danmaku is loading":"彈幕加載中",Top:"頂部",Bottom:"底部",Rolling:"滾動","Input danmaku, hit Enter":"輸入彈幕，Enter 發送","About author":"關於作者","DPlayer feedback":"播放器意見反饋","About DPlayer":"關於 DPlayer 播放器",Loop:"循環播放",Speed:"速度","Opacity for danmaku":"彈幕透明度",Normal:"正常","Please input danmaku content!":"請輸入彈幕内容啊！","Set danmaku color":"設置彈幕顏色","Set danmaku type":"設置彈幕類型","Show danmaku":"顯示彈幕","This video fails to load":"視頻加載失敗","Switching to":"正在切換至","Switched to":"已經切換至",quality:"畫質",FF:"快進",REW:"快退","Unlimited danmaku":"海量彈幕","Send danmaku":"發送彈幕",Setting:"設置","Full screen":"全屏","Web full screen":"頁面全屏",Send:"發送",Screenshot:"截圖",s:"秒","Show subtitle":"顯示字幕","Hide subtitle":"隱藏字幕",Volume:"音量",Live:"直播","Video info":"視頻統計信息"}};e.default=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(2),s=n(o),l=i(32),u=n(l),d=function(){function t(e){r(this,t),this.container=e.container,this.options=e.options,this.index=e.index,this.tran=e.tran,this.init()}return a(t,[{key:"init",value:function(){this.container.innerHTML=(0,u.default)({options:this.options,index:this.index,tran:this.tran,icons:s.default,video:{current:!0,pic:this.options.video.pic,screenshot:this.options.screenshot,preload:this.options.preload,subtitle:this.options.subtitle}}),this.volumeBar=this.container.querySelector(".dplayer-volume-bar-inner"),this.volumeBarWrap=this.container.querySelector(".dplayer-volume-bar"),this.volumeBarWrapWrap=this.container.querySelector(".dplayer-volume-bar-wrap"),this.volumeButton=this.container.querySelector(".dplayer-volume"),this.volumeIcon=this.container.querySelector(".dplayer-volume-icon .dplayer-icon-content"),this.playedBar=this.container.querySelector(".dplayer-played"),this.loadedBar=this.container.querySelector(".dplayer-loaded"),this.playedBarWrap=this.container.querySelector(".dplayer-bar-wrap"),this.playedBarTime=this.container.querySelector(".dplayer-bar-time"),this.danmaku=this.container.querySelector(".dplayer-danmaku"),this.danmakuLoading=this.container.querySelector(".dplayer-danloading"),this.video=this.container.querySelector(".dplayer-video-current"),this.adcontainer=this.container.querySelector(".txp_ad_inner"),this.advideo=this.container.querySelector(".gp-video-ad-player"),this.adcountdown=this.container.querySelector(".txp_ad_countdown"),this.admore=this.container.querySelector(".txp_ad_more"),this.adapter=this.container.querySelector(".hd-adapter-interactivelayer"),this.adlink=this.container.querySelector(".txp_ad_link"),this.adbtnclose=this.container.querySelector(".txp_btn_close"),this.bezel=this.container.querySelector(".dplayer-bezel-icon"),this.playButton=this.container.querySelector(".dplayer-play-icon"),this.videoWrap=this.container.querySelector(".dplayer-video-wrap"),this.controllerMask=this.container.querySelector(".dplayer-controller-mask"),this.ptime=this.container.querySelector(".dplayer-ptime"),this.settingButton=this.container.querySelector(".dplayer-setting-icon"),this.settingBox=this.container.querySelector(".dplayer-setting-box"),this.mask=this.container.querySelector(".dplayer-mask"),this.loop=this.container.querySelector(".dplayer-setting-loop"),this.loopToggle=this.container.querySelector(".dplayer-setting-loop .dplayer-toggle-setting-input"),this.showDanmaku=this.container.querySelector(".dplayer-setting-showdan"),this.showDanmakuToggle=this.container.querySelector(".dplayer-showdan-setting-input"),this.unlimitDanmaku=this.container.querySelector(".dplayer-setting-danunlimit"),this.unlimitDanmakuToggle=this.container.querySelector(".dplayer-danunlimit-setting-input"),this.speed=this.container.querySelector(".dplayer-setting-speed"),this.speedItem=this.container.querySelectorAll(".dplayer-setting-speed-item"),this.danmakuOpacityBar=this.container.querySelector(".dplayer-danmaku-bar-inner"),this.danmakuOpacityBarWrap=this.container.querySelector(".dplayer-danmaku-bar"),this.danmakuOpacityBarWrapWrap=this.container.querySelector(".dplayer-danmaku-bar-wrap"),this.danmakuOpacityBox=this.container.querySelector(".dplayer-setting-danmaku"),this.dtime=this.container.querySelector(".dplayer-dtime"),this.controller=this.container.querySelector(".dplayer-controller"),this.commentInput=this.container.querySelector(".dplayer-comment-input"),this.commentButton=this.container.querySelector(".dplayer-comment-icon"),this.commentSettingBox=this.container.querySelector(".dplayer-comment-setting-box"),this.commentSettingButton=this.container.querySelector(".dplayer-comment-setting-icon"),this.commentSettingFill=this.container.querySelector(".dplayer-comment-setting-icon path"),this.commentSendButton=this.container.querySelector(".dplayer-send-icon"),this.commentSendFill=this.container.querySelector(".dplayer-send-icon path"),this.commentColorSettingBox=this.container.querySelector(".dplayer-comment-setting-color"),this.browserFullButton=this.container.querySelector(".dplayer-full-icon"),this.webFullButton=this.container.querySelector(".dplayer-full-in-icon"),this.menu=this.container.querySelector(".dplayer-menu"),this.menuItem=this.container.querySelectorAll(".dplayer-menu-item"),this.qualityList=this.container.querySelector(".dplayer-quality-list"),this.camareButton=this.container.querySelector(".dplayer-camera-icon"),this.subtitleButton=this.container.querySelector(".dplayer-subtitle-icon"),this.subtitleButtonInner=this.container.querySelector(".dplayer-subtitle-icon .dplayer-icon-content"),this.subtitle=this.container.querySelector(".dplayer-subtitle"),this.qualityButton=this.container.querySelector(".dplayer-quality-icon"),this.barPreview=this.container.querySelector(".dplayer-bar-preview"),this.barWrap=this.container.querySelector(".dplayer-bar-wrap"),this.notice=this.container.querySelector(".dplayer-notice"),this.infoPanel=this.container.querySelector(".dplayer-info-panel"),this.infoPanelClose=this.container.querySelector(".dplayer-info-panel-close"),this.infoVersion=this.container.querySelector(".dplayer-info-panel-item-version .dplayer-info-panel-item-data"),this.infoFPS=this.container.querySelector(".dplayer-info-panel-item-fps .dplayer-info-panel-item-data"),this.infoType=this.container.querySelector(".dplayer-info-panel-item-type .dplayer-info-panel-item-data"),this.infoUrl=this.container.querySelector(".dplayer-info-panel-item-url .dplayer-info-panel-item-data"),this.infoResolution=this.container.querySelector(".dplayer-info-panel-item-resolution .dplayer-info-panel-item-data"),this.infoDuration=this.container.querySelector(".dplayer-info-panel-item-duration .dplayer-info-panel-item-data"),this.infoDanmakuId=this.container.querySelector(".dplayer-info-panel-item-danmaku-id .dplayer-info-panel-item-data"),this.infoDanmakuApi=this.container.querySelector(".dplayer-info-panel-item-danmaku-api .dplayer-info-panel-item-data"),this.infoDanmakuAmount=this.container.querySelector(".dplayer-info-panel-item-danmaku-amount .dplayer-info-panel-item-data")}}]),t}();e.default=d},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 16 32"><path d="M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 17 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M6.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v4h4c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333zM30.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h4v-4c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM30.667 12c-0.8 0-1.333-0.533-1.333-1.333v-4h-4c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM1.333 12c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333h-4v4c0 0.8-0.533 1.333-1.333 1.333z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M24.965 24.38h-18.132c-1.366 0-2.478-1.113-2.478-2.478v-11.806c0-1.364 1.111-2.478 2.478-2.478h18.132c1.366 0 2.478 1.113 2.478 2.478v11.806c0 1.364-1.11 2.478-2.478 2.478zM6.833 10.097v11.806h18.134l-0.002-11.806h-18.132zM2.478 28.928h5.952c0.684 0 1.238-0.554 1.238-1.239 0-0.684-0.554-1.238-1.238-1.238h-5.952v-5.802c0-0.684-0.554-1.239-1.238-1.239s-1.239 0.556-1.239 1.239v5.802c0 1.365 1.111 2.478 2.478 2.478zM30.761 19.412c-0.684 0-1.238 0.554-1.238 1.238v5.801h-5.951c-0.686 0-1.239 0.554-1.239 1.238 0 0.686 0.554 1.239 1.239 1.239h5.951c1.366 0 2.478-1.111 2.478-2.478v-5.801c0-0.683-0.554-1.238-1.239-1.238zM0 5.55v5.802c0 0.683 0.554 1.238 1.238 1.238s1.238-0.555 1.238-1.238v-5.802h5.952c0.684 0 1.238-0.554 1.238-1.238s-0.554-1.238-1.238-1.238h-5.951c-1.366-0.001-2.478 1.111-2.478 2.476zM32 11.35v-5.801c0-1.365-1.11-2.478-2.478-2.478h-5.951c-0.686 0-1.239 0.554-1.239 1.238s0.554 1.238 1.239 1.238h5.951v5.801c0 0.683 0.554 1.237 1.238 1.237 0.686 0.002 1.239-0.553 1.239-1.236z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 28"><path d="M28.633 17.104c0.035 0.21 0.026 0.463-0.026 0.76s-0.14 0.598-0.262 0.904c-0.122 0.306-0.271 0.581-0.445 0.825s-0.367 0.419-0.576 0.524c-0.209 0.105-0.393 0.157-0.55 0.157s-0.332-0.035-0.524-0.105c-0.175-0.052-0.393-0.1-0.655-0.144s-0.528-0.052-0.799-0.026c-0.271 0.026-0.541 0.083-0.812 0.17s-0.502 0.236-0.694 0.445c-0.419 0.437-0.664 0.934-0.734 1.493s0.009 1.092 0.236 1.598c0.175 0.349 0.148 0.699-0.079 1.048-0.105 0.14-0.271 0.284-0.498 0.432s-0.476 0.284-0.747 0.406-0.555 0.218-0.851 0.288c-0.297 0.070-0.559 0.105-0.786 0.105-0.157 0-0.306-0.061-0.445-0.183s-0.236-0.253-0.288-0.393h-0.026c-0.192-0.541-0.52-1.009-0.982-1.402s-1-0.589-1.611-0.589c-0.594 0-1.131 0.197-1.611 0.589s-0.816 0.851-1.009 1.375c-0.087 0.21-0.218 0.362-0.393 0.458s-0.367 0.144-0.576 0.144c-0.244 0-0.52-0.044-0.825-0.131s-0.611-0.197-0.917-0.327c-0.306-0.131-0.581-0.284-0.825-0.458s-0.428-0.349-0.55-0.524c-0.087-0.122-0.135-0.266-0.144-0.432s0.057-0.397 0.197-0.694c0.192-0.402 0.266-0.86 0.223-1.375s-0.266-0.991-0.668-1.428c-0.244-0.262-0.541-0.432-0.891-0.511s-0.681-0.109-0.995-0.092c-0.367 0.017-0.742 0.087-1.127 0.21-0.244 0.070-0.489 0.052-0.734-0.052-0.192-0.070-0.371-0.231-0.537-0.485s-0.314-0.533-0.445-0.838c-0.131-0.306-0.231-0.62-0.301-0.943s-0.087-0.59-0.052-0.799c0.052-0.384 0.227-0.629 0.524-0.734 0.524-0.21 0.995-0.555 1.415-1.035s0.629-1.017 0.629-1.611c0-0.611-0.21-1.144-0.629-1.598s-0.891-0.786-1.415-0.996c-0.157-0.052-0.288-0.179-0.393-0.38s-0.157-0.406-0.157-0.616c0-0.227 0.035-0.48 0.105-0.76s0.162-0.55 0.275-0.812 0.244-0.502 0.393-0.72c0.148-0.218 0.31-0.38 0.485-0.485 0.14-0.087 0.275-0.122 0.406-0.105s0.275 0.052 0.432 0.105c0.524 0.21 1.070 0.275 1.637 0.197s1.070-0.327 1.506-0.747c0.21-0.209 0.362-0.467 0.458-0.773s0.157-0.607 0.183-0.904c0.026-0.297 0.026-0.568 0-0.812s-0.048-0.419-0.065-0.524c-0.035-0.105-0.066-0.227-0.092-0.367s-0.013-0.262 0.039-0.367c0.105-0.244 0.293-0.458 0.563-0.642s0.563-0.336 0.878-0.458c0.314-0.122 0.62-0.214 0.917-0.275s0.533-0.092 0.707-0.092c0.227 0 0.406 0.074 0.537 0.223s0.223 0.301 0.275 0.458c0.192 0.471 0.507 0.886 0.943 1.244s0.952 0.537 1.546 0.537c0.611 0 1.153-0.17 1.624-0.511s0.803-0.773 0.996-1.297c0.070-0.14 0.179-0.284 0.327-0.432s0.301-0.223 0.458-0.223c0.244 0 0.511 0.035 0.799 0.105s0.572 0.166 0.851 0.288c0.279 0.122 0.537 0.279 0.773 0.472s0.423 0.402 0.563 0.629c0.087 0.14 0.113 0.293 0.079 0.458s-0.070 0.284-0.105 0.354c-0.227 0.506-0.297 1.039-0.21 1.598s0.341 1.048 0.76 1.467c0.419 0.419 0.934 0.651 1.546 0.694s1.179-0.057 1.703-0.301c0.14-0.087 0.31-0.122 0.511-0.105s0.371 0.096 0.511 0.236c0.262 0.244 0.493 0.616 0.694 1.113s0.336 1 0.406 1.506c0.035 0.297-0.013 0.528-0.144 0.694s-0.266 0.275-0.406 0.327c-0.542 0.192-1.004 0.528-1.388 1.009s-0.576 1.026-0.576 1.637c0 0.594 0.162 1.113 0.485 1.559s0.747 0.764 1.27 0.956c0.122 0.070 0.227 0.14 0.314 0.21 0.192 0.157 0.323 0.358 0.393 0.602v0zM16.451 19.462c0.786 0 1.528-0.149 2.227-0.445s1.305-0.707 1.821-1.231c0.515-0.524 0.921-1.131 1.218-1.821s0.445-1.428 0.445-2.214c0-0.786-0.148-1.524-0.445-2.214s-0.703-1.292-1.218-1.808c-0.515-0.515-1.122-0.921-1.821-1.218s-1.441-0.445-2.227-0.445c-0.786 0-1.524 0.148-2.214 0.445s-1.292 0.703-1.808 1.218c-0.515 0.515-0.921 1.118-1.218 1.808s-0.445 1.428-0.445 2.214c0 0.786 0.149 1.524 0.445 2.214s0.703 1.297 1.218 1.821c0.515 0.524 1.118 0.934 1.808 1.231s1.428 0.445 2.214 0.445v0z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.128 0.38h-22.553c-2.336 0-4.229 1.825-4.229 4.076v16.273c0 2.251 1.893 4.076 4.229 4.076h4.229v-2.685h8.403l-8.784 8.072 1.566 1.44 7.429-6.827h9.71c2.335 0 4.229-1.825 4.229-4.076v-16.273c0-2.252-1.894-4.076-4.229-4.076zM28.538 19.403c0 1.5-1.262 2.717-2.819 2.717h-8.36l-0.076-0.070-0.076 0.070h-11.223c-1.557 0-2.819-1.217-2.819-2.717v-13.589c0-1.501 1.262-2.718 2.819-2.718h19.734c1.557 0 2.819-0.141 2.819 1.359v14.947zM9.206 10.557c-1.222 0-2.215 0.911-2.215 2.036s0.992 2.035 2.215 2.035c1.224 0 2.216-0.911 2.216-2.035s-0.992-2.036-2.216-2.036zM22.496 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.224 0 2.215-0.911 2.215-2.035s-0.991-2.036-2.215-2.036zM15.852 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.222 0 2.215-0.911 2.215-2.035s-0.992-2.036-2.215-2.036z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.090 0.131h-22.731c-2.354 0-4.262 1.839-4.262 4.109v16.401c0 2.269 1.908 4.109 4.262 4.109h4.262v-2.706h8.469l-8.853 8.135 1.579 1.451 7.487-6.88h9.787c2.353 0 4.262-1.84 4.262-4.109v-16.401c0-2.27-1.909-4.109-4.262-4.109v0zM28.511 19.304c0 1.512-1.272 2.738-2.841 2.738h-8.425l-0.076-0.070-0.076 0.070h-11.311c-1.569 0-2.841-1.226-2.841-2.738v-13.696c0-1.513 1.272-2.739 2.841-2.739h19.889c1.569 0 2.841-0.142 2.841 1.37v15.064z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.725 30l3.9-5.325-3.9-1.125v6.45zM0 17.5l11.050 3.35 13.6-11.55-10.55 12.425 11.8 3.65 6.1-23.375-32 15.5z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z"></path></svg>'},function(t,e){t.exports='<svg version="1.1" viewBox="0 0 22 22"><svg x="7" y="1"><circle class="diplayer-loading-dot diplayer-loading-dot-0" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-1" cx="4" cy="4" r="2"></circle></svg><svg x="13" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-2" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-3" cx="4" cy="4" r="2"></circle></svg><svg x="7" y="13"><circle class="diplayer-loading-dot diplayer-loading-dot-4" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-5" cx="4" cy="4" r="2"></circle></svg><svg x="1" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-6" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-7" cx="4" cy="4" r="2"></circle></svg></svg>'},function(t,e,i){var n=i(4);t.exports=function(t){"use strict";t=t||{};var e="",r=(arguments[1],t.video),a=t.options,o=n.$escape,s=t.tran,l=t.icons,u=t.index,d=n.$each;return t.$value,t.$index,e+='<div class="dplayer-mask"></div>\r\n<div class="dplayer-video-wrap">\r\n    ',function(t){e+=t}(i(5)(r)),e+="\r\n    ",a.logo&&(e+='\r\n    <div class="dplayer-logo">\r\n        <img src="',e+=o(a.logo),e+='">\r\n    </div>\r\n    '),e+='\r\n    <div class="dplayer-danmaku"',a.danmaku&&a.danmaku.bottm&&(e+=' style="margin-bottom:',e+=o(a.danmaku.bottm),e+='"'),e+='>\r\n        <div class="dplayer-danmaku-item dplayer-danmaku-item--demo"></div>\r\n    </div>\r\n    <div class="dplayer-subtitle"></div>\r\n    <div class="dplayer-bezel">\r\n        <span class="dplayer-bezel-icon"></span>\r\n        ',a.danmaku&&(e+='\r\n        <span class="dplayer-danloading">',e+=o(s("Danmaku is loading")),e+="</span>\r\n        "),e+='\r\n        <span class="diplayer-loading-icon">',e+=l.loading,e+='</span>\r\n    </div>\r\n</div>\r\n<div class="dplayer-controller-mask"></div>\r\n<div class="dplayer-controller">\r\n    <div class="dplayer-icons dplayer-comment-box">\r\n        <button class="dplayer-icon dplayer-comment-setting-icon" data-balloon="',e+=o(s("Setting")),e+='" data-balloon-pos="up">\r\n            <span class="dplayer-icon-content">',e+=l.pallette,e+='</span>\r\n        </button>\r\n        <div class="dplayer-comment-setting-box">\r\n            <div class="dplayer-comment-setting-color">\r\n                <div class="dplayer-comment-setting-title">',e+=o(s("Set danmaku color")),e+='</div>\r\n                <label>\r\n                    <input type="radio" name="dplayer-danmaku-color-',e+=o(u),e+='" value="#fff" checked>\r\n                    <span style="background: #fff;"></span>\r\n                </label>\r\n                <label>\r\n                    <input type="radio" name="dplayer-danmaku-color-',e+=o(u),e+='" value="#e54256">\r\n                    <span style="background: #e54256"></span>\r\n                </label>\r\n                <label>\r\n                    <input type="radio" name="dplayer-danmaku-color-',e+=o(u),e+='" value="#ffe133">\r\n                    <span style="background: #ffe133"></span>\r\n                </label>\r\n                <label>\r\n                    <input type="radio" name="dplayer-danmaku-color-',e+=o(u),e+='" value="#64DD17">\r\n                    <span style="background: #64DD17"></span>\r\n                </label>\r\n                <label>\r\n                    <input type="radio" name="dplayer-danmaku-color-',e+=o(u),e+='" value="#39ccff">\r\n                    <span style="background: #39ccff"></span>\r\n                </label>\r\n                <label>\r\n                    <input type="radio" name="dplayer-danmaku-color-',e+=o(u),e+='" value="#D500F9">\r\n                    <span style="background: #D500F9"></span>\r\n                </label>\r\n            </div>\r\n            <div class="dplayer-comment-setting-type">\r\n                <div class="dplayer-comment-setting-title">',e+=o(s("Set danmaku type")),e+='</div>\r\n                <label>\r\n                    <input type="radio" name="dplayer-danmaku-type-',e+=o(u),e+='" value="top">\r\n                    <span>',e+=o(s("Top")),e+='</span>\r\n                </label>\r\n                <label>\r\n                    <input type="radio" name="dplayer-danmaku-type-',e+=o(u),e+='" value="right" checked>\r\n                    <span>',e+=o(s("Rolling")),e+='</span>\r\n                </label>\r\n                <label>\r\n                    <input type="radio" name="dplayer-danmaku-type-',e+=o(u),e+='" value="bottom">\r\n                    <span>',e+=o(s("Bottom")),e+='</span>\r\n                </label>\r\n            </div>\r\n        </div>\r\n        <input class="dplayer-comment-input" type="text" placeholder="',e+=o(s("Input danmaku, hit Enter")),e+='" maxlength="30">\r\n        <button class="dplayer-icon dplayer-send-icon" data-balloon="',e+=o(s("Send")),e+='" data-balloon-pos="up">\r\n            <span class="dplayer-icon-content">',e+=l.send,
e+='</span>\r\n        </button>\r\n    </div>\r\n    <div class="dplayer-icons dplayer-icons-left">\r\n        <button class="dplayer-icon dplayer-play-icon">\r\n            <span class="dplayer-icon-content">',e+=l.play,e+='</span>\r\n        </button>\r\n        <div class="dplayer-volume">\r\n            <button class="dplayer-icon dplayer-volume-icon">\r\n                <span class="dplayer-icon-content">',e+=l.volumeDown,e+='</span>\r\n            </button>\r\n            <div class="dplayer-volume-bar-wrap" data-balloon-pos="up">\r\n                <div class="dplayer-volume-bar">\r\n                    <div class="dplayer-volume-bar-inner" style="background: ',e+=o(a.theme),e+=';">\r\n                        <span class="dplayer-thumb" style="background: ',e+=o(a.theme),e+='"></span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <span class="dplayer-time">\r\n            <span class="dplayer-ptime">0:00</span> /\r\n            <span class="dplayer-dtime">0:00</span>\r\n        </span>\r\n        ',a.live&&(e+='\r\n        <span class="dplayer-live-badge"><span class="dplayer-live-dot" style="background: ',e+=o(a.theme),e+=';"></span>',e+=o(s("Live")),e+="</span>\r\n        "),e+='\r\n    </div>\r\n    <div class="dplayer-icons dplayer-icons-right">\r\n        ',a.video.quality&&(e+='\r\n        <div class="dplayer-quality">\r\n            <button class="dplayer-icon dplayer-quality-icon">',e+=o(a.video.quality[a.video.defaultQuality].name),e+='</button>\r\n            <div class="dplayer-quality-mask">\r\n                <div class="dplayer-quality-list">\r\n                ',d(a.video.quality,function(t,i){e+='\r\n                    <div class="dplayer-quality-item" data-index="',e+=o(i),e+='">',e+=o(t.name),e+="</div>\r\n                "}),e+="\r\n                </div>\r\n            </div>\r\n        </div>\r\n        "),e+="\r\n        ",a.screenshot&&(e+='\r\n        <div class="dplayer-icon dplayer-camera-icon" data-balloon="',e+=o(s("Screenshot")),e+='" data-balloon-pos="up">\r\n            <span class="dplayer-icon-content">',e+=l.camera,e+="</span>\r\n        </div>\r\n        "),e+='\r\n        <div class="dplayer-comment">\r\n            <button class="dplayer-icon dplayer-comment-icon" data-balloon="',e+=o(s("Send danmaku")),e+='" data-balloon-pos="up">\r\n                <span class="dplayer-icon-content">',e+=l.comment,e+="</span>\r\n            </button>\r\n        </div>\r\n        ",a.subtitle&&(e+='\r\n        <div class="dplayer-subtitle-btn">\r\n            <button class="dplayer-icon dplayer-subtitle-icon" data-balloon="',e+=o(s("Hide subtitle")),e+='" data-balloon-pos="up">\r\n                <span class="dplayer-icon-content">',e+=l.subtitle,e+="</span>\r\n            </button>\r\n        </div>\r\n        "),e+='\r\n        <div class="dplayer-setting">\r\n            <button class="dplayer-icon dplayer-setting-icon" data-balloon="',e+=o(s("Setting")),e+='" data-balloon-pos="up">\r\n                <span class="dplayer-icon-content">',e+=l.setting,e+='</span>\r\n            </button>\r\n            <div class="dplayer-setting-box">\r\n                <div class="dplayer-setting-origin-panel">\r\n                    <div class="dplayer-setting-item dplayer-setting-speed">\r\n                        <span class="dplayer-label">',e+=o(s("Speed")),e+='</span>\r\n                        <div class="dplayer-toggle">',e+=l.right,e+='</div>\r\n                    </div>\r\n                    <div class="dplayer-setting-item dplayer-setting-loop">\r\n                        <span class="dplayer-label">',e+=o(s("Loop")),e+='</span>\r\n                        <div class="dplayer-toggle">\r\n                            <input class="dplayer-toggle-setting-input" type="checkbox" name="dplayer-toggle">\r\n                            <label for="dplayer-toggle"></label>\r\n                        </div>\r\n                    </div>\r\n                    <div class="dplayer-setting-item dplayer-setting-showdan">\r\n                        <span class="dplayer-label">',e+=o(s("Show danmaku")),e+='</span>\r\n                        <div class="dplayer-toggle">\r\n                            <input class="dplayer-showdan-setting-input" type="checkbox" name="dplayer-toggle-dan">\r\n                            <label for="dplayer-toggle-dan"></label>\r\n                        </div>\r\n                    </div>\r\n                    <div class="dplayer-setting-item dplayer-setting-danunlimit">\r\n                        <span class="dplayer-label">',e+=o(s("Unlimited danmaku")),e+='</span>\r\n                        <div class="dplayer-toggle">\r\n                            <input class="dplayer-danunlimit-setting-input" type="checkbox" name="dplayer-toggle-danunlimit">\r\n                            <label for="dplayer-toggle-danunlimit"></label>\r\n                        </div>\r\n                    </div>\r\n                    <div class="dplayer-setting-item dplayer-setting-danmaku">\r\n                        <span class="dplayer-label">',e+=o(s("Opacity for danmaku")),e+='</span>\r\n                        <div class="dplayer-danmaku-bar-wrap">\r\n                            <div class="dplayer-danmaku-bar">\r\n                                <div class="dplayer-danmaku-bar-inner">\r\n                                    <span class="dplayer-thumb"></span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="dplayer-setting-speed-panel">\r\n                    <div class="dplayer-setting-speed-item" data-speed="0.5">\r\n                        <span class="dplayer-label">0.5</span>\r\n                    </div>\r\n                    <div class="dplayer-setting-speed-item" data-speed="0.75">\r\n                        <span class="dplayer-label">0.75</span>\r\n                    </div>\r\n                    <div class="dplayer-setting-speed-item" data-speed="1">\r\n                        <span class="dplayer-label">',e+=o(s("Normal")),e+='</span>\r\n                    </div>\r\n                    <div class="dplayer-setting-speed-item" data-speed="1.25">\r\n                        <span class="dplayer-label">1.25</span>\r\n                    </div>\r\n                    <div class="dplayer-setting-speed-item" data-speed="1.5">\r\n                        <span class="dplayer-label">1.5</span>\r\n                    </div>\r\n                    <div class="dplayer-setting-speed-item" data-speed="2">\r\n                        <span class="dplayer-label">2</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="dplayer-full">\r\n            <button class="dplayer-icon dplayer-full-in-icon" data-balloon="',e+=o(s("Web full screen")),e+='" data-balloon-pos="up">\r\n                <span class="dplayer-icon-content">',e+=l.fullWeb,e+='</span>\r\n            </button>\r\n            <button class="dplayer-icon dplayer-full-icon" data-balloon="',e+=o(s("Full screen")),e+='" data-balloon-pos="up">\r\n                <span class="dplayer-icon-content">',e+=l.full,e+='</span>\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div class="dplayer-bar-wrap">\r\n        <div class="dplayer-bar-time hidden">00:00</div>\r\n        <div class="dplayer-bar-preview"></div>\r\n        <div class="dplayer-bar">\r\n            <div class="dplayer-loaded" style="width: 0;"></div>\r\n            <div class="dplayer-played" style="width: 0; background: ',e+=o(a.theme),e+='">\r\n                <span class="dplayer-thumb" style="background: ',e+=o(a.theme),e+='"></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="dplayer-info-panel dplayer-info-panel-hide">\r\n    <div class="dplayer-info-panel-close">[x]</div>\r\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-version">\r\n        <span class="dplayer-info-panel-item-title">Player version</span>\r\n        <span class="dplayer-info-panel-item-data"></span>\r\n    </div>\r\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-fps">\r\n        <span class="dplayer-info-panel-item-title">Player FPS</span>\r\n        <span class="dplayer-info-panel-item-data"></span>\r\n    </div>\r\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-type">\r\n        <span class="dplayer-info-panel-item-title">Video type</span>\r\n        <span class="dplayer-info-panel-item-data"></span>\r\n    </div>\r\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-url">\r\n        <span class="dplayer-info-panel-item-title">Video url</span>\r\n        <span class="dplayer-info-panel-item-data"></span>\r\n    </div>\r\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-resolution">\r\n        <span class="dplayer-info-panel-item-title">Video resolution</span>\r\n        <span class="dplayer-info-panel-item-data"></span>\r\n    </div>\r\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-duration">\r\n        <span class="dplayer-info-panel-item-title">Video duration</span>\r\n        <span class="dplayer-info-panel-item-data"></span>\r\n    </div>\r\n    ',a.danmaku&&(e+='\r\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-id">\r\n        <span class="dplayer-info-panel-item-title">Danamku id</span>\r\n        <span class="dplayer-info-panel-item-data"></span>\r\n    </div>\r\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-api">\r\n        <span class="dplayer-info-panel-item-title">Danamku api</span>\r\n        <span class="dplayer-info-panel-item-data"></span>\r\n    </div>\r\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-amount">\r\n        <span class="dplayer-info-panel-item-title">Danamku amount</span>\r\n        <span class="dplayer-info-panel-item-data"></span>\r\n    </div>\r\n    '),e+='\r\n</div>\r\n<div class="dplayer-menu">\r\n    ',d(a.contextmenu,function(t,i){e+='\r\n        <div class="dplayer-menu-item">\r\n            <a target="_blank" href="',e+=o(t.link||"javascript:void(0);"),e+='">',e+=o(s(t.text)),e+="</a>\r\n        </div>\r\n    "}),e+='\r\n</div>\r\n<div class="dplayer-notice"></div>\r\n<div class="txp_ad_inner" style=\'display:none;\'>\r\n      <a href="javascript:;" class="txp_ad_link" style="z-index: 1;position: relative"></a>\r\n      <a href="javascript:;" class="txp_ad_more">详情点击\r\n        <div class="txp_icon_arrow"></div></a>\r\n      <div style="left:10px;bottom:10px;position:absolute;opacity:0.6;font-size:12px;text-shadow:2px 2px #000" class="txp_none"></div>\r\n      <div  class="txp_ad_control">\r\n        <div class="txp_ad_skip">\r\n          <div  class="txp_ad_countdown">0</div>\r\n        </div>\r\n      </div>\r\n</div>\r\n<div class="hd-adapter-interactivelayer" style="position: absolute; top: 0px; right: 0px; width: 100%; height: 100%; z-index: 4; pointer-events: none;display:none;">\r\n  <div class="txp_ad">\r\n    <div data-role="gp-ad-pause" class="txp_ad_center" style="position: absolute; z-index: 4; width: 300px; height: 250px; top: 0px; left: 0px; right: 0px; bottom: 0px; margin: auto;">\r\n      <div data-role="gp-ad-pause-close" class="txp_btn txp_btn_close txp_btn_close_ad" title="关闭广告"></div>\r\n      <img data-role="gp-ad-pause-img" alt="">\r\n      <div style="left:8px;bottom:8px;position:absolute;opacity:0.6;font-size:12px; z-index: 99">\r\n        <div style="background:#000;display:inline-block;box-shadow:2px 2px #000;color:#fff">广告</div>\r\n        <div style="display:inline-block;margin-left:10px;text-shadow:2px 2px #000"></div>\r\n      </div>\r\n      <div class="adloader_pause"></div>\r\n    </div>\r\n  </div>\r\n</div>'}},function(t,e,i){"use strict";(function(e){function n(t){return"string"!=typeof t&&(t=void 0===t||null===t?"":"function"==typeof t?n(t.call(t)):JSON.stringify(t)),t}function r(t){var e=""+t,i=s.exec(e);if(!i)return t;var n="",r=void 0,a=void 0,o=void 0;for(r=i.index,a=0;r<e.length;r++){switch(e.charCodeAt(r)){case 34:o="&#34;";break;case 38:o="&#38;";break;case 39:o="&#39;";break;case 60:o="&#60;";break;case 62:o="&#62;";break;default:continue}a!==r&&(n+=e.substring(a,r)),a=r+1,n+=o}return a!==r?n+e.substring(a,r):n}var a=i(34),o=Object.create(a?e:window),s=/["&'<>]/;o.$escape=function(t){return r(n(t))},o.$each=function(t,e){if(Array.isArray(t))for(var i=0,n=t.length;i<n;i++)e(t[i],i);else for(var r in t)e(t[r],r)},t.exports=o}).call(e,i(1))},function(t,e,i){"use strict";(function(e){t.exports=!1;try{t.exports="[object process]"===Object.prototype.toString.call(e.process)}catch(t){}}).call(e,i(1))},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function(){function t(e){n(this,t),this.options=e,this.container=this.options.container,this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.dan=[],this.showing=!0,this._opacity=this.options.opacity,this.events=this.options.events,this.unlimited=this.options.unlimited,this._measure(""),this.load()}return a(t,[{key:"load",value:function(){var t=this,e=void 0;e=this.options.api.maximum?this.options.api.address+"v2/?id="+this.options.api.id+"&max="+this.options.api.maximum:this.options.api.address+"v2/?id="+this.options.api.id;var i=(this.options.api.addition||[]).slice(0);i.push(e),this.events&&this.events.trigger("danmaku_load_start",i),this._readAllEndpoints(i,function(e){t.dan=[].concat.apply([],e).sort(function(t,e){return t.time-e.time}),window.requestAnimationFrame(function(){t.frame()}),t.options.callback(),t.events&&t.events.trigger("danmaku_load_end")})}},{key:"reload",value:function(t){this.options.api=t,this.dan=[],this.clear(),this.load()}},{key:"_readAllEndpoints",value:function(t,e){for(var i=this,n=[],r=0,a=0;a<t.length;++a)this.options.apiBackend.read(t[a],function(a){return function(o,s){if(++r,o)o.response?i.options.error(o.response.msg):i.options.error("Request was unsuccessful: "+o.status),n[a]=[];else{var l=["right","top","bottom"];n[a]=s?s.map(function(t){return{time:t[0],type:l[t[1]],color:t[2],author:t[3],text:t[4]}}):[]}if(r===t.length)return e(n)}}(a))}},{key:"send",value:function(t,e){var i={token:this.options.api.token,player:this.options.api.id,author:this.options.api.user,time:this.options.time(),text:t.text,color:t.color,type:t.type};this.options.apiBackend.send(this.options.api.address+"v2/",i,e),this.dan.splice(this.danIndex,0,i),this.danIndex++;var n={text:this.htmlEncode(i.text),color:i.color,type:i.type,border:"2px solid "+this.options.borderColor};this.draw(n),this.events&&this.events.trigger("danmaku_send",i)}},{key:"frame",value:function(){var t=this;if(this.dan.length&&!this.paused&&this.showing){for(var e=this.dan[this.danIndex],i=[];e&&this.options.time()>parseFloat(e.time);)i.push(e),e=this.dan[++this.danIndex];this.draw(i)}window.requestAnimationFrame(function(){t.frame()})}},{key:"opacity",value:function(t){if(void 0!==t){for(var e=this.container.getElementsByClassName("dplayer-danmaku-item"),i=0;i<e.length;i++)e[i].style.opacity=t;this._opacity=t,this.events&&this.events.trigger("danmaku_opacity",this._opacity)}return this._opacity}},{key:"draw",value:function(t){var e=this;if(this.showing){var i=this.options.height,n=this.container.offsetWidth,a=this.container.offsetHeight,o=parseInt(a/i),s=function(t){var i=t.offsetWidth||parseInt(t.style.width),n=t.getBoundingClientRect().right||e.container.getBoundingClientRect().right+i;return e.container.getBoundingClientRect().right-n},l=function(t){return(n+t)/5},u=function(t,i,a){for(var u=n/l(a),d=0;e.unlimited||d<o;d++){var c=function(r){var a=e.danTunnel[i][r+""];if(!a||!a.length)return e.danTunnel[i][r+""]=[t],t.addEventListener("animationend",function(){e.danTunnel[i][r+""].splice(0,1)}),{v:r%o};if("right"!==i)return"continue";for(var d=0;d<a.length;d++){var c=s(a[d])-10;if(c<=n-u*l(parseInt(a[d].style.width))||c<=0)break;if(d===a.length-1)return e.danTunnel[i][r+""].push(t),t.addEventListener("animationend",function(){e.danTunnel[i][r+""].splice(0,1)}),{v:r%o}}}(d);switch(c){case"continue":continue;default:if("object"===(void 0===c?"undefined":r(c)))return c.v}}return-1};"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(var d=document.createDocumentFragment(),c=0;c<t.length;c++)!function(r){t[r].type||(t[r].type="right"),t[r].color||(t[r].color="#fff");var a=document.createElement("div");a.classList.add("dplayer-danmaku-item"),a.classList.add("dplayer-danmaku-"+t[r].type),t[r].border?a.innerHTML='<span style="border:'+t[r].border+'">'+t[r].text+"</span>":a.innerHTML=t[r].text,a.style.opacity=e._opacity,a.style.color=t[r].color,a.addEventListener("animationend",function(){e.container.removeChild(a)});var o=e._measure(t[r].text),s=void 0;switch(t[r].type){case"right":(s=u(a,t[r].type,o))>=0&&(a.style.width=o+1+"px",a.style.top=i*s+"px",a.style.transform="translateX(-"+n+"px)");break;case"top":(s=u(a,t[r].type))>=0&&(a.style.top=i*s+"px");break;case"bottom":(s=u(a,t[r].type))>=0&&(a.style.bottom=i*s+"px");break;default:console.error("Can't handled danmaku type: "+t[r].type)}s>=0&&(a.classList.add("dplayer-danmaku-move"),d.appendChild(a))}(c);return this.container.appendChild(d),d}}},{key:"play",value:function(){this.paused=!1}},{key:"pause",value:function(){this.paused=!0}},{key:"_measure",value:function(t){if(!this.context){var e=getComputedStyle(this.container.getElementsByClassName("dplayer-danmaku-item")[0],null);this.context=document.createElement("canvas").getContext("2d"),this.context.font=e.getPropertyValue("font")}return this.context.measureText(t).width}},{key:"seek",value:function(){this.clear();for(var t=0;t<this.dan.length;t++){if(this.dan[t].time>=this.options.time()){this.danIndex=t;break}this.danIndex=this.dan.length}}},{key:"clear",value:function(){this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.options.container.innerHTML="",this.events&&this.events.trigger("danmaku_clear")}},{key:"htmlEncode",value:function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2f;")}},{key:"resize",value:function(){for(var t=this.container.offsetWidth,e=this.container.getElementsByClassName("dplayer-danmaku-item"),i=0;i<e.length;i++)e[i].style.transform="translateX(-"+t+"px)"}},{key:"hide",value:function(){this.showing=!1,this.pause(),this.clear(),this.events&&this.events.trigger("danmaku_hide")}},{key:"show",value:function(){this.seek(),this.showing=!0,this.play(),this.events&&this.events.trigger("danmaku_show")}},{key:"unlimit",value:function(t){this.unlimited=t}}]),t}();e.default=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(){n(this,t),this.events={},this.videoEvents=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],this.playerEvents=["screenshot","thumbnails_show","thumbnails_hide","danmaku_show","danmaku_hide","danmaku_clear","danmaku_loaded","danmaku_send","danmaku_opacity","contextmenu_show","contextmenu_hide","notice_show","notice_hide","quality_start","quality_end","destroy","resize","fullscreen","fullscreen_cancel","webfullscreen","webfullscreen_cancel","subtitle_show","subtitle_hide","subtitle_change"],this.adsEvents=["adended","adtimeupdate"]}return r(t,[{key:"on",value:function(t,e){this.type(t)&&"function"==typeof e&&(this.events[t]||(this.events[t]=[]),this.events[t].push(e))}},{key:"trigger",value:function(t,e){if(this.events[t]&&this.events[t].length)for(var i=0;i<this.events[t].length;i++)this.events[t][i](e)}},{key:"type",value:function(t){return-1!==this.playerEvents.indexOf(t)?"player":-1!==this.videoEvents.indexOf(t)?"video":-1!==this.adsEvents.indexOf(t)?"advideo":(console.error("Unknown event name: "+t),null)}}]),t}();e.default=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(0),o=function(t){return t&&t.__esModule?t:{default:t}}(a),s=function(){function t(e){var i=this;n(this,t),this.player=e,this.player.events.on("webfullscreen",function(){i.player.resize()}),this.player.events.on("webfullscreen_cancel",function(){i.player.resize(),o.default.setScrollPosition(i.lastScrollPosition)});var r=function(){i.player.resize(),i.isFullScreen("browser")?i.player.events.trigger("fullscreen"):(o.default.setScrollPosition(i.lastScrollPosition),i.player.events.trigger("fullscreen_cancel"))};this.player.container.addEventListener("fullscreenchange",r),this.player.container.addEventListener("mozfullscreenchange",r),this.player.container.addEventListener("webkitfullscreenchange",r)}return r(t,[{key:"isFullScreen",value:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"browser"){case"browser":return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;case"web":return this.player.container.classList.contains("dplayer-fulled")}}},{key:"request",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"browser",e="browser"===t?"web":"browser",i=this.isFullScreen(e);switch(i||(this.lastScrollPosition=o.default.getScrollPosition()),t){case"browser":this.player.container.requestFullscreen?this.player.container.requestFullscreen():this.player.container.mozRequestFullScreen?this.player.container.mozRequestFullScreen():this.player.container.webkitRequestFullscreen?this.player.container.webkitRequestFullscreen():this.player.video.webkitEnterFullscreen&&this.player.video.webkitEnterFullscreen();break;case"web":this.player.container.classList.add("dplayer-fulled"),document.body.classList.add("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen")}i&&this.cancel(e)}},{key:"cancel",value:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"browser"){case"browser":document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen();break;case"web":this.player.container.classList.remove("dplayer-fulled"),document.body.classList.remove("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen_cancel")}}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"browser";this.isFullScreen(t)?this.cancel(t):this.request(t)}}]),t}();e.default=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(0),o=function(t){return t&&t.__esModule?t:{default:t}}(a),s=function(){function t(e){n(this,t),this.storageName={opacity:"dplayer-danmaku-opacity",volume:"dplayer-volume",unlimited:"dplayer-danmaku-unlimited",danmaku:"dplayer-danmaku-show",subtitle:"dplayer-subtitle-show"},this.default={opacity:.7,volume:e.options.volume||.7,unlimited:(e.options.danmaku&&e.options.danmaku.unlimited?1:0)||0,danmaku:1,subtitle:1},this.data={},this.init()}return r(t,[{key:"init",value:function(){for(var t in this.storageName){var e=this.storageName[t];this.data[t]=parseFloat(o.default.storage.get(e)||this.default[t])}}},{key:"get",value:function(t){return this.data[t]}},{key:"set",value:function(t,e){this.data[t]=e,o.default.storage.set(this.storageName[t],e)}}]),t}();e.default=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e,i,r,a){n(this,t),this.container=e,this.video=i,this.options=r,this.events=a,this.init()}return r(t,[{key:"init",value:function(){var t=this;if(this.container.style.fontSize=this.options.fontSize,this.container.style.bottom=this.options.bottom,this.container.style.color=this.options.color,this.video.textTracks&&this.video.textTracks[0]){var e=this.video.textTracks[0];e.oncuechange=function(){var i=e.activeCues[0];if(i){t.container.innerHTML="";var n=document.createElement("p");n.appendChild(i.getCueAsHTML()),t.container.appendChild(n)}else t.container.innerHTML="";t.events.trigger("subtitle_change")}}}},{key:"show",value:function(){this.container.classList.remove("dplayer-subtitle-hide"),this.events.trigger("subtitle_show")}},{key:"hide",value:function(){this.container.classList.add("dplayer-subtitle-hide"),this.events.trigger("subtitle_hide")}},{key:"toggle",value:function(){this.container.classList.contains("dplayer-subtitle-hide")?this.show():this.hide()}}]),t}();e.default=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e){n(this,t),this.elements={},this.elements.volume=e.volumeBar,this.elements.played=e.playedBar,this.elements.loaded=e.loadedBar,this.elements.danmaku=e.danmakuOpacityBar}return r(t,[{key:"set",value:function(t,e,i){e=Math.max(e,0),e=Math.min(e,1),this.elements[t].style[i]=100*e+"%"}},{key:"get",value:function(t){return parseFloat(this.elements[t].style.width)/100}}]),t}();e.default=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(0),o=function(t){return t&&t.__esModule?t:{default:t}}(a),s=function(){function t(e){n(this,t),this.player=e,window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),this.types=["loading","progress","info","fps"],this.init()}return r(t,[{key:"init",value:function(){for(var t=0;t<this.types.length;t++){var e=this.types[t];"fps"!==e&&this["init"+e+"Checker"]()}}},{key:"initloadingChecker",value:function(){var t=this,e=0,i=0,n=!1;this.loadingChecker=setInterval(function(){t.enableloadingChecker&&(i=t.player.video.currentTime,n||i!==e||t.player.video.paused||(t.player.container.classList.add("dplayer-loading"),n=!0),n&&i>e&&!t.player.video.paused&&(t.player.container.classList.remove("dplayer-loading"),n=!1),e=i)},100)}},{key:"initprogressChecker",value:function(){var t=this;this.progressChecker=setInterval(function(){if(t.enableprogressChecker){t.player.bar.set("played",t.player.video.currentTime/t.player.video.duration,"width");var e=o.default.secondToTime(t.player.video.currentTime);t.player.template.ptime.innerHTML!==e&&(t.player.template.ptime.innerHTML=o.default.secondToTime(t.player.video.currentTime))}},100)}},{key:"initfpsChecker",value:function(){var t=this;window.requestAnimationFrame(function(){if(t.enablefpsChecker)if(t.initfpsChecker(),t.fpsStart){t.fpsIndex++;var e=new Date;e-t.fpsStart>1e3&&(t.player.infoPanel.fps(t.fpsIndex/(e-t.fpsStart)*1e3),t.fpsStart=new Date,t.fpsIndex=0)}else t.fpsStart=new Date,t.fpsIndex=0;else t.fpsStart=0,t.fpsIndex=0})}},{key:"initinfoChecker",value:function(){var t=this;this.infoChecker=setInterval(function(){t.enableinfoChecker&&t.player.infoPanel.update()},1e3)}},{key:"enable",value:function(t){this["enable"+t+"Checker"]=!0,"fps"===t&&this.initfpsChecker()}},{key:"disable",value:function(t){this["enable"+t+"Checker"]=!1}},{key:"destroy",value:function(t){this[t+"Checker"]&&clearInterval(this[t+"Checker"])}}]),t}();e.default=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e){var i=this;n(this,t),this.container=e,this.container.addEventListener("animationend",function(){i.container.classList.remove("dplayer-bezel-show"),i.container.classList.remove("dplayer-bezel-transition")})}return r(t,[{key:"switch",value:function(t){this.container.innerHTML=t,this.container.classList.remove("dplayer-bezel-show"),this.container.classList.add("dplayer-bezel-transition")}},{key:"show",value:function(t){this.container.innerHTML=t,this.container.classList.add("dplayer-bezel-show")}},{key:"hide",value:function(){this.container.classList.remove("dplayer-bezel-show")}}]),t}();e.default=a},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(0),s=n(o),l=i(44),u=n(l),d=i(2),c=n(d),h=function(){function t(e){var i=this;r(this,t),this.player=e,this.autoHideTimer=0,s.default.isMobile||(this.player.container.addEventListener("mousemove",function(){i.setAutoHide()}),this.player.container.addEventListener("click",function(){i.setAutoHide()}),this.player.on("play",function(){i.setAutoHide()}),this.player.on("pause",function(){i.setAutoHide()})),this.initPlayButton(),this.initThumbnails(),this.initPlayedBar(),this.initFullButton(),
this.initQualityButton(),this.initScreenshotButton(),this.initSubtitleButton(),s.default.isMobile||this.initVolumeButton()}return a(t,[{key:"initPlayButton",value:function(){var t=this;this.player.template.playButton.addEventListener("click",function(){t.player.toggle()}),s.default.isMobile,this.player.template.videoWrap.addEventListener("click",function(){t.player.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){t.player.toggle()})}},{key:"initThumbnails",value:function(){var t=this;this.player.options.video.thumbnails&&(this.thumbnails=new u.default({container:this.player.template.barPreview,barWidth:this.player.template.barWrap.offsetWidth,url:this.player.options.video.thumbnails,events:this.player.events}),this.player.on("loadedmetadata",function(){t.thumbnails.resize(160,t.player.video.videoHeight/t.player.video.videoWidth*160)}))}},{key:"initPlayedBar",value:function(){var t=this,e=function(e){var i=((e.clientX||e.changedTouches[0].clientX)-s.default.getElementViewLeft(t.player.template.playedBarWrap))/t.player.template.playedBarWrap.clientWidth;i=Math.max(i,0),i=Math.min(i,1),t.player.bar.set("played",i,"width"),t.player.template.ptime.innerHTML=s.default.secondToTime(i*t.player.video.duration)},i=function i(n){document.removeEventListener(s.default.nameMap.dragEnd,i),document.removeEventListener(s.default.nameMap.dragMove,e);var r=((n.clientX||n.changedTouches[0].clientX)-s.default.getElementViewLeft(t.player.template.playedBarWrap))/t.player.template.playedBarWrap.clientWidth;r=Math.max(r,0),r=Math.min(r,1),t.player.bar.set("played",r,"width"),t.player.seek(t.player.bar.get("played")*t.player.video.duration),t.player.time.enable("progress")};this.player.template.playedBarWrap.addEventListener(s.default.nameMap.dragStart,function(){t.player.time.disable("progress"),document.addEventListener(s.default.nameMap.dragMove,e),document.addEventListener(s.default.nameMap.dragEnd,i)}),this.player.template.playedBarWrap.addEventListener(s.default.nameMap.dragMove,function(e){if(t.player.video.duration){var i=s.default.cumulativeOffset(t.player.template.playedBarWrap).left,n=(e.clientX||e.changedTouches[0].clientX)-i;if(n<0||n>t.player.template.playedBarWrap.offsetWidth)return;var r=t.player.video.duration*(n/t.player.template.playedBarWrap.offsetWidth);s.default.isMobile&&t.thumbnails&&t.thumbnails.show(),t.thumbnails&&t.thumbnails.move(n),t.player.template.playedBarTime.style.left=n-20+"px",t.player.template.playedBarTime.innerText=s.default.secondToTime(r),t.player.template.playedBarTime.classList.remove("hidden")}}),this.player.template.playedBarWrap.addEventListener(s.default.nameMap.dragEnd,function(){s.default.isMobile&&t.thumbnails&&t.thumbnails.hide()}),s.default.isMobile||(this.player.template.playedBarWrap.addEventListener("mouseenter",function(){t.player.video.duration&&(t.thumbnails&&t.thumbnails.show(),t.player.template.playedBarTime.classList.remove("hidden"))}),this.player.template.playedBarWrap.addEventListener("mouseleave",function(){t.player.video.duration&&(t.thumbnails&&t.thumbnails.hide(),t.player.template.playedBarTime.classList.add("hidden"))}))}},{key:"initFullButton",value:function(){var t=this;this.player.template.browserFullButton.addEventListener("click",function(){t.player.fullScreen.toggle("browser")}),this.player.template.webFullButton.addEventListener("click",function(){t.player.fullScreen.toggle("web")})}},{key:"initVolumeButton",value:function(){var t=this,e=function(e){var i=e||window.event,n=((i.clientX||i.changedTouches[0].clientX)-s.default.getElementViewLeft(t.player.template.volumeBarWrap)-5.5)/35;t.player.volume(n)},i=function i(){document.removeEventListener(s.default.nameMap.dragEnd,i),document.removeEventListener(s.default.nameMap.dragMove,e),t.player.template.volumeButton.classList.remove("dplayer-volume-active")};this.player.template.volumeBarWrapWrap.addEventListener("click",function(e){var i=e||window.event,n=((i.clientX||i.changedTouches[0].clientX)-s.default.getElementViewLeft(t.player.template.volumeBarWrap)-5.5)/35;t.player.volume(n)}),this.player.template.volumeBarWrapWrap.addEventListener(s.default.nameMap.dragStart,function(){document.addEventListener(s.default.nameMap.dragMove,e),document.addEventListener(s.default.nameMap.dragEnd,i),t.player.template.volumeButton.classList.add("dplayer-volume-active")}),this.player.template.volumeIcon.addEventListener("click",function(){t.player.video.muted?(t.player.video.muted=!1,t.player.switchVolumeIcon(),t.player.bar.set("volume",t.player.volume(),"width")):(t.player.video.muted=!0,t.player.template.volumeIcon.innerHTML=c.default.volumeOff,t.player.bar.set("volume",0,"width"))})}},{key:"initQualityButton",value:function(){var t=this;this.player.options.video.quality&&this.player.template.qualityList.addEventListener("click",function(e){e.target.classList.contains("dplayer-quality-item")&&t.player.switchQuality(e.target.dataset.index)})}},{key:"initScreenshotButton",value:function(){var t=this;this.player.options.screenshot&&this.player.template.camareButton.addEventListener("click",function(){var e=document.createElement("canvas");e.width=t.player.video.videoWidth,e.height=t.player.video.videoHeight,e.getContext("2d").drawImage(t.player.video,0,0,e.width,e.height);var i=void 0;e.toBlob(function(t){i=URL.createObjectURL(t);var e=document.createElement("a");e.href=i,e.download="DPlayer.png",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(i)}),t.player.events.trigger("screenshot",i)})}},{key:"initSubtitleButton",value:function(){var t=this;this.player.options.subtitle&&(this.player.events.on("subtitle_show",function(){t.player.template.subtitleButton.dataset.balloon=t.player.tran("Hide subtitle"),t.player.template.subtitleButtonInner.style.opacity="",t.player.user.set("subtitle",1)}),this.player.events.on("subtitle_hide",function(){t.player.template.subtitleButton.dataset.balloon=t.player.tran("Show subtitle"),t.player.template.subtitleButtonInner.style.opacity="0.4",t.player.user.set("subtitle",0)}),this.player.template.subtitleButton.addEventListener("click",function(){t.player.subtitle.toggle()}))}},{key:"setAutoHide",value:function(){var t=this;this.show(),clearTimeout(this.autoHideTimer),this.autoHideTimer=setTimeout(function(){!t.player.video.played.length||t.player.paused||t.disableAutoHide||t.hide()},3e3)}},{key:"show",value:function(){this.player.container.classList.remove("dplayer-hide-controller")}},{key:"hide",value:function(){this.player.container.classList.add("dplayer-hide-controller"),this.player.setting.hide(),this.player.comment&&this.player.comment.hide()}},{key:"isShow",value:function(){return!this.player.container.classList.contains("dplayer-hide-controller")}},{key:"toggle",value:function(){this.isShow()?this.hide():this.show()}},{key:"destroy",value:function(){clearTimeout(this.autoHideTimer)}}]),t}();e.default=h},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e){n(this,t),this.container=e.container,this.barWidth=e.barWidth,this.container.style.backgroundImage="url('"+e.url+"')",this.events=e.events}return r(t,[{key:"resize",value:function(t,e){this.container.style.width=t+"px",this.container.style.height=e+"px",this.container.style.top=2-e+"px"}},{key:"show",value:function(){this.container.style.display="block",this.events&&this.events.trigger("thumbnails_show")}},{key:"move",value:function(t){this.container.style.backgroundPosition="-"+160*(Math.ceil(t/this.barWidth*100)-1)+"px 0",this.container.style.left=t-this.container.offsetWidth/2+"px"}},{key:"hide",value:function(){this.container.style.display="none",this.events&&this.events.trigger("thumbnails_hide")}}]),t}();e.default=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(0),o=function(t){return t&&t.__esModule?t:{default:t}}(a),s=function(){function t(e){var i=this;n(this,t),this.player=e,this.player.template.mask.addEventListener("click",function(){i.hide()}),this.player.template.settingButton.addEventListener("click",function(){i.show()}),this.loop=this.player.options.loop,this.player.template.loopToggle.checked=this.loop,this.player.template.loop.addEventListener("click",function(){i.player.template.loopToggle.checked=!i.player.template.loopToggle.checked,i.player.template.loopToggle.checked?i.loop=!0:i.loop=!1,i.hide()}),this.showDanmaku=this.player.user.get("danmaku"),this.showDanmaku||this.player.danmaku&&this.player.danmaku.hide(),this.player.template.showDanmakuToggle.checked=this.showDanmaku,this.player.template.showDanmaku.addEventListener("click",function(){i.player.template.showDanmakuToggle.checked=!i.player.template.showDanmakuToggle.checked,i.player.template.showDanmakuToggle.checked?(i.showDanmaku=!0,i.player.danmaku.show()):(i.showDanmaku=!1,i.player.danmaku.hide()),i.player.user.set("danmaku",i.showDanmaku?1:0),i.hide()}),this.unlimitDanmaku=this.player.user.get("unlimited"),this.player.template.unlimitDanmakuToggle.checked=this.unlimitDanmaku,this.player.template.unlimitDanmaku.addEventListener("click",function(){i.player.template.unlimitDanmakuToggle.checked=!i.player.template.unlimitDanmakuToggle.checked,i.player.template.unlimitDanmakuToggle.checked?(i.unlimitDanmaku=!0,i.player.danmaku.unlimit(!0)):(i.unlimitDanmaku=!1,i.player.danmaku.unlimit(!1)),i.player.user.set("unlimited",i.unlimitDanmaku?1:0),i.hide()}),this.player.template.speed.addEventListener("click",function(){i.player.template.settingBox.classList.add("dplayer-setting-box-narrow"),i.player.template.settingBox.classList.add("dplayer-setting-box-speed")});for(var r=0;r<this.player.template.speedItem.length;r++)!function(t){i.player.template.speedItem[t].addEventListener("click",function(){i.player.speed(i.player.template.speedItem[t].dataset.speed),i.hide()})}(r);if(this.player.danmaku){this.player.on("danmaku_opacity",function(t){i.player.bar.set("danmaku",t,"width"),i.player.user.set("opacity",t)}),this.player.danmaku.opacity(this.player.user.get("opacity"));var a=function(t){var e=t||window.event,n=((e.clientX||e.changedTouches[0].clientX)-o.default.getElementViewLeft(i.player.template.danmakuOpacityBarWrap))/130;n=Math.max(n,0),n=Math.min(n,1),i.player.danmaku.opacity(n)},s=function t(){document.removeEventListener(o.default.nameMap.dragEnd,t),document.removeEventListener(o.default.nameMap.dragMove,a),i.player.template.danmakuOpacityBox.classList.remove("dplayer-setting-danmaku-active")};this.player.template.danmakuOpacityBarWrapWrap.addEventListener("click",function(t){var e=t||window.event,n=((e.clientX||e.changedTouches[0].clientX)-o.default.getElementViewLeft(i.player.template.danmakuOpacityBarWrap))/130;n=Math.max(n,0),n=Math.min(n,1),i.player.danmaku.opacity(n)}),this.player.template.danmakuOpacityBarWrapWrap.addEventListener(o.default.nameMap.dragStart,function(){document.addEventListener(o.default.nameMap.dragMove,a),document.addEventListener(o.default.nameMap.dragEnd,s),i.player.template.danmakuOpacityBox.classList.add("dplayer-setting-danmaku-active")})}}return r(t,[{key:"hide",value:function(){var t=this;this.player.template.settingBox.classList.remove("dplayer-setting-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),setTimeout(function(){t.player.template.settingBox.classList.remove("dplayer-setting-box-narrow"),t.player.template.settingBox.classList.remove("dplayer-setting-box-speed")},300),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.settingBox.classList.add("dplayer-setting-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}}]),t}();e.default=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e){var i=this;n(this,t),this.player=e,this.player.template.mask.addEventListener("click",function(){i.hide()}),this.player.template.commentButton.addEventListener("click",function(){i.show()}),this.player.template.commentSettingButton.addEventListener("click",function(){i.toggleSetting()}),this.player.template.commentColorSettingBox.addEventListener("click",function(){if(i.player.template.commentColorSettingBox.querySelector("input:checked+span")){var t=i.player.template.commentColorSettingBox.querySelector("input:checked").value;i.player.template.commentSettingFill.style.fill=t,i.player.template.commentInput.style.color=t,i.player.template.commentSendFill.style.fill=t}}),this.player.template.commentInput.addEventListener("click",function(){i.hideSetting()}),this.player.template.commentInput.addEventListener("keydown",function(t){13===(t||window.event).keyCode&&i.send()}),this.player.template.commentSendButton.addEventListener("click",function(){i.send()})}return r(t,[{key:"show",value:function(){this.player.controller.disableAutoHide=!0,this.player.template.controller.classList.add("dplayer-controller-comment"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.container.classList.add("dplayer-show-controller"),this.player.template.commentInput.focus()}},{key:"hide",value:function(){this.player.template.controller.classList.remove("dplayer-controller-comment"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.container.classList.remove("dplayer-show-controller"),this.player.controller.disableAutoHide=!1,this.hideSetting()}},{key:"showSetting",value:function(){this.player.template.commentSettingBox.classList.add("dplayer-comment-setting-open")}},{key:"hideSetting",value:function(){this.player.template.commentSettingBox.classList.remove("dplayer-comment-setting-open")}},{key:"toggleSetting",value:function(){this.player.template.commentSettingBox.classList.contains("dplayer-comment-setting-open")?this.hideSetting():this.showSetting()}},{key:"send",value:function(){var t=this;if(this.player.template.commentInput.blur(),!this.player.template.commentInput.value.replace(/^\s+|\s+$/g,""))return void this.player.notice(this.player.tran("Please input danmaku content!"));this.player.danmaku.send({text:this.player.template.commentInput.value,color:this.player.container.querySelector(".dplayer-comment-setting-color input:checked").value,type:this.player.container.querySelector(".dplayer-comment-setting-type input:checked").value},function(){t.player.template.commentInput.value="",t.hide()})}}]),t}();e.default=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function t(e){n(this,t),e.options.hotkey&&document.addEventListener("keydown",function(t){if(e.focus){var i=document.activeElement.tagName.toUpperCase(),n=document.activeElement.getAttribute("contenteditable");if("INPUT"!==i&&"TEXTAREA"!==i&&""!==n&&"true"!==n){var r=t||window.event,a=void 0;switch(r.keyCode){case 32:r.preventDefault(),e.toggle();break;case 37:r.preventDefault(),e.seek(e.video.currentTime-5),e.controller.setAutoHide();break;case 39:r.preventDefault(),e.seek(e.video.currentTime+5),e.controller.setAutoHide();break;case 38:r.preventDefault(),a=e.volume()+.1,e.volume(a);break;case 40:r.preventDefault(),a=e.volume()-.1,e.volume(a)}}}}),document.addEventListener("keydown",function(t){switch((t||window.event).keyCode){case 27:e.fullScreen.isFullScreen("web")&&e.fullScreen.cancel("web")}})};e.default=r},function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function(){function t(e){var i=this;r(this,t),this.player=e,[].concat(n(this.player.template.menuItem)).map(function(t,e){return i.player.options.contextmenu[e].click&&t.addEventListener("click",function(){i.player.options.contextmenu[e].click(i.player),i.hide()}),t}),this.player.container.addEventListener("contextmenu",function(t){var e=t||window.event;e.preventDefault();var n=i.player.container.getBoundingClientRect();i.show(e.clientX-n.left,e.clientY-n.top),i.player.template.mask.addEventListener("click",function(){i.hide()})})}return a(t,[{key:"show",value:function(t,e){this.player.template.menu.classList.add("dplayer-menu-show");var i=this.player.container.getBoundingClientRect();t+this.player.template.menu.offsetWidth>=i.width?(this.player.template.menu.style.right=i.width-t+"px",this.player.template.menu.style.left="initial"):(this.player.template.menu.style.left=t+"px",this.player.template.menu.style.right="initial"),e+this.player.template.menu.offsetHeight>=i.height?(this.player.template.menu.style.bottom=i.height-e+"px",this.player.template.menu.style.top="initial"):(this.player.template.menu.style.top=e+"px",this.player.template.menu.style.bottom="initial"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.events.trigger("contextmenu_show")}},{key:"hide",value:function(){this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.template.menu.classList.remove("dplayer-menu-show"),this.player.events.trigger("contextmenu_hide")}}]),t}();e.default=o},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e){var i=this;n(this,t),this.container=e.template.infoPanel,this.template=e.template,this.video=e.video,this.player=e,this.template.infoPanelClose.addEventListener("click",function(){i.hide()})}return r(t,[{key:"show",value:function(){this.beginTime=Date.now(),this.update(),this.player.time.enable("info"),this.player.time.enable("fps"),this.container.classList.remove("dplayer-info-panel-hide")}},{key:"hide",value:function(){this.player.time.disable("info"),this.player.time.disable("fps"),this.container.classList.add("dplayer-info-panel-hide")}},{key:"triggle",value:function(){this.container.classList.contains("dplayer-info-panel-hide")?this.show():this.hide()}},{key:"update",value:function(){this.template.infoVersion.innerHTML="v1.1.2 a1db563",this.template.infoType.innerHTML=this.player.type,this.template.infoUrl.innerHTML=this.player.options.video.url,this.template.infoResolution.innerHTML=this.player.video.videoWidth+" x "+this.player.video.videoHeight,this.template.infoDuration.innerHTML=this.player.video.duration,this.player.options.danmaku&&(this.template.infoDanmakuId.innerHTML=this.player.options.danmaku.id,this.template.infoDanmakuApi.innerHTML=this.player.options.danmaku.api,this.template.infoDanmakuAmount.innerHTML=this.player.danmaku.dan.length)}},{key:"fps",value:function(t){this.template.infoFPS.innerHTML=""+t.toFixed(1)}}]),t}();e.default=a},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(51),s=n(o),l=i(3),u=n(l),d=function(){function t(e){r(this,t),this.options=e,this.container=this.options.container,this.advideo=this.options.video,this.video=this.options.video,this.events=this.options.events,this.adresponse,this.pre,this.showads=!1,this.index=0,this.pre_duration=0,this.countdown=0,this.triggerpreend=this.triggerpreend.bind(this),this.triggerpretimeupdate=this.triggerpretimeupdate.bind(this),this.postnext=this.postnext.bind(this),this.posttimeupdate=this.posttimeupdate.bind(this),this.send()}return a(t,[{key:"SendXMLHttpRequest",value:function(t,e,i,n,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState){if(a.status>=200&&a.status<300||304===a.status){var t=a.responseText;return i(a,t)}r(a)}},a.open(null!==e?"POST":"GET",t,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(null!==e?JSON.stringify(e):null)}},{key:"send",value:function(){var t=this,e=void 0,i={site:{domain:"www.aliyun.com",cat:["IAB1"],page:"http://www.aliyun.com/",publisher:{id:119}},ext:{adslot_id:12035,ssp_id:2832689457}};i=escape(JSON.stringify(i)),e="http://oa-mssp.data.aliyun.com/fetch_creative_ability?fetchtype=1&bidrequest="+i,[].slice(0).push(e),this.SendXMLHttpRequest(e,null,function(e,i){console.log("success"),t.playads(JSON.parse(i))},function(e,i){console.log("error"),console.log(i),t.failplay()},function(e){console.log("fail"),console.log(e),t.failplay()})}},{key:"failplay",value:function(){console.log("fail play"),this.container.style.display="none",this.options.callback()}},{key:"playads",value:function(t){this.adresponse=t,t.content&&t.content.pre?(this.pre=t.content.pre,this.pre.length>0&&(this.pre_duration=this.pre[this.index].total_duration,this.options.adcountdown.innerHTML=this.pre_duration,this.nextads(),this.initads())):this.failplay()}},{key:"play",value:function(){var t=this;u.default.resolve(this.advideo.play()).catch(function(){t.pause()}).then(function(){})}},{key:"pause",value:function(){this.advideo.pause()}},{key:"on",value:function(t,e){this.events.on(t,e)}},{key:"nextads",value:function(){var t=this;if(this.pre.length>this.index){var e=JSON.parse(this.pre[this.index].data[0].user_define_content);this.advideo.src=e.creative.animationUrl,setTimeout(function(){(t.options.autoplay||t.showads)&&t.play()},0),console.log(this.index),console.log(this.pre[this.index].data[0].click_url);var i=this.pre[this.index].data[0].click_url;this.options.admore.addEventListener("click",function(){window.open(i)}),this.options.adlink.addEventListener("click",function(){window.open(i)}),this.pre_duration=this.options.adcountdown.innerHTML,this.index++}else console.log("pre ends end"),this.container.style.display="none",this.advideo.removeEventListener("ended",this.triggerpreend),this.advideo.removeEventListener("timeupdate",this.triggerpretimeupdate),this.options.callback()}},{key:"initads",value:function(){var t=this;this.on("adended",function(){console.log("ads video ended"),t.nextads()}),this.on("adtimeupdate",function(){console.log("ads ttimeupdate");var e=t.advideo.currentTime;t.showads||(t.showads=!0,t.container.style.display="",t.options.controller.hide()),t.countdown=t.pre_duration-Math.floor(e),t.countdown<0&&(t.countdown=0),t.options.adcountdown.innerHTML=t.countdown}),this.advideo.addEventListener("ended",this.triggerpreend),this.advideo.addEventListener("timeupdate",this.triggerpretimeupdate)}},{key:"triggerpreend",value:function(){this.events.trigger("adended")}},{key:"triggerpretimeupdate",value:function(){this.events.trigger("adtimeupdate")}},{key:"hidepausead",value:function(){this.options.adapter.style.display="none"}},{key:"showpausead",value:function(){var t=this;this.options.adapter.style.display="";var e=this.options.adapter.querySelector(".adloader_pause");e.innerHTML="";var i="ifr_loader_"+Math.floor(1e6*Math.random()),n=document.createElement("iframe");n.id=i,n.height="100%",n.width="100%",n.frameBorder=0,n.scrolling="no",n.style="position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; background: none; pointer-events: auto;",e.appendChild(n);var r=document.getElementById(i);(r.contentDocument||r.contentWindow.document).write('<div id="oa-2832689457-119-11189-1528273262434"><script type="text/javascript">oa_imp_w = 300;oa_imp_h = 0;oa_imp_pos = 1;oa_site_publisher = {"id":119};oa_site_domain = null;oa_ext_ssp_id = 2832689457;oa_ext_adslot_id = 11189;oa_ext_key_words = "";oa_ext_dmp_id = "";oa_ext_video_content_targeting = "";oa_timestamp = 1528273262434;oa_id = "oa-2832689457-119-11189-1528273262434";oa_serverUrl = "oa-mssp.data.aliyun.com";oa_fetchtype = 0;oa_fetchnum = 1;<\/script><script type="text/javascript" src="//g.alicdn.com/openad/dsp-front-booth/3.0.0/odv.min.js?t=1528273262434"><\/script></div>'),this.options.adbtnclose.addEventListener("click",function(){t.options.adapter.style.display="none"})}},{key:"sendpostad",value:function(){var t=this;if(this.adresponse.content&&this.adresponse.content.post){for(var e=[],i=this.adresponse.content.post[0].ip,n=this.adresponse.content.post[0].aid,r=0;r<this.adresponse.content.post.length;r++)e.push(this.adresponse.content.post[r].id);var a="http://oa-mssp.data.aliyun.com/fetch_creative_stage?sid=2832689457&astid=12035&cpid="+n+"&cids="+e.join(",")+"&ip="+i+"&fid=&mode=2";console.log(a),this.SendXMLHttpRequest(a,null,function(e,i){console.log("success"),t.showpostad(i)},function(t,e){console.log("error"),console.log(e)},function(t){console.log("fail"),console.log(t)})}}},{key:"showpostad",value:function(t){var e=s.default.readvast(t);e.media_files.length>0&&(this.container.style.display="",this.index=0,this.pre_duration=e.duration,this.options.adcountdown.innerHTML=e.duration,this.pre=e,this.postnext(),this.advideo.addEventListener("ended",this.postnext),this.advideo.addEventListener("timeupdate",this.posttimeupdate))}},{key:"posttimeupdate",value:function(){console.log("post ads ttimeupdate");var t=this.advideo.currentTime;this.countdown=this.pre_duration-Math.floor(t),this.countdown<0&&(this.countdown=0),this.options.adcountdown.innerHTML=this.countdown}},{key:"postnext",value:function(){var t=this;if(console.log("ended:"),console.log(this.index),this.pre.media_files.length>this.index){this.advideo.src=this.pre.media_files[this.index].url,setTimeout(function(){t.play()},0);var e=this.pre.media_files[this.index].clicktracking;this.options.admore.addEventListener("click",function(){window.open(e)}),this.options.adlink.addEventListener("click",function(){window.open(e)}),this.pre_duration=this.options.adcountdown.innerHTML,this.index++}else this.container.style.display="none",this.advideo.removeEventListener("ended",this.postnext),this.advideo.removeEventListener("timeupdate",this.posttimeupdate)}}]),t}();e.default=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={readvast:function(t){var e={media_files:[],impression:[],duration:0},i=new DOMParser,n=i.parseFromString(t,"text/xml"),r=n.getElementsByTagName("Impression");if(null!=r)for(var a=0;a<r.length;a++)e.impression.push(r[a].textContent);for(var o=n.getElementsByTagName("Creative"),s=0;s<o.length;s++){var l={},u=o[s].getElementsByTagName("Linear");if(null!=u)for(var d=0;d<u.length;d++){var c=u[d].getElementsByTagName("MediaFiles");if(null!=c)for(var h=0;h<c.length;h++){var p=c[h].getElementsByTagName("MediaFile")[0];null!=p&&(l={type:p.getAttribute("type"),url:p.textContent,width:p.getAttribute("width"),height:p.getAttribute("height")})}var f=u[d].getElementsByTagName("VideoClicks");if(null!=f)for(var y=0;y<f.length;y++){var v=f[y].getElementsByTagName("ClickThrough")[0],m=f[y].getElementsByTagName("ClickTracking")[0];null!=v&&(l.clickthrough=v.textContent),null!=m&&(l.clicktracking=m.textContent)}var g=u[d].getElementsByTagName("Duration")[0];if(null!=g){var b=g.textContent.split(":"),E=60*+b[0]*60+60*+b[1]+ +b[2];l.duration=E,e.duration=e.duration+E}}e.media_files.push(l)}return e}};e.default=n}]).default}),define("js/script/html5",["js/lib/hls.min","MPlayer"],function(t,e){function i(){Hls=t;new e({container:n.container[0],autoplay:n.autoplay,playad:n.playad,video:{url:n.url,type:"auto"}})}var n={vid:0,playerId:0,container:0,autoplay:!0,playad:!0};return{init:function(t){n=$.extend(!0,n,t),i()}}});